<?xml version="1.0" encoding="UTF-8"?><unload unload_date="2023-11-17 01:36:35">
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>CMDB Health Simulator Lab work_AV_v1.0</name>
<origin_sys_id/>
<parent display_value=""/>
<release_date/>
<remote_base_update_set display_value=""/>
<remote_parent_id/>
<remote_sys_id>7aa6a765412231107f440d8147faed56</remote_sys_id>
<state>loaded</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>ac23c87d41a231107f440d8147faedda</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_5448a17573533300d4c1b7385ef6a759</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>XKKPFJ+hUOsQ3cA3tMQOgw==</checksum><description>WinRM implementation of functions for invoking commands and methods</description><directory>false</directory><name>WinRMInvokeOperations.psm1</name><parent display_value="WinRMCollector">d90565b173533300d4c1b7385ef6a714</parent><script>function executeCommand {&#13;
    # the timeoutSec parameter is not used for the WinRM implementation of this function&#13;
    param([string]$command = $(throw "The command parameter is required."), [int]$timeoutSec=120, [bool]$stdErrInStdOut=$true);&#13;
&#13;
    # if we have a JEA Profile name, we must use the JEAExecute-Command function to run the command&#13;
    # Keep this to maintain backward compatibility to the JEA_DISCO (v1) profile&#13;
    if ($env:SNC_ConfigurationName -and $SNC_session -and -not $global:SNC_jea_disco_cert) {&#13;
        SNCLog-DebugInfo "The remote session is configured to work with the JEA endpoint $env:SNC_ConfigurationName";&#13;
        $sb = {&#13;
            param([string]$command)&#13;
            JEAExecute-Command $command;&#13;
        }&#13;
    } else {&#13;
        # use cmd to run the command&#13;
        $sb = {&#13;
            param([string]$command, [int]$timeoutSec, [bool]$stdErrInStdOut=$false)&#13;
            &#13;
            # An inner scriptblock to run the command&#13;
            $isb = {&#13;
                param([string]$command, [bool]$stdErrInStdOut=$false);&#13;
                if ($stdErrInStdOut){&#13;
                    # This is done in order to get the StdOut and StdErr together but with no PowerShell related prefix messages.&#13;
                    $output = cmd /c $command 2&gt;&amp;1 ;&#13;
                    foreach ($line in $output){&#13;
                        if ($line -and $line.exception -and $line.Exception.message){&#13;
                            $line.Exception.message;&#13;
                        }else{&#13;
                            $line;&#13;
                        }&#13;
                    }&#13;
                } else {&#13;
                    cmd /c $command;&#13;
                }&#13;
            };&#13;
            &#13;
            # Starts the job and move to the next line&#13;
            $j = Start-Job -ScriptBlock $isb -ArgumentList $command, $stdErrInStdOut;&#13;
            # Waits for $j: finished on the timeout or when $j is done - the earlier&#13;
            if (Wait-Job $j -Timeout $timeoutSec) {&#13;
                # Redirect $j results to the console&#13;
                Receive-Job $j&#13;
            }&#13;
            # Kill the process if not ended and remove the job.&#13;
            Remove-Job -force $j &gt; $null;&#13;
        }&#13;
    }&#13;
    &#13;
    try {&#13;
        if ((isJEACodeSigning) -and $SNC_session) {&#13;
            $_params = @{&#13;
                "command" = $command&#13;
                "timeoutSec" = $timeoutSec&#13;
                "stdErrInStdOut" = $stdErrInStdOut&#13;
            }&#13;
            $output = invokeJEAExecuteScript $SNC_session $sb.toString() $_params -ErrorAction Stop;&#13;
        } elseif ($SNC_session) {&#13;
            SNCLog-DebugInfo "Executing command through remote session: $command";&#13;
            $output = Invoke-Command -Session $SNC_session -ScriptBlock $sb -ArgumentList $command, $timeoutSec, $stdErrInStdOut -ErrorAction Stop;&#13;
        } else {&#13;
            SNCLog-DebugInfo "Executing command through local session: $command";&#13;
            $output = Invoke-Command -ScriptBlock $sb -ArgumentList $command, $timeoutSec, $stdErrInStdOut -ErrorVariable 'err';&#13;
&#13;
            # error handling here is different because Invoke-Command in local session won't throw an exception&#13;
            # however, we can still set an error variable and send it to stderr&#13;
            if ($err) {&#13;
                Write-Error "Failed to execute command: $sb.`n$($err | Out-String)";&#13;
            }&#13;
        }&#13;
&#13;
        return $output;&#13;
    } catch {&#13;
        Write-Error "Failed to execute command: $command. Original Exception: $($_.Exception | Out-String)";&#13;
    }&#13;
}</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>benjamin.phan</sys_created_by><sys_created_on>2019-08-16 22:16:45</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>5448a17573533300d4c1b7385ef6a759</sys_id><sys_mod_count>13</sys_mod_count><sys_name>WinRMInvokeOperations.psm1</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_5448a17573533300d4c1b7385ef6a759</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:55</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-2044418251</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>20230c7d41a231107f440d8147faed36</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e003500000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>WinRMInvokeOperations.psm1</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>3510015dd3a2311021d2911434881bd5</update_guid>
<update_guid_history>3510015dd3a2311021d2911434881bd5:-2044418251,b110015dc0a231108ee73b8c6fbe56d4:-1472017132</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_e2eda224c30322003e76741e81d3aea9</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>WO9/+f1GxrzlVViOig6K/A==</checksum><description>Script used by the SSH layer in the discovery patterns in order to detect existence of privileged command on host</description><directory>false</directory><name>check_priv_command</name><parent/><script>try {&#13;
    ssh.execCommand("command -v " + priv_command );&#13;
    output = 'true';&#13;
} catch (err) {&#13;
    output = 'false';&#13;
}</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2016-11-09 14:58:41</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>e2eda224c30322003e76741e81d3aea9</sys_id><sys_mod_count>4</sys_mod_count><sys_name>check_priv_command</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_e2eda224c30322003e76741e81d3aea9</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:24</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-216013872</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>20230c7d41a231107f440d8147faed39</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e247ff0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>check_priv_command</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>c2a00151bde231101998c7b0470466cf</update_guid>
<update_guid_history>c2a00151bde231101998c7b0470466cf:-216013872,42a0015137e2311026216601cc4d3ace:1434191403</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_authentication_policy_criteria_m2m_15a7b381c7722010df1417b703c26074</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_authentication_policy_criteria_m2m"><sys_authentication_policy_criteria_m2m action="INSERT_OR_UPDATE"><policy display_value="Step-Down MFA Policy">285a15d373512010616ca9843cf6a749</policy><sys_auth_filter_criteria display_value="User Based MFA">6956fd56c7312010df1417b703c260dc</sys_auth_filter_criteria><sys_created_by>admin</sys_created_by><sys_created_on>2021-03-08 16:49:20</sys_created_on><sys_id>15a7b381c7722010df1417b703c26074</sys_id><sys_mod_count>1</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2021-06-08 08:37:02</sys_updated_on><used>true</used></sys_authentication_policy_criteria_m2m></record_update>]]></payload>
<payload_hash>111726440</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>20230c7d41a231107f440d8147faed3c</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3ff55d70000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>6956fd56c7312010df1417b703c260dc</target_name>
<type>List of filter criteria</type>
<update_domain>global</update_domain>
<update_guid>3ee7415d3e66311038646086fd9ec5ef</update_guid>
<update_guid_history>3ee7415d3e66311038646086fd9ec5ef:111726440</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_1b92f31f9f2531107f44e6ca4224ab89</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description>The default value of 'false' means that ServiceNow trusts only certificates from a Certificate Authority recognized in the JVM. In this default case, the ServiceNow platform does not accept self-issued certificates.</description><ignore_cache>false</ignore_cache><is_private>false</is_private><name>com.glide.communications.trustmanager_trust_all</name><read_roles/><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-10-03 17:50:58</sys_created_on><sys_id>1b92f31f9f2531107f44e6ca4224ab89</sys_id><sys_mod_count>2</sys_mod_count><sys_name>com.glide.communications.trustmanager_trust_all</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_1b92f31f9f2531107f44e6ca4224ab89</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:25:34</sys_updated_on><type>boolean</type><value>false</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=1b92f31f9f2531107f44e6ca4224ab89"/></record_update>]]></payload>
<payload_hash>588377557</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>20230c7d41a231107f440d8147faed3f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd404564c0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>com.glide.communications.trustmanager_trust_all</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>3a298d918da63110b923e4b844aabea1</update_guid>
<update_guid_history>3a298d918da63110b923e4b844aabea1:588377557,84e93c953f2231102d0770f03c79016d:-867714438,77d93c95fe223110026b0f4567539a66:588377557</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_3a889605537a320023bdae4a16dc3408</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>33or/+QAwVXM/0jkPaO/YQ==</checksum><description/><directory>false</directory><name>solaris_netstat_command.sh</name><parent display_value="ADME">ec515c705352320023bdae4a16dc3488</parent><script>#!/bin/sh&#13;
# Copyright © ServiceNow, Inc. 2017. All rights reserved.&#13;
&#13;
BASE_DIR=$1&#13;
cp "${BASE_DIR}/connection_samples/all_connections.log" "${BASE_DIR}/connection_samples/all_connections_tmp.log"&#13;
#netstat output for IPv4 | match LISTEN | print result | separate ip.port &#13;
sudo netstat -anuP tcp -f inet | grep LISTEN | awk -F' ' '{print "on " $4 " " $1}' | sed 's/\(.*\)\./\1 /' | sort | uniq &gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
sudo netstat -anuP tcp -f inet | grep ESTABLISHED | awk -F' ' '{print "to " $4 " " $1 " " $2}' | sed 's/\(.*\)\./\1 /' | awk -F' ' '{print $1 " " $2 " " $4 " " $5 " " $3 }' | sed 's/\(.*\)\./\1 /' | sort | uniq &gt;&gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
cat "${BASE_DIR}/connection_samples/connection_sample.log" "${BASE_DIR}/connection_samples/all_connections_tmp.log" | sort &gt; "${BASE_DIR}/connection_samples/all_connections.log"&#13;
</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>evan.qu</sys_created_by><sys_created_on>2017-05-16 12:35:55</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>3a889605537a320023bdae4a16dc3408</sys_id><sys_mod_count>3</sys_mod_count><sys_name>solaris_netstat_command.sh</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_3a889605537a320023bdae4a16dc3408</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:54</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>2114809279</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>2023c87d41a231107f440d8147faedde</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e002330000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>solaris_netstat_command.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>6d10015d38a23110df32eeef66daa4bb</update_guid>
<update_guid_history>6d10015d38a23110df32eeef66daa4bb:2114809279,e910015d76a23110d231299d329817ba:-727909844</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_d160ad1a9f0432001d753758442e7066</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>uteo48Y9rmKbOP33i5EDHw==</checksum><description/><directory>false</directory><name>get-zones.sh</name><parent display_value="SSHScriptFiles">48deb961ff123100ab8fffffffffff07</parent><script>#!/bin/sh&#13;
#&#13;
IFS="&#13;
"&#13;
ADMCMD=/usr/sbin/zoneadm&#13;
ZNAMECMD=/usr/bin/zonename&#13;
CFGCMD=/usr/sbin/zonecfg&#13;
&#13;
printf "&lt;zones&gt;\n"&#13;
&#13;
if [ -f $ZNAMECMD ]; then&#13;
    MYZONE=`$ZNAMECMD`&#13;
    printf "&lt;id&gt;%s&lt;/id&gt;\n" "$MYZONE"&#13;
&#13;
    if [ "$MYZONE" = "global" ]; then&#13;
        for LINE in `$ADMCMD list -cip`; do&#13;
                ZID=`echo $LINE | cut -d":" -f2`&#13;
                ZSTATUS=`echo $LINE | cut -d":" -f3`&#13;
                ZPATH=`echo $LINE | cut -d":" -f4`&#13;
&#13;
                if [ "$ZID" != "global" ]; then&#13;
                        printf "&lt;zone&gt;\n"&#13;
&#13;
                        printf "&lt;id&gt;%s&lt;/id&gt;\n" $ZID&#13;
                        &#13;
                        printf "&lt;status&gt;%s&lt;/status&gt;\n" $ZSTATUS&#13;
&#13;
                        printf "&lt;path&gt;\n"&#13;
                        $CFGCMD -z $ZID info zonepath&#13;
                        printf "&lt;/path&gt;\n"&#13;
&#13;
                        printf "&lt;net&gt;\n"&#13;
                        $CFGCMD -z $ZID info net&#13;
                        printf "&lt;/net&gt;\n"&#13;
&#13;
                        printf "&lt;/zone&gt;\n"&#13;
                fi&#13;
        done&#13;
    fi&#13;
fi&#13;
&#13;
printf "&lt;/zones&gt;"</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>oron.subayi</sys_created_by><sys_created_on>2017-01-03 12:50:35</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>d160ad1a9f0432001d753758442e7066</sys_id><sys_mod_count>3</sys_mod_count><sys_name>get-zones.sh</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_d160ad1a9f0432001d753758442e7066</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:23</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>934493309</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>24230c7d41a231107f440d8147faed38</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e247c60000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>get-zones.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>cea00151c1e2311011bedc76ed0b89cb</update_guid>
<update_guid_history>cea00151c1e2311011bedc76ed0b89cb:934493309,4ea0015198e23110d479268a07b2a4ca:545452126</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>pa_dashboards_permissions_1c838625e42231107f443c8410589e4b</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="pa_dashboards_permissions"><pa_dashboards_permissions action="INSERT_OR_UPDATE"><dashboard display_value="Discovery Dashboard">98db0f8a0fc03010ce4d142386767e44</dashboard><delete>false</delete><group/><identity>itil</identity><read>true</read><role display_value="itil" name="itil">282bf1fac6112285017366cb5f867469</role><sys_class_name>pa_dashboards_permissions</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 16:18:56</sys_created_on><sys_id>1c838625e42231107f443c8410589e4b</sys_id><sys_mod_count>0</sys_mod_count><sys_name>itil</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>pa_dashboards_permissions_1c838625e42231107f443c8410589e4b</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 16:18:56</sys_updated_on><type>1</type><user/><write>false</write></pa_dashboards_permissions></record_update>]]></payload>
<payload_hash>-617298282</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>24230c7d41a231107f440d8147faed3b</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd8edabd40000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>itil</target_name>
<type>Dashboard Permissions</type>
<update_domain>global</update_domain>
<update_guid>d483066558223110e6a7a6b019e0b80d</update_guid>
<update_guid_history>d483066558223110e6a7a6b019e0b80d:-617298282</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da_u_rel_configuration_item_1_incident_1</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_rel_configuration_item_1_incident_1" table="u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da"><active>true</active><array>false</array><attributes>edge_encryption_enabled=true</attributes><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label>Configuration Item 1_Incident 1</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_rel_configuration_item_1_incident_1</element><element_reference>false</element_reference><foreign_database/><formula/><function_definition/><function_field>false</function_field><internal_type display_value="String">string</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 00:15:10</sys_created_on><sys_id>58803725416231107f440d8147faed07</sys_id><sys_name>Configuration Item 1_Incident 1</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da_u_rel_configuration_item_1_incident_1</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:15:10</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><virtual_type/><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>2094886273</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>24230c7d41a231107f440d8147faed3e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bdaa1b0440000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</table>
<target_name>Critical Incidents with No Owner-Query Results.Configuration Item 1_Incident 1</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>ec8037253c6231100be44c057f457735</update_guid>
<update_guid_history>ec8037253c6231100be44c057f457735:2094886273</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_280083707f203100ed1c3b19befa911d</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>HasiXJUhXb5ywKwqGC9nDw==</checksum><description>Utility files to be sent to target hosts</description><directory>false</directory><name>DiscoveryUtilityFiles.properties</name><parent display_value="ServiceWatch">ed844850c31321003e76741e81d3ae39</parent><script>StringsWin32=strings.exe&#13;
WmbHelper=servicenow_wmb_helper.bat&#13;
ConnectionStringsBrowser=connection_strings_browser.exe&#13;
FindQueuesInASPX=find_queues.vbs&#13;
GetXenApp=get_xenapp_apps.ps1&#13;
FindDC=find_dc.vbs&#13;
TibcoParser=ServiceWatch/SSHScriptFiles/TibcoFilesParser.ksh&#13;
GetOracleParameters=getAllParams.sql&#13;
GetPSApplications=GetAppsInFolder.wsf&#13;
GetCrmServer=GetCrmServer.ps1&#13;
LinuxFQDN=ServiceWatch/SSHScriptFiles/linux_fqdn.sh&#13;
LinuxPKG=ServiceWatch/SSHScriptFiles/pkg_munger.bash&#13;
LinuxStorage=ServiceWatch/SSHScriptFiles/storage.bash&#13;
UnixFQDN=ServiceWatch/SSHScriptFiles/unix_fqdn.sh&#13;
SolarisHardware=ServiceWatch/SSHScriptFiles/suntype.sh&#13;
SolarisStorage=ServiceWatch/SSHScriptFiles/Sstorage.bash&#13;
SolarisZones=ServiceWatch/SSHScriptFiles/get-zones.sh&#13;
AIXCPU=ServiceWatch/SSHScriptFiles/cpus.sh&#13;
AIXMemory=ServiceWatch/SSHScriptFiles/memory.sh&#13;
GetExchangeServers=getExchangeServer.ps1&#13;
ConfirmAzure=ConfirmAzureVM.ps1</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2014-11-20 15:45:30</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>280083707f203100ed1c3b19befa911d</sys_id><sys_mod_count>8</sys_mod_count><sys_name>DiscoveryUtilityFiles.properties</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_280083707f203100ed1c3b19befa911d</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:23</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>1649852691</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>2423c87d41a231107f440d8147faeddd</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e2458f0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>DiscoveryUtilityFiles.properties</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>79a00151f7e231101f026ac8c16d216a</update_guid>
<update_guid_history>79a00151f7e231101f026ac8c16d216a:1649852691,f5a00151ece2311033cb426d28e9bc69:-337472052</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_a62454b05352320023bdae4a16dc3487</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>LvxlS+Q441CqqtDD/4Ph7g==</checksum><description/><directory>false</directory><name>linux_ps_command.sh</name><parent display_value="ADME">ec515c705352320023bdae4a16dc3488</parent><script>#!/bin/sh&#13;
# Copyright © ServiceNow, Inc. 2017. All rights reserved.&#13;
BASE_DIR=$1&#13;
CALLPOINT_DIR=`dirname $0`&#13;
ADME_PID=`cat $CALLPOINT_DIR/../adme_collector.pid` &#13;
cp "${BASE_DIR}/process_samples/all_processes.log" "${BASE_DIR}/process_samples/all_processes_tmp.log"&#13;
ps awwxo pid,ppid,command | sed -n '/&lt;defunct&gt;/!p' | grep -v "  PID  PPID COMMAND" | grep -v  "awwxo pid,ppid,command" | grep -v "$BASE_DIR" | sort | uniq &gt; "${BASE_DIR}/process_samples/process_sample.log"&#13;
cat "$BASE_DIR/process_samples/process_sample.log" "$BASE_DIR/process_samples/all_processes_tmp.log" | sort &gt; "${BASE_DIR}/process_samples/all_processes.log"&#13;
</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>evan.qu</sys_created_by><sys_created_on>2017-04-20 11:47:46</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>a62454b05352320023bdae4a16dc3487</sys_id><sys_mod_count>10</sys_mod_count><sys_name>linux_ps_command.sh</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_a62454b05352320023bdae4a16dc3487</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:55</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>58978982</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>28230c7d41a231107f440d8147faed37</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e0054f0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>linux_ps_command.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>fd10415da6a231101cbb944cceca1f0a</update_guid>
<update_guid_history>fd10415da6a231101cbb944cceca1f0a:58978982,7d10415d1ea2311003ae63d0fca23c09:249122093</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>mid_cert_check_policy_b23ab21a5b311010eff60e281d81c74b</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="mid_cert_check_policy"><mid_cert_check_policy action="INSERT_OR_UPDATE"><active>true</active><enable_cert_chain_validation>false</enable_cert_chain_validation><enable_hostname_validation>false</enable_hostname_validation><enable_revocation_validation>false</enable_revocation_validation><internal_scope>global</internal_scope><name>Internet</name><policy_type>public_network</policy_type><sys_class_name>mid_cert_check_policy</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2020-07-06 20:19:34</sys_created_on><sys_domain>global</sys_domain><sys_domain_path/><sys_id>b23ab21a5b311010eff60e281d81c74b</sys_id><sys_mod_count>2</sys_mod_count><sys_name>Internet</sys_name><sys_overrides/><sys_package display_value="MID Server" source="com.glideapp.agent">15b8e3139fe131107f44e6ca4224ab80</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>mid_cert_check_policy_b23ab21a5b311010eff60e281d81c74b</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:23:27</sys_updated_on></mid_cert_check_policy></record_update>]]></payload>
<payload_hash>-460636269</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>28230c7d41a231107f440d8147faed3a</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd40261e30000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>Internet</target_name>
<type>MID Certificate Policy</type>
<update_domain>global</update_domain>
<update_guid>2fa84d1109a63110c00499a55d3ac221</update_guid>
<update_guid_history>2fa84d1109a63110c00499a55d3ac221:-460636269,63a84d1103a63110dcd7513244d8b420:-559494626</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a_u_windows_server_1</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_windows_server_1" table="u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a"><active>true</active><array>false</array><attributes>encode_utf8=false</attributes><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label>Windows Server 1</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_windows_server_1</element><element_reference>false</element_reference><foreign_database/><formula/><function_definition/><function_field>false</function_field><internal_type display_value="Reference">reference</internal_type><mandatory>false</mandatory><max_length>32</max_length><name>u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference display_value="" name="cmdb_ci_win_server">cmdb_ci_win_server</reference><reference_cascade_rule>clear</reference_cascade_rule><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 00:09:04</sys_created_on><sys_id>fe1fa7a1416231107f440d8147faed61</sys_id><sys_name>Windows Server 1</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a_u_windows_server_1</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:09:05</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><virtual_type/><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>-574326104</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>28230c7d41a231107f440d8147faed3d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda9c1c8f0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a</table>
<target_name>Windows 2012, 2016, 2019 Query-Query Results.Windows Server 1</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>971fa7a19a62311010cae887ef9ccfd5</update_guid>
<update_guid_history>971fa7a19a62311010cae887ef9ccfd5:-574326104,cf1fa7a1d3623110ff105ed9a3c0d474:1999650730</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_1566b2375312320023bdae4a16dc348d</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>BW2w5SdORrFT/OlkpF/88Q==</checksum><description/><directory>false</directory><name>linux_netstat_command.sh</name><parent display_value="ADME">ec515c705352320023bdae4a16dc3488</parent><script>#!/bin/sh&#13;
# Copyright © ServiceNow, Inc. 2017. All rights reserved.&#13;
BASE_DIR=$1&#13;
cp "${BASE_DIR}/connection_samples/all_connections.log" "${BASE_DIR}/connection_samples/all_connections_tmp.log"&#13;
#match tcp | match LISTEN | filter :: | remote process_name | print 'on pid local_ip:port' | separate ip:port&#13;
sudo netstat -antp | grep tcp | grep LISTEN | grep -v "::" | cut -d '/' -f1 | awk -F' ' '{print "on " $7 " " $4}' | grep -v - | sed 's/:/ /g' | sort | uniq &gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
sudo netstat -antp | grep tcp | grep ESTABLISHED | grep -v "::" | cut -d '/' -f1 | awk -F' ' '{print "to " $7 " " $5 " " $4}' | sed 's/:/ /g' | sort | uniq &gt;&gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
cat "$BASE_DIR/connection_samples/connection_sample.log" "$BASE_DIR/connection_samples/all_connections_tmp.log" | sort &gt; "${BASE_DIR}/connection_samples/all_connections.log"&#13;
</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>evan.qu</sys_created_by><sys_created_on>2017-04-30 07:18:43</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>1566b2375312320023bdae4a16dc348d</sys_id><sys_mod_count>9</sys_mod_count><sys_name>linux_netstat_command.sh</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_1566b2375312320023bdae4a16dc348d</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:54</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>926294218</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>2823c87d41a231107f440d8147faeddc</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3dfff610000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>linux_netstat_command.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>ad10cd1d5aa23110b65899e66432f1f3</update_guid>
<update_guid_history>ad10cd1d5aa23110b65899e66432f1f3:926294218,2910cd1d77a23110f32ff96fc032e2f2:-115068265</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_6c45c850c31321003e76741e81d3ae06</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>vQDVy0FoRRP8fnYrjcb5Fw==</checksum><description>Regular expressions describing command and responses in case of failure due to permission problems.</description><directory>false</directory><name>access_denied.properties</name><parent display_value="ServiceWatch">ed844850c31321003e76741e81d3ae39</parent><script>COMMAND_REGEX=powershell RESPONSE_REGEX=Logon failure|Access is denied|.*\(401\) Unauthorized&#13;
COMMAND_REGEX=^(http|https)://.* RESPONSE_REGEX=.*content="Microsoft SharePoint".*Error: Access Denied|Authentication required|authorization required&#13;
COMMAND_REGEX=runmqsc RESPONSE_REGEX=Not authorized&#13;
COMMAND_REGEX=dir RESPONSE_REGEX=Access is denied&#13;
COMMAND_REGEX=type RESPONSE_REGEX=Access is denied</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2014-09-17 09:33:27</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>6c45c850c31321003e76741e81d3ae06</sys_id><sys_mod_count>6</sys_mod_count><sys_name>access_denied.properties</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_6c45c850c31321003e76741e81d3ae06</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:23</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>1508394010</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>2c230c7d41a231107f440d8147faed36</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e246ce0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>access_denied.properties</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>46a0015137e23110cfe68703a4f28fa9</update_guid>
<update_guid_history>46a0015137e23110cfe68703a4f28fa9:1508394010,c2a00151a3e23110fbf2f22402e810a8:-643435566</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_ecceba295312320023bdae4a16dc34e8</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>Y0pOhYNjzMSfVvOTU08JmQ==</checksum><description/><directory>false</directory><name>aix_ps_command.sh</name><parent display_value="ADME">ec515c705352320023bdae4a16dc3488</parent><script>#!/bin/sh&#13;
# Copyright © ServiceNow, Inc. 2017. All rights reserved.&#13;
&#13;
# setting column width to avoid truncating results&#13;
export COLUMNS=1000&#13;
BASE_DIR=$1&#13;
CALLPOINT_DIR=`dirname $0`&#13;
ADME_PID=`cat $CALLPOINT_DIR/../adme_collector.pid` &#13;
cp "${BASE_DIR}/process_samples/all_processes.log" "${BASE_DIR}/process_samples/all_processes_tmp.log"&#13;
PS=`ps -aef -o "pid,ppid,args"`&#13;
echo "$PS" | grep -v "  PID  PPID COMMAND" | grep -v  "aef -o" | grep -v "$BASE_DIR" | sort | uniq &gt; "${BASE_DIR}/process_samples/process_sample.log"&#13;
cat "$BASE_DIR/process_samples/process_sample.log" "$BASE_DIR/process_samples/all_processes_tmp.log" | sort &gt; "${BASE_DIR}/process_samples/all_processes.log"&#13;
</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>evan.qu</sys_created_by><sys_created_on>2017-04-23 08:08:31</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>ecceba295312320023bdae4a16dc34e8</sys_id><sys_mod_count>5</sys_mod_count><sys_name>aix_ps_command.sh</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_ecceba295312320023bdae4a16dc34e8</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:57</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-352360070</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>2c230c7d41a231107f440d8147faed39</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e00aca0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>aix_ps_command.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>9610415deda2311064b378319ec25b37</update_guid>
<update_guid_history>9610415deda2311064b378319ec25b37:-352360070,1610415d43a23110fa3f97a95a887236:-2133907306</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_db_object_221f6f21416231107f440d8147faedf9</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_db_object"><sys_db_object action="INSERT_OR_UPDATE"><access/><actions_access>true</actions_access><alter_access>true</alter_access><caller_access/><client_scripts_access>true</client_scripts_access><configuration_access>false</configuration_access><create_access>true</create_access><create_access_controls>false</create_access_controls><delete_access>false</delete_access><is_extendable>false</is_extendable><label>Windows 2012, 2016, 2019 Query-Query Results</label><live_feed_enabled>false</live_feed_enabled><name>u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a</name><number_ref/><provider_class/><read_access>true</read_access><scriptable_table>false</scriptable_table><super_class display_value="Query Builder Results" name="cmdb_qb_result_base">cde4ab1b9f6131107f44e6ca4224abb8</super_class><sys_class_name>sys_db_object</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 00:09:02</sys_created_on><sys_id>221f6f21416231107f440d8147faedf9</sys_id><sys_mod_count>0</sys_mod_count><sys_name>CMDB Qb Result 335c16197bab41278b083220e1363ca398e3766a</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_db_object_221f6f21416231107f440d8147faedf9</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:09:02</sys_updated_on><update_access>true</update_access><user_role/><ws_access>true</ws_access></sys_db_object></record_update>]]></payload>
<payload_hash>433899396</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>2c230c7d41a231107f440d8147faed3c</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda9c16a10000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a</table>
<target_name>Windows 2012, 2016, 2019 Query-Query Results</target_name>
<type>Table</type>
<update_domain>global</update_domain>
<update_guid>b61fa7a1c2623110d8fb255fd0501560</update_guid>
<update_guid_history>b61fa7a1c2623110d8fb255fd0501560:433899396</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_2fd9f895092231107f445d7a5f5e13d3</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>false</ignore_cache><is_private>false</is_private><name>glide.quota.manager.minimum_transaction_time</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:18:44</sys_created_on><sys_id>2fd9f895092231107f445d7a5f5e13d3</sys_id><sys_mod_count>1</sys_mod_count><sys_name>glide.quota.manager.minimum_transaction_time</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_2fd9f895092231107f445d7a5f5e13d3</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:25:30</sys_updated_on><type>string</type><value>1</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=2fd9f895092231107f445d7a5f5e13d3"/></record_update>]]></payload>
<payload_hash>359936645</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>2c230c7d41a231107f440d8147faed3f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd404444f0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>glide.quota.manager.minimum_transaction_time</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>bd294d9121a63110e0e2f12b3493f2f7</update_guid>
<update_guid_history>bd294d9121a63110e0e2f12b3493f2f7:359936645,a3d9f8954322311034bc33dcb357b5db:555471233</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>cmdb_health_staleness_rule_5cd82f29412231107f440d8147faed35</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="cmdb_health_staleness_rule"><cmdb_health_staleness_rule action="INSERT_OR_UPDATE"><applies_to>cmdb_ci_win_server</applies_to><duration>1970-01-08 00:00:00</duration><sys_class_name>cmdb_health_staleness_rule</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 23:41:53</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>5cd82f29412231107f440d8147faed35</sys_id><sys_mod_count>2</sys_mod_count><sys_name>cmdb_ci_win_server</sys_name><sys_overrides/><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>cmdb_health_staleness_rule_5cd82f29412231107f440d8147faed35</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 23:49:00</sys_updated_on></cmdb_health_staleness_rule></record_update>]]></payload>
<payload_hash>-359062465</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>2c23c87d41a231107f440d8147faeddb</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda89b8c80000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cmdb_ci_win_server</target_name>
<type>CMDB Health Staleness Rule</type>
<update_domain>global</update_domain>
<update_guid>c58a2ba9502231109d9dd4a86ff79e23</update_guid>
<update_guid_history>c58a2ba9502231109d9dd4a86ff79e23:-359062465,8009ef299d2231103d33d9c972480faa:-683070848,b8e8a729fb22311028ace2477d43af5b:-359062465</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_bdb8cd1109a631107f445d7a5f5e1332</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>cl.bootTime</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>trainingadmin</sys_created_by><sys_created_on>2023-11-15 17:23:36</sys_created_on><sys_id>bdb8cd1109a631107f445d7a5f5e1332</sys_id><sys_mod_count>3</sys_mod_count><sys_name>cl.bootTime</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_bdb8cd1109a631107f445d7a5f5e1332</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-16 23:15:38</sys_updated_on><type>string</type><value>2023-11-16 23:15:38</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=bdb8cd1109a631107f445d7a5f5e1332"/></record_update>]]></payload>
<payload_hash>727543987</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>30230c7d41a231107f440d8147faed42</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda6b66750000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cl.bootTime</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>bbe2e32191223110cb2244e7588c268d</update_guid>
<update_guid_history>bbe2e32191223110cb2244e7588c268d:727543987,b8a1c22166223110a5020d93bb2eebcb:2090763624,30d8c5515aa6311088b964f42dff1926:489930508,c6b8cd11bba631106a19d55a7b98093a:613953647</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_section_7f083b6d416231107f440d8147faed88</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_ui_section caption="" section_id="7f083b6d416231107f440d8147faed88" sys_domain="global" table="orphan_ci_remediation" version="3" view=""><sys_ui_element action="INSERT_OR_UPDATE"><element>number</element><position>0</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 01:07:32</sys_created_on><sys_id>177cfb6541a231107f440d8147faed60</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="orphan_ci_remediation" sys_domain="global" view="Default view">7f083b6d416231107f440d8147faed88</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 01:07:32</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>assigned_to</element><position>1</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 01:07:32</sys_created_on><sys_id>9b7cfb6541a231107f440d8147faed60</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="orphan_ci_remediation" sys_domain="global" view="Default view">7f083b6d416231107f440d8147faed88</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 01:07:32</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>cmdb_ci</element><position>2</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 01:07:32</sys_created_on><sys_id>1f7cfb6541a231107f440d8147faed60</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="orphan_ci_remediation" sys_domain="global" view="Default view">7f083b6d416231107f440d8147faed88</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 01:07:32</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>active</element><position>3</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 01:07:32</sys_created_on><sys_id>9f7cfb6541a231107f440d8147faed60</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="orphan_ci_remediation" sys_domain="global" view="Default view">7f083b6d416231107f440d8147faed88</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 01:07:32</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.split</element><position>4</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 01:07:32</sys_created_on><sys_id>137cfb6541a231107f440d8147faed61</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="orphan_ci_remediation" sys_domain="global" view="Default view">7f083b6d416231107f440d8147faed88</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 01:07:32</sys_updated_on><sys_user/><type>.split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>priority</element><position>5</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 01:07:32</sys_created_on><sys_id>937cfb6541a231107f440d8147faed61</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="orphan_ci_remediation" sys_domain="global" view="Default view">7f083b6d416231107f440d8147faed88</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 01:07:32</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>state</element><position>6</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 01:07:32</sys_created_on><sys_id>177cfb6541a231107f440d8147faed61</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="orphan_ci_remediation" sys_domain="global" view="Default view">7f083b6d416231107f440d8147faed88</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 01:07:32</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>parent</element><position>7</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 01:07:32</sys_created_on><sys_id>977cfb6541a231107f440d8147faed61</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="orphan_ci_remediation" sys_domain="global" view="Default view">7f083b6d416231107f440d8147faed88</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 01:07:32</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.end_split</element><position>8</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 01:07:32</sys_created_on><sys_id>1b7cfb6541a231107f440d8147faed61</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="orphan_ci_remediation" sys_domain="global" view="Default view">7f083b6d416231107f440d8147faed88</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 01:07:32</sys_updated_on><sys_user/><type>.end_split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>short_description</element><position>9</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 01:07:32</sys_created_on><sys_id>9b7cfb6541a231107f440d8147faed61</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="orphan_ci_remediation" sys_domain="global" view="Default view">7f083b6d416231107f440d8147faed88</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 01:07:32</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>description</element><position>10</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 01:07:32</sys_created_on><sys_id>1f7cfb6541a231107f440d8147faed61</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="orphan_ci_remediation" sys_domain="global" view="Default view">7f083b6d416231107f440d8147faed88</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 01:07:32</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>work_notes</element><position>11</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 01:07:32</sys_created_on><sys_id>9f7cfb6541a231107f440d8147faed61</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="orphan_ci_remediation" sys_domain="global" view="Default view">7f083b6d416231107f440d8147faed88</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 01:07:32</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>activity.xml</element><position>12</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 01:07:32</sys_created_on><sys_id>137cfb6541a231107f440d8147faed62</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter display_value="Activities (filtered)">444ea5c6bf310100e628555b3f0739d6</sys_ui_formatter><sys_ui_section caption="NULL" display_value="" name="orphan_ci_remediation" sys_domain="global" view="Default view">7f083b6d416231107f440d8147faed88</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 01:07:32</sys_updated_on><sys_user/><type>formatter</type></sys_ui_element><sys_ui_section action="INSERT_OR_UPDATE"><caption/><header>false</header><name>orphan_ci_remediation</name><roles/><sys_class_name>sys_ui_section</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 00:48:11</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>7f083b6d416231107f440d8147faed88</sys_id><sys_mod_count>0</sys_mod_count><sys_name>orphan_ci_remediation</sys_name><sys_overrides/><sys_package display_value="Configuration Management (CMDB)" source="com.snc.cmdb">dfa3e79f9f2131107f44e6ca4224abef</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_section_7f083b6d416231107f440d8147faed88</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:48:11</sys_updated_on><sys_user/><title>true</title><view display_value="Default view" name="NULL">Default view</view><view_name/></sys_ui_section></sys_ui_section></record_update>]]></payload>
<payload_hash>1955660297</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>30230c7d41a231107f440d8147faed45</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bdad19d3f0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>orphan_ci_remediation</table>
<target_name>Orphan CI Remediation</target_name>
<type>Form Layout</type>
<update_domain>global</update_domain>
<update_guid>137cfb6588a23110bb619e11ffdb426f</update_guid>
<update_guid_history>137cfb6588a23110bb619e11ffdb426f:1955660297,1b7cbb65aca23110224430aac695b195:-1008669786</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_8de97c95092231107f445d7a5f5e1350</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>cl.instructor_instance</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:18:50</sys_created_on><sys_id>8de97c95092231107f445d7a5f5e1350</sys_id><sys_mod_count>1</sys_mod_count><sys_name>cl.instructor_instance</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_8de97c95092231107f445d7a5f5e1350</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:24:06</sys_updated_on><type>string</type><value>false</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=8de97c95092231107f445d7a5f5e1350"/></record_update>]]></payload>
<payload_hash>-1572396138</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>34230c7d41a231107f440d8147faed41</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd402fc7b0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cl.instructor_instance</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>59d8c55195a63110fc17e107ce9b4180</update_guid>
<update_guid_history>59d8c55195a63110fc17e107ce9b4180:-1572396138,d5e97c955c22311000fb17a7181d8c57:-1860075015</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_list_control_1b1fe7a1416231107f440d8147faed03</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_ui_list_control"><sys_ui_list_control action="INSERT_OR_UPDATE"><columns_condition/><disable_nlq>false</disable_nlq><edit_condition/><edit_default_filter/><edit_roles/><empty_condition/><filter_condition/><filter_roles/><hierarchical_lists>false</hierarchical_lists><label/><link_condition/><link_roles/><list_edit_insert_row>false</list_edit_insert_row><list_edit_ref_qual_tag/><list_edit_type/><name>u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a</name><new_condition/><new_roles/><omit_columns_if_empty>false</omit_columns_if_empty><omit_count>false</omit_count><omit_count_views>false</omit_count_views><omit_count_views_list/><omit_drilldown_link>false</omit_drilldown_link><omit_edit_button>true</omit_edit_button><omit_filters>false</omit_filters><omit_if_empty>false</omit_if_empty><omit_links>false</omit_links><omit_new_button>true</omit_new_button><related_list/><sys_class_name>sys_ui_list_control</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 00:09:06</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>1b1fe7a1416231107f440d8147faed03</sys_id><sys_mod_count>0</sys_mod_count><sys_name>u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a</sys_name><sys_overrides display_value="">global</sys_overrides><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_list_control_1b1fe7a1416231107f440d8147faed03</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:09:06</sys_updated_on></sys_ui_list_control></record_update>]]></payload>
<payload_hash>-1564499775</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>34230c7d41a231107f440d8147faed44</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda9c1da70000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a</table>
<target_name>u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a</target_name>
<type>List Control</type>
<update_domain>global</update_domain>
<update_guid>931fe7a15c623110c9f8814157acb706</update_guid>
<update_guid_history>931fe7a15c623110c9f8814157acb706:-1564499775</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_5ac7b811092231107f445d7a5f5e136c</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>false</ignore_cache><is_private>false</is_private><name>protected.script.values.kmf.rekeyed</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:09:38</sys_created_on><sys_id>5ac7b811092231107f445d7a5f5e136c</sys_id><sys_mod_count>0</sys_mod_count><sys_name>protected.script.values.kmf.rekeyed</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_5ac7b811092231107f445d7a5f5e136c</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:09:38</sys_updated_on><type>string</type><value>true</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=5ac7b811092231107f445d7a5f5e136c"/></record_update>]]></payload>
<payload_hash>-798323714</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>38230c7d41a231107f440d8147faed40</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3beee730000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>protected.script.values.kmf.rekeyed</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>94d7f81110223110317e25372ae5f6a9</update_guid>
<update_guid_history>94d7f81110223110317e25372ae5f6a9:-798323714</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_fae9bc95092231107f445d7a5f5e1398</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>cl.appstore.registration.version</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:18:57</sys_created_on><sys_id>fae9bc95092231107f445d7a5f5e1398</sys_id><sys_mod_count>1</sys_mod_count><sys_name>cl.appstore.registration.version</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_fae9bc95092231107f445d7a5f5e1398</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:24:03</sys_updated_on><type>string</type><value>Vancouver Patch 2</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=fae9bc95092231107f445d7a5f5e1398"/></record_update>]]></payload>
<payload_hash>-85000362</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>38230c7d41a231107f440d8147faed43</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd402f0780000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cl.appstore.registration.version</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>e4d8c551bea63110ba53b07e4b49ea1c</update_guid>
<update_guid_history>e4d8c551bea63110ba53b07e4b49ea1c:-85000362,87e9bc95ae2231108d4f187cbf5a6d9f:-482405959</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_ee45121ec0a8011b0009266628de9041</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description>Enable external authentication.</description><ignore_cache>false</ignore_cache><is_private>false</is_private><name>glide.authenticate.external</name><read_roles/><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>glide.maint</sys_created_by><sys_created_on>2006-06-19 21:49:32</sys_created_on><sys_id>ee45121ec0a8011b0009266628de9041</sys_id><sys_mod_count>4</sys_mod_count><sys_name>glide.authenticate.external</sys_name><sys_package display_value="System (glidesoft)" source="glidesoft">7630ef139f2131107f44e6ca4224ab65</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_ee45121ec0a8011b0009266628de9041</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:22:12</sys_updated_on><type>boolean</type><value>true</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=ee45121ec0a8011b0009266628de9041"/></record_update>]]></payload>
<payload_hash>-127001159</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>3c230c7d41a231107f440d8147faed42</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd40140820000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>glide.authenticate.external</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>ad6849dd8866311038b5bceb92b9024e</update_guid>
<update_guid_history>ad6849dd8866311038b5bceb92b9024e:-127001159,5d6849dd456631101ff09f8e195cd049:2075652726</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_wizard_answer_ff70f325416231107f440d8147faedb9</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_wizard_answer"><sys_wizard_answer action="INSERT_OR_UPDATE"><active>true</active><answer>New Critical Incidents with No Owner-Query Results</answer><button_label/><dependent_value/><element/><name>Critical Incidents with No Owner-Query Results</name><next_question/><order>100</order><payload_name/><question display_value="Query Builder Results" name="Query Builder Results">85e4ab1b9f6131107f44e6ca4224abb9</question><roles/><script/><sys_class_name>sys_wizard_answer</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 00:15:09</sys_created_on><sys_id>ff70f325416231107f440d8147faedb9</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Critical Incidents with No Owner-Query Results</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_wizard_answer_ff70f325416231107f440d8147faedb9</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:15:09</sys_updated_on><table/><target_url>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da.do</target_url><type>1</type></sys_wizard_answer></record_update>]]></payload>
<payload_hash>-1829492707</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>3c230c7d41a231107f440d8147faed45</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bdaa1a7270000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>Critical Incidents with No Owner-Query Results</target_name>
<type>Answer</type>
<update_domain>global</update_domain>
<update_guid>8480f32507623110af800e579dcd08bb</update_guid>
<update_guid_history>8480f32507623110af800e579dcd08bb:-1829492707</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_c1b639bd53d373008ec4ddeeff7b1254</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>ueS02KJXm39NjM801pPZWg==</checksum><description>All invoke operations for WMI Collector</description><directory>false</directory><name>WMIInvokeOperations.psm1</name><parent display_value="WMICollector">5b2635bd53d373008ec4ddeeff7b1261</parent><script>&lt;#&#13;
    This method execute command on the remote host and types the result on the console (no return value).&#13;
    This method uses launchProcess method in LaunchProc.&#13;
#&gt;&#13;
function executeCommand{&#13;
    param([string]$command, [int]$timeoutSec, [bool]$stdErrInStdOut=$true)&#13;
    &#13;
    if (-not $command){&#13;
        write-error "Command is required for this operation, quit";&#13;
        return;&#13;
    }&#13;
    &#13;
    if ($computer){&#13;
        try{&#13;
            if (-not $tmpDir){&#13;
                SNCLog-DebugInfo "Did not received tmpDir. starting queries to get tmpDir";&#13;
                $tmpDir = getTempDirectory;&#13;
            }&#13;
&#13;
            if (-not $tmpDir) {&#13;
                throw 'Could not execute command because $tmpDir is null';&#13;
            }&#13;
            &#13;
            &lt;# We need a relative path for the UNC path:&#13;
                $uncPath = \\&lt;IP&gt;\&lt;path1&gt;\&lt;path2&gt;..&#13;
                $uncRelativePath = &lt;path1&gt;\&lt;path2&gt;..&#13;
            #&gt;&#13;
            &#13;
            # mapAdminShareUncPath is in WMIFileOperations.psm1&#13;
            $uncPath = mapAdminShareUncPath -remoteHost $computer -localPath $tmpDir;&#13;
            $uncRelativePath = getRelativeUncPath -uncPath ($uncPath.toString());&#13;
            # Check if we can access the UNC Path, if not create a drive that will assure the use of UNC Path. If fails an exception will be thrown.&#13;
            if (-not (test-path -path $uncPath)) {&#13;
                SNCLog-DebugInfo "Cannot access $uncPath, mapping a drive.";&#13;
                # mapDrive is in CommonUtils.psm1&#13;
                $drive = mapDrive -path $uncPath;&#13;
                SNCLog-DebugInfo "A mapped drive: $drive was created to access $uncPath";&#13;
            }&#13;
&#13;
            SNCLog-DebugInfo "Got a relative UNC path: $uncRelativePath for $computer";&#13;
            &#13;
            &lt;# launchProcess is in LaunchProc.psm1. launchProcess method types the output directly on the screen&#13;
                launchProcess is using a relative UNC path, this is why we have $uncRelativePath&#13;
            #&gt;&#13;
            if ($timeoutSec -and $timeoutSec -gt 0) {&#13;
                SNCLog-DebugInfo "Running: launchProcess -computer $computer -cred $cred -command '$command' -secondsToWait $timeoutSec -remoteBaseDir $uncRelativePath -UTF8 -shouldKillProcess $true -stdErrInStdOut $stdErrInStdOut;";&#13;
                # This Method is in LaunchProc&#13;
                launchProcess -computer $computer -cred $cred -command $command -secondsToWait $timeoutSec -remoteBaseDir $uncRelativePath.toString() -UTF8 -shouldKillProcess $true -stdErrInStdOut $stdErrInStdOut;&#13;
              } else {&#13;
                # This Method is in LaunchProc&#13;
                SNCLog-DebugInfo "Running: launchProcess -computer $computer -cred $cred -command '$command' -remoteBaseDir $uncRelativePath -UTF8 -shouldKillProcess $true -stdErrInStdOut $stdErrInStdOut;";&#13;
                launchProcess -computer $computer -cred $cred -command $command -remoteBaseDir $uncRelativePath -UTF8 -shouldKillProcess $true -stdErrInStdOut $stdErrInStdOut;&#13;
            }&#13;
        } finally{&#13;
            if ($drive){&#13;
                SNCLog-DebugInfo "Unmapping drive: $drive";&#13;
                unmapDrive -drive $drive;&#13;
            }&#13;
        }&#13;
    }else{&#13;
        #Run Locally:&#13;
        return invoke-expression $command;&#13;
    }&#13;
}&#13;
&#13;
function getRelativeUncPath{&#13;
    param([string]$uncPath)&#13;
    &#13;
    $uncPath = standardizePath -path $uncPath;&#13;
    $rtn = $uncPath;&#13;
    &#13;
    if (isUncPath -path $uncPath){&#13;
        $arr = $uncPath.split("\", 4);&#13;
&#13;
        # Remove the \\&lt;IP&gt;\ fron UNC&#13;
        if ($arr[3]){&#13;
            $rtn = $arr[3];&#13;
        }&#13;
    }&#13;
    &#13;
    if ($rtn.endsWith("\")){&#13;
        $rtn = $rtn.substring(0, $rtn.length - 1);&#13;
    }&#13;
    &#13;
    return $rtn;&#13;
}&#13;
&#13;
function invokeMethodOnClass {&#13;
    param([string]$class, [string]$method)&#13;
    &#13;
    try{&#13;
        if ($cred) {&#13;
            SNCLog-DebugInfo "About to invoke method: invoke-wmimethod -class $class -name $methode -computer $computer -credential $cred -EA Stop;";&#13;
            $info = invoke-wmimethod -class $class -name $method -computer $computer -credential $cred -EA Stop;&#13;
        } else {&#13;
            SNCLog-DebugInfo "About to invoke method: invoke-wmimethod -class $class -name $method -computer $computer -EA Stop;";&#13;
            $info = invoke-wmimethod -class $class -name $method -computer $computer -EA Stop;&#13;
        }&#13;
        &#13;
        if ($info.ReturnValue -eq 0) {&#13;
            return $true&#13;
        } else{&#13;
            write-error ("Could not invoke $method on $class, got return value: " + $info.ReturnValue + "($info)");&#13;
        }&#13;
    } catch{&#13;
        write-error ("Could not invoke wmi method $method on ${class}: " + $_.Exception.Message);&#13;
    }&#13;
}&#13;
&#13;
function invokeMethodOnObjects {&#13;
    param([string]$query, [string]$namespace, [string]$method)&#13;
    &#13;
    $namespace = standardizeNamespace -namespace $namespace;&#13;
    &#13;
    try{&#13;
        # If we have credential&#13;
        if ($cred){&#13;
            SNCLog-DebugInfo "About to run: Get-WmiObject -namespace $namespace -Query $query -ComputerName $computer -Credential $cred -ErrorAction Stop;";&#13;
            $objClass = Get-WmiObject -namespace $namespace -Query $query -ComputerName $computer -Credential $cred -ErrorAction Stop | ForEach-Object { Invoke-WmiMethod -InputObject $_ -Name $method } ;&#13;
        }&#13;
        # If we do not have credential, but we have computer (use MID service account credential)&#13;
        elseif ($computer){&#13;
            SNCLog-DebugInfo "About to run: Get-WmiObject -namespace $namespace -Query $query -ComputerName $computer -ErrorAction Stop;";&#13;
            $objClass = Get-WmiObject -namespace $namespace -Query $query -ComputerName $computer -ErrorAction Stop | ForEach-Object { Invoke-WmiMethod -InputObject $_ -Name $method } ;&#13;
        }else{&#13;
            SNCLog-DebugInfo "About to run: Get-WmiObject -namespace $namespace -Query $query -ErrorAction Stop;";&#13;
            $objClass = Get-WmiObject -namespace $namespace -Query $query -ErrorAction Stop | ForEach-Object { Invoke-WmiMethod -InputObject $_ -Name $method } ;&#13;
        }&#13;
        &#13;
        # We would like to return all properties requested - this way we walk over all properties better than Get-WMIObject -query&#13;
        $output = "";&#13;
        $objClass | ForEach-Object {&#13;
            foreach($property in $_.Properties) {&#13;
                if ($property.Value -is [array]){&#13;
                    $output += $property.Name + "`t:`t" + $ARRAY_INDICATOR_START + ($property.Value -join ",") + $ARRAY_INDICATOR_END + "`n";&#13;
                } else {&#13;
                    $output += $property.Name + "`t:`t" + $property.Value + "`n";&#13;
                }&#13;
            }&#13;
            $output += "`n";&#13;
        }&#13;
        &#13;
        if ($output){&#13;
            $output = $output.trim();&#13;
        }&#13;
        &#13;
        return $output;&#13;
    } catch{&#13;
        write-error ("Could not get query $query on namespace=$namespace. Original Exception: " + $_.Exception.Message);&#13;
    }&#13;
}</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>nisan.barzion</sys_created_by><sys_created_on>2019-08-16 23:32:49</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>c1b639bd53d373008ec4ddeeff7b1254</sys_id><sys_mod_count>19</sys_mod_count><sys_name>WMIInvokeOperations.psm1</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_c1b639bd53d373008ec4ddeeff7b1254</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:56</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>321231849</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>60230c7d41a231107f440d8147faed38</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e008370000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>WMIInvokeOperations.psm1</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>0a10415de5a23110d9176711fcd1a511</update_guid>
<update_guid_history>0a10415de5a23110d9176711fcd1a511:321231849,8610415d07a231107ac57500fd4cdd10:-2041778623</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>pa_dashboards_permissions_1c830665e42231107f443c8410589e10</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="pa_dashboards_permissions"><pa_dashboards_permissions action="INSERT_OR_UPDATE"><dashboard display_value="Discovery Dashboard">98db0f8a0fc03010ce4d142386767e44</dashboard><delete>true</delete><group/><identity>pa_power_user</identity><read>true</read><role display_value="pa_power_user" name="pa_power_user">05dc30b3bf101100b96dac808c07392b</role><sys_class_name>pa_dashboards_permissions</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 16:18:57</sys_created_on><sys_id>1c830665e42231107f443c8410589e10</sys_id><sys_mod_count>0</sys_mod_count><sys_name>pa_power_user</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>pa_dashboards_permissions_1c830665e42231107f443c8410589e10</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 16:18:57</sys_updated_on><type>1</type><user/><write>true</write></pa_dashboards_permissions></record_update>]]></payload>
<payload_hash>-120347519</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>60230c7d41a231107f440d8147faed3b</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd8edadfa0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>pa_power_user</target_name>
<type>Dashboard Permissions</type>
<update_domain>global</update_domain>
<update_guid>d8830665be223110bb46458dcc7edf11</update_guid>
<update_guid_history>d8830665be223110bb46458dcc7edf11:-120347519</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da_u_incident_1</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_incident_1" table="u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da"><active>true</active><array>false</array><attributes>encode_utf8=false</attributes><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label>Incident 1</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_incident_1</element><element_reference>false</element_reference><foreign_database/><formula/><function_definition/><function_field>false</function_field><internal_type display_value="Reference">reference</internal_type><mandatory>false</mandatory><max_length>32</max_length><name>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference display_value="Incident" name="incident">incident</reference><reference_cascade_rule>clear</reference_cascade_rule><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 00:15:11</sys_created_on><sys_id>60803725416231107f440d8147faed37</sys_id><sys_name>Incident 1</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da_u_incident_1</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:15:12</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><virtual_type/><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>-398557164</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>60230c7d41a231107f440d8147faed3e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bdaa1b3cd0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</table>
<target_name>Critical Incidents with No Owner-Query Results.Incident 1</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>388037255a623110c187b329904cd38b</update_guid>
<update_guid_history>388037255a623110c187b329904cd38b:-398557164,ec803725f362311076288ff9efa60e63:-135312158</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_20459b889ff322001d753758442e7047</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>ETwbD9bAYvfQ+CKwUTkplA==</checksum><description/><directory>false</directory><name>pkg_munger.bash</name><parent display_value="SSHScriptFiles">48deb961ff123100ab8fffffffffff07</parent><script>#! /bin/bash
cmd_test=$(whereis -b rpm | grep ': /')
cmd_test2=$(which rpm)
result=''
if [[ -n "$cmd_test" &amp;&amp; -n "$cmd_test2" ]]
then
   result=$(rpm -q -a --qf 'Package: %{NAME}\nStatus: install ok installed\nMaintainer: %{VENDOR}\nVersion: %{VERSION}\nRelease: %{RELEASE}\n')
   if [ -n "$result" ]
   then
     echo "$result"
   fi
fi   

# It's possible to not get anything back from rpm. If that's the case, try dpkg 
if [[ -z "$result" &amp;&amp; -e /var/lib/dpkg/status ]]
then
   cat /var/lib/dpkg/status | egrep '^Status:|^Package:|^Maintainer:|^Version:'
fi</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>oron.subayi</sys_created_by><sys_created_on>2016-12-15 11:19:39</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>20459b889ff322001d753758442e7047</sys_id><sys_mod_count>3</sys_mod_count><sys_name>pkg_munger.bash</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_20459b889ff322001d753758442e7047</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:23</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>1668745449</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>6023c87d41a231107f440d8147faeddd</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e245500000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>pkg_munger.bash</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>75a00151c9e23110aea0e672b89ad667</update_guid>
<update_guid_history>75a00151c9e23110aea0e672b89ad667:1668745449,f1a0015183e23110f1ef48e52027a166:-504869647</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_9eff59a773033300d4c1b7385ef6a79b</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>DVDpBEAHtkBsjPvcpBWTQQ==</checksum><description>WinRM implementation of functions for querying Windows registry and WMI tables</description><directory>false</directory><name>WinRMQueryOperations.psm1</name><parent display_value="WinRMCollector">d90565b173533300d4c1b7385ef6a714</parent><script>function executeQuery {&#13;
    param([string]$namespace, [string]$query = $(throw 'The query parameter is required.'))&#13;
    # If we did not get a namespace, use the default&#13;
    $namespace = standardizeNamespace -namespace $namespace;&#13;
&#13;
    $sb = {&#13;
        param([string]$namespace, [string]$query, [string]$internalNamespace, [string]$internalClassname, [string]$internalWhere, [string]$ARRAY_INDICATOR_START, [string]$ARRAY_INDICATOR_END, [string]$OBJECT_INDICATOR_START, [string]$OBJECT_INDICATOR_END, [string]$ARRAY_DELIMITER, [string]$OBJECT_DELIMITER);&#13;
        $wmiQueryResults = Get-WmiObject -Namespace $namespace -Query $query -ErrorAction Stop;&#13;
&#13;
        $wmiQueryResults | ForEach-Object {&#13;
            # output each property in the object&#13;
            if ($internalWhere) {&#13;
                "$internalWhere";&#13;
            }&#13;
            "{0}`t:`t{1}" -f $internalNamespace, $_.__NAMESPACE;&#13;
            "{0}`t:`t{1}" -f $internalClassname, $_.__CLASS;&#13;
            "__CLASS`t:`t{0}" -f $_.__CLASS;&#13;
            foreach ($property in $_.Properties) {&#13;
                $value = $property.Value;&#13;
                if ($value -is [array]) {&#13;
                    $value = $property.Value;&#13;
                    $items = @();&#13;
                    foreach ($item in $value) {&#13;
                        if ($item -is [System.Management.ManagementBaseObject]) {&#13;
                            # the item is an object, expand the object by printing the object in this format&#13;
                            # {key1=value1,key2=value2,key3=value3}&#13;
                            $keyValues = @("$internalNamespace=$($item.__NAMESPACE)", "$internalClassname=$($item.__CLASS)");&#13;
                            $keyValues += ($item.Properties | ForEach-Object {&#13;
                                if ($_.Value -ne $null) {&#13;
                                    "$($_.Name)=$($_.Value)";&#13;
                                }&#13;
                            });&#13;
&#13;
                            $commaSeparatedKeyValues = $keyValues -join $OBJECT_DELIMITER&#13;
                            if ($commaSeparatedKeyValues) {&#13;
                                $items += "${OBJECT_INDICATOR_START}$commaSeparatedKeyValues${OBJECT_INDICATOR_END}";&#13;
                            }&#13;
                        } else {&#13;
                            # the item is not an object, so add it as is to the list of itemStrings&#13;
                            $items += $item;&#13;
                        }&#13;
                    }&#13;
&#13;
                    $commaSeparatedItems = $items -join $ARRAY_DELIMITER;&#13;
                    "$($Property.Name)`t:`t${ARRAY_INDICATOR_START}${commaSeparatedItems}${ARRAY_INDICATOR_END}";&#13;
                } elseif ($value -is [System.Management.ManagementBaseObject]) {&#13;
                    # expand a single object&#13;
                    $keyValues = ($value.Properties | ForEach-Object {&#13;
                        if ($_.Value -ne $null) {&#13;
                            $stringValue = $_.Value;&#13;
                            if($stringValue -isNot [string]) {&#13;
                                $stringValue = [string]$stringValue;&#13;
                            }&#13;
                            $escapedValue = ($stringValue).Replace("\", "\\").Replace("`"", "\`"");&#13;
                            ("$($_.Name)=`"$escapedValue`"");&#13;
                        }&#13;
                    });&#13;
&#13;
                    $commaSeparatedKeyValues = $keyValues -join ',';&#13;
                    if ($commaSeparatedKeyValues) {&#13;
                        # construct prefix&#13;
                        # this prefix attempts to match how the path to the object is printed when objects are expanded by Get-WMIObject itself&#13;
                        $prefix = "\\.\$($value.__NAMESPACE):$($value.__CLASS).";&#13;
                        "$($Property.Name)`t:`t$prefix$commaSeparatedKeyValues";&#13;
                    }&#13;
&#13;
                } elseif ($property.Value -ne $null) {&#13;
                    "$($Property.Name)`t:`t$($Property.Value)";&#13;
                }&#13;
            }&#13;
            # output an empty line to separate objects&#13;
            Write-Output '';&#13;
        }&#13;
    }&#13;
&#13;
    $internalWhere = getInternalWhere -query $query -namespace $namespace;&#13;
    try {&#13;
        # If we have a PowerShell session for remoting&#13;
        if ($SNC_session) {&#13;
            $sessionString = 'remote session';&#13;
            SNCLog-DebugInfo "Running wmi query through the $sessionString. Namespace: $namespace and Query: $query"&#13;
            &#13;
            if (isJEACodeSigning) {&#13;
                $_params = @{  &#13;
                    "namespace" = $namespace&#13;
                    "query" = $query&#13;
                    "internalNamespace" = $INTERNAL_NAMESPACE&#13;
                    "internalClassname" = $INTERNAL_CLASSNAME&#13;
                    "internalWhere" = $internalWhere&#13;
                    "ARRAY_INDICATOR_START" = $ARRAY_INDICATOR_START&#13;
                    "ARRAY_INDICATOR_END" = $ARRAY_INDICATOR_END&#13;
                    "OBJECT_INDICATOR_START" = $OBJECT_INDICATOR_START&#13;
                    "OBJECT_INDICATOR_END" = $OBJECT_INDICATOR_END&#13;
                    "ARRAY_DELIMITER" = $ARRAY_DELIMITER&#13;
                    "OBJECT_DELIMITER" = $OBJECT_DELIMITER&#13;
                }&#13;
                $output = invokeJEAExecuteScript $SNC_session $sb.toString() $_params -ErrorAction Stop;&#13;
            } else {&#13;
                $output = Invoke-Command -Session $SNC_session -ScriptBlock $sb -ArgumentList $namespace,$query,$INTERNAL_NAMESPACE,$INTERNAL_CLASSNAME,$internalWhere,$ARRAY_INDICATOR_START,$ARRAY_INDICATOR_END,$OBJECT_INDICATOR_START,$OBJECT_INDICATOR_END,$ARRAY_DELIMITER,$OBJECT_DELIMITER -ErrorAction Stop;&#13;
            }&#13;
        } else {&#13;
            $sessionString = 'local session';&#13;
            # pass $query and $namespace as parameters to the script block and run it&#13;
            SNCLog-DebugInfo "Running wmi query through the $sessionString. Namespace: $namespace and Query: $query";&#13;
            $output = &amp; $sb -namespace $namespace -query $query -internalNamespace $INTERNAL_NAMESPACE -internalClassname $INTERNAL_CLASSNAME -internalWhere $internalWhere -ARRAY_INDICATOR_START $ARRAY_INDICATOR_START -ARRAY_INDICATOR_END $ARRAY_INDICATOR_END -OBJECT_INDICATOR_START $OBJECT_INDICATOR_START -OBJECT_INDICATOR_END $OBJECT_INDICATOR_END -ARRAY_DELIMITER $ARRAY_DELIMITER -OBJECT_DELIMITER $OBJECT_DELIMITER;&#13;
        }&#13;
        &#13;
        return ($output | Out-String).Trim();&#13;
    } catch {&#13;
        Write-Error ("Could not get query $query on namespace=$namespace through the $sessionString. Original Exception: " + $_.Exception.Message);&#13;
    }&#13;
}&#13;
&#13;
function getRegistryValues {&#13;
    param([string]$hive, [string]$key, [string]$commaSeparatedNames)&#13;
&#13;
    $sb = {&#13;
        param([string]$hive, [string]$key, [string]$commaSeparatedNames);&#13;
        $path = "Registry::$hive\$key";&#13;
        if (-not $commaSeparatedNames -or $commaSeparatedNames -match '\*') {&#13;
            # retrieves a list of all the names in the key&#13;
            $registryKey = Get-Item $path -ErrorAction SilentlyContinue;&#13;
            if (-not $registryKey) {&#13;
                return;&#13;
            }&#13;
            $valueNames = ($registryKey | Select-Object Property).Property;&#13;
        }&#13;
        else {&#13;
            # grab specific values from the key and select the specific values&#13;
            $valueNames = ($commaSeparatedNames -split ',') | foreach { $_.Trim() };&#13;
        }&#13;
&#13;
        # '' in the valueNames means to get default&#13;
        $valueNames = $valueNames | ForEach-Object {&#13;
            if ($_ -eq "''") {&#13;
                '(default)';&#13;
            } else {&#13;
                $_;&#13;
            }&#13;
        }&#13;
&#13;
        $values = Get-ItemProperty -Path $path -Name $valueNames -ErrorAction SilentlyContinue;&#13;
        $properties = $values.PSObject.Properties;&#13;
        &#13;
        $didOutputDefault = $false;&#13;
&#13;
        # iterate over the properties that were returned&#13;
        # this guarantees we only output registry values that exist &#13;
        $properties | ForEach-Object {&#13;
            # do not output properties that are not in the list of registry values that we requested&#13;
            if (-not ($valueNames -match $_.Name)) {&#13;
                return;&#13;
            }&#13;
             &#13;
            # expand any values that are arrays, modifies $values object directly&#13;
            if ($_.TypeNameOfValue -match 'String\[\]') {&#13;
                # legacy WMICollector separated strings with a line feed&#13;
                $values.($_.Name) = $values.($_.Name) -join "`n";&#13;
            } elseif ($_.TypeNameOfValue -match 'Byte\[\]') {&#13;
                $hexString = '';&#13;
                foreach ($decimalValue in $values.($_.Name)) {&#13;
                    # convert decimal values to 2 digit hex and concatenate&#13;
                    $hexString = $hexString + [String]::Format("{0:x2}", $decimalValue);&#13;
                }&#13;
                $values.($_.Name) = $hexString.ToUpper();&#13;
            }&#13;
&#13;
&#13;
            if ($_.Name -eq '(default)') {&#13;
                $didOutputDefault = $true;&#13;
                # parser expects the default with a key of ' '&#13;
                " : $($values.'(default)')";&#13;
            } else {&#13;
                "$($_.Name) : $($values.($_.Name))";&#13;
            }&#13;
        }&#13;
&#13;
        # output default if it was requested but was not output earlier&#13;
        # if it was not output earlier, it is empty&#13;
        if (-not $didOutputDefault -and ($valueNames -match '(default)')) {&#13;
            " : ";&#13;
        }&#13;
    }&#13;
&#13;
    try {&#13;
        if ($SNC_session) {&#13;
            $sessionString = 'remote session';&#13;
            SNCLog-DebugInfo "Running registry query through the $sessionString with hive: $hive, key: $key, value names: $commaSeparatedNames";&#13;
            if (isJEACodeSigning) {  &#13;
                $_params = @{&#13;
                    "hive" = $hive&#13;
                    "key" = $key&#13;
                    "commaSeparatedNames" = $commaSeparatedNames&#13;
                }&#13;
                $output = invokeJEAExecuteScript $SNC_session $sb.toString() $_params -ErrorAction Stop;&#13;
            } else {&#13;
                $output = Invoke-Command -Session $SNC_session -ScriptBlock $sb -ArgumentList $hive,$key,$commaSeparatedNames -ErrorAction Stop;&#13;
            }&#13;
        } else {&#13;
            $sessionString = 'local session';&#13;
            SNCLog-DebugInfo "Running registry query through the $sessionString with hive: $hive, key: $key, value names: $commaSeparatedNames";&#13;
            # pass function parameters to the script block and run it&#13;
            $output = &amp; $sb -hive $hive -key $key -commaSeparatedNames $commaSeparatedNames;&#13;
        }&#13;
        &#13;
        return $output;&#13;
    } catch {&#13;
        $valuesString = if ($commaSeparatedNames) { " ($commaSeparatedNames)" } else { '' };&#13;
        Write-Error ("Could not get registry values$valuesString of base key $hive and key $key through the $sessionString. Original Exception: " + $_.Exception.Message);&#13;
    }&#13;
}&#13;
&#13;
&lt;#&#13;
    This method enumurates the keys under a parent key.&#13;
    Parent key may be empty and will return the keys directly under the hive&#13;
    $hive should be a hex decimal value of the hive as a String.&#13;
    For example: &#13;
        HKEY_CLASSES_ROOT = 0x80000000&#13;
        HKEY_CURRENT_USER = 0x80000001&#13;
        HKEY_LOCAL_MACHINE = 0x80000002&#13;
        HKEY_USERS = 0x80000003&#13;
        HKEY_CURRENT_CONFIG = 0x80000005&#13;
        HKEY_DYN_DATA = 0x80000006&#13;
#&gt;&#13;
function enumKeys {&#13;
    param([string]$hive, [string]$parentKey)&#13;
&#13;
    $sb = {&#13;
        param([string]$hive, [string]$parentKey);&#13;
        $reg = Get-WmiObject -List -Namespace 'root\default' -ErrorAction Stop | Where-Object {$_.Name -eq "StdRegProv"};&#13;
        $res = $reg.EnumKey($hive, $parentKey);&#13;
&#13;
        if ($res -and $res.sNames) {&#13;
            return $res.sNames;&#13;
        }&#13;
    &#13;
        return '';&#13;
    }&#13;
&#13;
    try {&#13;
        if ($SNC_session) {&#13;
            $sessionString = 'remote session';&#13;
            SNCLog-DebugInfo "Enumerating the subkeys of $hive\$parentKey through the $sessionString";&#13;
            if (isJEACodeSigning) {  &#13;
                $_params = @{&#13;
                    "hive" = $hive&#13;
                    "parentKey" = $parentKey&#13;
                }&#13;
                $output = invokeJEAExecuteScript $SNC_session $sb.toString() $_params -ErrorAction Stop;&#13;
            } else {&#13;
                $output = Invoke-Command -Session $SNC_session -ScriptBlock $sb -ArgumentList $hive,$parentKey -ErrorAction Stop;&#13;
            }   &#13;
        } else {&#13;
            $sessionString = 'local session';&#13;
            SNCLog-DebugInfo "Enumerating the subkeys of $hive\$parentKey through the $sessionString";&#13;
            # pass function parameters to the script block and run it&#13;
            $output = &amp; $sb -hive $hive -parentKey $parentKey;&#13;
        }&#13;
        &#13;
        return $output;&#13;
    } catch {&#13;
        Write-Error ("Could not get enumerate the subkeys of hive: $hive and parent key: $parentKey through the $sessionString. Original Exception: " + $_.Exception.Message);&#13;
    }&#13;
}&#13;
&#13;
function enumClass {&#13;
    param([string]$namespace, [string]$class)&#13;
&#13;
    $sb = {&#13;
        param([string]$namespace, [string]$class);&#13;
        Get-WmiObject -Namespace $namespace -Class $class -ErrorAction Stop | ForEach-Object { $_.Name };&#13;
    }&#13;
    &#13;
    try {&#13;
        if ($SNC_session) {&#13;
            $sessionString = 'remote session';&#13;
            SNCLog-DebugInfo "Enumerating class $class of namespace $namespace through the $sessionString";&#13;
            if (isJEACodeSigning) {  &#13;
                $_params = @{&#13;
                    "namespace" = $namespace&#13;
                    "class" = $class&#13;
                }&#13;
                $output = invokeJEAExecuteScript $SNC_session $sb.toString() $_params -ErrorAction Stop;&#13;
            } else {&#13;
                $output = Invoke-Command -Session $SNC_session -ScriptBlock $sb -ArgumentList $namespace,$class -ErrorAction Stop;&#13;
            }&#13;
        } else {&#13;
            $sessionString = 'local session';&#13;
            SNCLog-DebugInfo "Enumerating class $class of namespace $namespace through the $sessionString";&#13;
            # pass function parameters to the script block and run it&#13;
            $output = &amp; $sb -namespace $namespace -class $class;&#13;
        }&#13;
&#13;
        return ($output | Out-String).Trim();&#13;
    } catch {&#13;
        Write-Error "Could not get enumerate class $class of namespace $namespace through the $sessionString. Original Exception: $($_.Exception.Message)";&#13;
    }&#13;
}&#13;
&#13;
function enumClasses {&#13;
    param([string]$namespace)&#13;
    # If we did not get a namespace, use the default&#13;
    $namespace = standardizeNamespace -namespace $namespace;&#13;
&#13;
    enumClass -namespace $namespace -class 'meta_class';&#13;
}&#13;
&#13;
function enumNamespaces {&#13;
    param([string]$namespace)&#13;
    if (-not $namespace) {&#13;
        $namespace = 'root';&#13;
    }&#13;
&#13;
    enumClass -namespace $namespace -class '__NAMESPACE';&#13;
}&#13;
&#13;
function enumProperties {&#13;
    param([string]$namespace, [string]$classname)&#13;
    # If we did not get a namespace, use the default&#13;
    $namespace = standardizeNamespace -namespace $namespace;&#13;
&#13;
    $sb = {&#13;
        param([string] $namespace, [string]$classname);&#13;
        $cimClass = Get-CimClass -Namespace $namespace -ClassName $classname -ErrorAction Stop;&#13;
        return $cimClass.CimClassProperties.Name;&#13;
    }&#13;
&#13;
    try {&#13;
        if ($SNC_session) {&#13;
            $sessionString = 'remote session';&#13;
            SNCLog-DebugInfo "Enumerating properties from classname $classname in namespace $namespace through the $sessionString";&#13;
            if (isJEACodeSigning) {  &#13;
                $_params = @{&#13;
                    "namespace" = $namespace&#13;
                    "classname" = $classname&#13;
                }&#13;
                $output = invokeJEAExecuteScript $SNC_session $sb.toString() $_params -ErrorAction Stop;&#13;
            } else {&#13;
                $output = Invoke-Command -Session $SNC_session -ScriptBlock $sb -ArgumentList $namespace,$classname -ErrorAction Stop;&#13;
            }&#13;
        } else {&#13;
            $sessionString = 'local session';&#13;
            SNCLog-DebugInfo "Enumerating properties from classname $classname in namespace $namespace through the $sessionString";&#13;
            # pass function parameters to the script block and run it&#13;
            $output = &amp; $sb -namespace $namespace -classname $classname;&#13;
        }&#13;
        &#13;
        return $output;&#13;
    } catch {&#13;
        write-error ("Could not enumerate properties from classname $classname in namespace $namespace through the $sessionString. " + $_.Exception.Message);&#13;
    }&#13;
}&#13;
&#13;
function enumMethods {&#13;
    param([string]$namespace, [string]$classname)&#13;
    # If we did not get a namespace, use the default&#13;
    $namespace = standardizeNamespace -namespace $namespace;&#13;
&#13;
    $sb = {&#13;
        param([string] $namespace, [string]$classname);&#13;
        $cimClass = Get-CimClass -Namespace $namespace -ClassName $classname -ErrorAction Stop;&#13;
        foreach ($method in $cimClass.CimClassMethods) {&#13;
            # look for methods with no input parameters&#13;
            if ($method.Parameters.count -eq 0) {&#13;
                $method.Name;&#13;
            }&#13;
        }&#13;
    }&#13;
&#13;
    try {&#13;
        if ($SNC_session) {&#13;
            $sessionString = 'remote session';&#13;
            SNCLog-DebugInfo "Getting methods from classname $classname in namespace $namespace through the $sessionString";&#13;
            if (isJEACodeSigning) {  &#13;
                $_params = @{&#13;
                    "namespace" = $namespace&#13;
                    "classname" = $classname&#13;
                }&#13;
                $output = invokeJEAExecuteScript $SNC_session $sb.toString() $_params -ErrorAction Stop;&#13;
            } else {&#13;
                $output = Invoke-Command -Session $SNC_session -ScriptBlock $sb -ArgumentList $namespace,$classname -ErrorAction Stop;&#13;
            }&#13;
        } else {&#13;
            $sessionString = 'local session';&#13;
            SNCLog-DebugInfo "Getting methods from classname $classname in namespace $namespace through the $sessionString";&#13;
            # pass function parameters to the script block and run it&#13;
            $output = &amp; $sb -namespace $namespace -classname $classname;&#13;
        }&#13;
        &#13;
        return $output;&#13;
    } catch {&#13;
        write-error ("Could not get methods from classname $classname in namespace $namespace through the $sessionString. " + $_.Exception.Message);&#13;
    }&#13;
}&#13;
&#13;
function getProcessUserAndDomain {&#13;
    param([string]$commaSeparatedPids);&#13;
    &#13;
    $sb = {&#13;
        param([string]$commaSeparatedPids);&#13;
        $pids = $commaSeparatedPids -split "," | ForEach-Object { $_.Trim() };&#13;
        $processes = Get-WmiObject -Class 'Win32_process' | Where-Object -Property 'ProcessId' -In -Value $pids&#13;
        foreach ($process in $processes) {&#13;
            $owner = $process | Invoke-WmiMethod -Name 'GetOwner';&#13;
            "ProcessId:$($process.ProcessId),User:$($owner.User),Domain:$($owner.Domain)";&#13;
        }&#13;
    }&#13;
&#13;
    try {&#13;
        # If we have a PowerShell session for remoting&#13;
        if ($SNC_session) {&#13;
            $sessionString = 'remote session';&#13;
            SNCLog-DebugInfo "Getting user and domain info for processes $commaSeparatedPids through the $sessionString.";&#13;
            if (isJEACodeSigning) {  &#13;
                $_params = @{&#13;
                    "commaSeparatedPids" = $commaSeparatedPids&#13;
                }&#13;
                $output = invokeJEAExecuteScript $SNC_session $sb.toString() $_params -ErrorAction Stop;&#13;
            } else {&#13;
                $output = Invoke-Command -Session $SNC_session -ScriptBlock $sb -ArgumentList $commaSeparatedPids -ErrorAction Stop;&#13;
            }&#13;
        } else {&#13;
            $sessionString = 'local session';&#13;
            # pass $query and $namespace as parameters to the script block and run it&#13;
            SNCLog-DebugInfo "Getting user and domain info for processes $commaSeparatedPids through the $sessionString.";&#13;
            $output = &amp; $sb -commaSeparatedPids $commaSeparatedPids;&#13;
        }&#13;
        &#13;
        return ($output | Out-String).Trim();&#13;
    } catch {&#13;
        Write-Error ("Could not get user and domain info for processes $commaSeparatedPids through the $sessionString. Original Exception: " + $_.Exception.Message);&#13;
    }&#13;
&#13;
}</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>benjamin.phan</sys_created_by><sys_created_on>2019-08-09 22:05:57</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>9eff59a773033300d4c1b7385ef6a79b</sys_id><sys_mod_count>82</sys_mod_count><sys_name>WinRMQueryOperations.psm1</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_9eff59a773033300d4c1b7385ef6a79b</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:55</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-876439082</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>64230c7d41a231107f440d8147faed37</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e004d50000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>WinRMQueryOperations.psm1</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>7d10015d32a23110666f0e8eb58ef8ee</update_guid>
<update_guid_history>7d10015d32a23110666f0e8eb58ef8ee:-876439082,f910015d25a23110104f66d99b2778ed:1702946751</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_fb4635bd53d373008ec4ddeeff7b12e0</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>2mPu3taMZW0St1ND68/B4g==</checksum><description>All query operations for WMI Collector </description><directory>false</directory><name>WMIQueryOperations.psm1</name><parent display_value="WMICollector">5b2635bd53d373008ec4ddeeff7b1261</parent><script>&lt;#&#13;
    This method execute WMI Query on a remote host with credentials, or using the same user as the process running.&#13;
    It also work on localhost&#13;
#&gt;&#13;
function executeQuery {&#13;
    param([string]$namespace, [string]$query)&#13;
&#13;
    $namespace = standardizeNamespace -namespace $namespace;&#13;
    $internalWhere = getInternalWhere -query $query -namespace $namespace;&#13;
    &#13;
    try {&#13;
        if ($SNC_session) {&#13;
            $sb = { Get-CimInstance -CimSession $SNC_session -Namespace $namespace -Query $query -ErrorAction Stop };&#13;
        } else {&#13;
            $sb = { Get-CimInstance -Namespace $namespace -Query $query -ErrorAction Stop };&#13;
        }&#13;
&#13;
        SNCLog-DebugInfo("About to run:" + $ExecutionContext.InvokeCommand.ExpandString($sb));&#13;
        Invoke-Command $sb | Format-Query-Result -internalNamespace $INTERNAL_NAMESPACE -internalClassname $INTERNAL_CLASSNAME -internalWhere $internalWhere;&#13;
    } catch{&#13;
        write-error ("Could not get query $query on namespace=$namespace. Original Exception: " + $_.Exception.Message);&#13;
    }&#13;
}&#13;
&#13;
function Format-Query-Result {&#13;
    [cmdletbinding()]&#13;
    param([parameter(Mandatory=$true, ValueFromPipeline=$true)]$pipelineInput, [string]$internalNamespace, [string]$internalClassname, [string]$internalWhere)&#13;
&#13;
    Process {&#13;
        foreach ($input in $pipelineInput) {&#13;
            "";&#13;
            if ($internalWhere) {&#13;
                $internalWhere;&#13;
            }&#13;
            "{0}`t:`t{1}" -f $internalNamespace, $_.CimSystemProperties.Namespace&#13;
            "{0}`t:`t{1}" -f $internalClassname, $_.CimSystemProperties.Classname&#13;
            "__CLASS`t:`t{0}" -f $_.CimSystemProperties.Classname&#13;
            foreach ($property in ($_.CimInstanceProperties)) {&#13;
                # We do not want to return empty values&#13;
                if ($property.Value -is [array]) {&#13;
                    $property.Name + "`t:`t" + (arrayToString -arr $property.Value);&#13;
                } elseif ($property.Value -ne $null) {&#13;
                    # propertyToString method is in CommonUtils&#13;
                    $propStr = propertyToString -property $property;&#13;
                    if (-not [string]::IsNullOrWhiteSpace($propStr)) {&#13;
                        $propStr&#13;
                    }&#13;
                }&#13;
            }&#13;
            ""&#13;
        }&#13;
    }&#13;
}&#13;
&#13;
&lt;#&#13;
    Corrently is not used - future support.&#13;
    Fetching registry while supporting wildcards - requires powershell on the target host as it is using Get-ItemProperty on the target&#13;
#&gt;&#13;
function getMultipleRegistryTablesValues {&#13;
    param([string]$baseKey, [string]$key, [string]$commaSeparatedValues)&#13;
    &#13;
    $regFetch = "";&#13;
    &#13;
    $entry = $baseKey + "/" + $key;&#13;
    if ($commaSeparatedValues -and $commaSeparatedValues.indexOf("*") -eq -1 ){&#13;
        # Add specific fields on registry&#13;
        SNCLog-DebugInfo "Will get specific registry entries: $commaSeparatedValues for $baseKey/$key";&#13;
        $arrValues = $commaSeparatedValues -split "\s*,\s*"; # split and trim&#13;
        foreach ($val in $arrValues){&#13;
            $regFetch += $entry + "/" + $val + ",";&#13;
        }&#13;
        &#13;
        #This method is in WMIFetch.psm1&#13;
        $regFetch = removeLastComma -str $regFetch;&#13;
    } else{&#13;
        SNCLog-DebugInfo "Will get all entries: $commaSeparatedValues";&#13;
        $regFetch = $entry + "/*";&#13;
    }&#13;
    &#13;
    SNCLog-DebugInfo "Running: fetchMultipleWMI -computer $computer -cred $cred -wmi 'true' -WMI_FetchData '$regFetch' -filterHotfixValue 'true' -output_format 'raw';";&#13;
    #This method is in WMIFetch.psm1&#13;
    fetchMultipleWMI -computer $computer -cred $cred -wmi "true" -WMI_FetchData $regFetch -filterHotfixValue "true" -output_format "raw";&#13;
}&#13;
&#13;
&lt;#&#13;
    Uses old probe code to fetch registry values.&#13;
    $hive should be the full name of the registry hive such as HKEY_LOCAL_MACHINE&#13;
    This method throws exceptions&#13;
#&gt;&#13;
function getRegistryValues{&#13;
    param([string]$hive, [string]$key, [string]$commaSeparatedNames)&#13;
   &#13;
    # Method is in WMIFetch; This is used to clear the arrays so we will only bring the value needed for now.&#13;
    clearRegistryFetchArrays;&#13;
    &#13;
    $entry = $hive + "\" + $key;&#13;
    # If * is in the values, that means we should fetch all of the registry values&#13;
    if ($commaSeparatedNames -and $commaSeparatedNames.indexOf("*") -eq -1 ){&#13;
        # Add specific fields on registry&#13;
        $arrValues = $commaSeparatedNames -split "\s*,\s*"; # split and trim&#13;
        SNCLog-DebugInfo "Will get specific registry entries: $commaSeparatedNames for $hive/$key";&#13;
        # This method is in WMIFetch.psm1&#13;
        addRegistryValuesToFetch -entry $entry -specificKeys $arrValues -shouldThrow -computer $computer -cred $cred;&#13;
    }&#13;
    else{&#13;
        # Fetch all fields on registry&#13;
        SNCLog-DebugInfo "Will get all entries for $hive/$key";&#13;
        # This method is in WMIFetch.psm1&#13;
        addRegistryValuesToFetch -entry $entry -shouldThrow -computer $computer -cred $cred;&#13;
    }&#13;
    &#13;
    SNCLog-DebugInfo "Running: fetchAndOutputRegistries -computer $computer -cred $cred;";&#13;
    # This method is in WMIFetch.psm1&#13;
    return fetchAndOutputRegistries -computer $computer -cred $cred -outputForWMIProvider $true;&#13;
}&#13;
&#13;
&lt;#&#13;
    This method List a class of a WMIObject and returns a specific attribute of the class.&#13;
    If the attirubte cannot be found, return empty string&#13;
#&gt;&#13;
function enumClass{&#13;
    param([string]$namespace, [string]$classname)&#13;
    &#13;
    # If we did not get a namespace, use the default&#13;
    if (-not $namespace){&#13;
        $nameSpace = "root\cimv2";&#13;
    }&#13;
    &#13;
    try{&#13;
        if ($computer -and $cred){&#13;
            SNCLog-DebugInfo "About to run: Get-WmiObject -List -Class $classname -namespace $namespace -ComputerName $computer -Credential $cred -ErrorAction Stop;";&#13;
            $obj = Get-WmiObject -List -Class $classname -namespace $namespace -ComputerName $computer -Credential $cred -ErrorAction Stop;&#13;
        } elseif ($computer){&#13;
            SNCLog-DebugInfo "About to run: Get-WmiObject -List -Class $classname -namespace $namespace -ComputerName $computer -ErrorAction Stop";&#13;
            $obj = Get-WmiObject -List -Class $classname -namespace $namespace -ComputerName $computer -ErrorAction Stop;&#13;
        }&#13;
        else{&#13;
            SNCLog-DebugInfo "About to run: Get-WmiObject -List -Class $classname -namespace $namespace -ErrorAction Stop;";&#13;
            $obj = Get-WmiObject -List -Class $classname -namespace $namespace -ErrorAction Stop;&#13;
        }&#13;
        &#13;
        return $obj;&#13;
    } catch{&#13;
        write-error ("Could not get an object from $namespace/$classname. " + $_.Exception.Message);&#13;
    }&#13;
    &#13;
    return "";&#13;
}&#13;
&#13;
function enumProperties{&#13;
    param([string]$namespace, [string]$classname)&#13;
    &#13;
    $att = "Properties";&#13;
    $obj = enumClass -namespace $namespace -classname $classname;&#13;
    if ($obj -and $obj.$att){&#13;
        return $obj.$att.Name;&#13;
    }&#13;
}&#13;
&#13;
function enumMethods{&#13;
    param([string]$namespace, [string]$classname)&#13;
    &#13;
    $att = "Methods";&#13;
    $obj = enumClass -namespace $namespace -classname $classname;&#13;
    $output = "";&#13;
    &#13;
    if ($obj -and $obj.$att){&#13;
        foreach ($item in $obj.$att){&#13;
            # look for methods with no input/output parameters&#13;
            if (-not $item.InParameters){&#13;
                if ($item.OutParameters -and $item.OutParameters.Properties.Count -eq 1){&#13;
                    $output += $item.Name + "`n";&#13;
                }&#13;
            }&#13;
        };&#13;
    }&#13;
    &#13;
    return $output.trim();&#13;
}&#13;
&#13;
&lt;#&#13;
    This method enumurates the keys under a parent key.&#13;
    Parent key may be empty and will return the keys directly under the hive&#13;
    $hive should be a hex decimal value of the hive as a String.&#13;
    For example: &#13;
        HKEY_CLASSES_ROOT = 0x80000000&#13;
        HKEY_CURRENT_USER = 0x80000001&#13;
        HKEY_LOCAL_MACHINE = 0x80000002&#13;
        HKEY_USERS = 0x80000003&#13;
        HKEY_CURRENT_CONFIG = 0x80000005&#13;
        HKEY_DYN_DATA = 0x80000006&#13;
#&gt;&#13;
function enumKeys{&#13;
    param([string]$hive, [string]$parentKey)&#13;
&#13;
    try{&#13;
        if ($cred) {&#13;
            $reg = Get-WmiObject -list -computer $computer -credential $cred -namespace root\default -ErrorAction Stop | where-object {$_.Name -eq "StdRegProv"}&#13;
        } else {&#13;
            $reg = Get-WmiObject -list -computer $computer -namespace root\default -ErrorAction Stop | where-object {$_.Name -eq "StdRegProv"}        &#13;
        }&#13;
    } catch{&#13;
        Write-error ("Could not get $hive. " + $_.Exception.Message);&#13;
    }&#13;
&#13;
    try{&#13;
        $res = $reg.EnumKey($hive, $parentKey);&#13;
    } catch {&#13;
        Write-error ("Could not query '$parentKey' from $hive." + $_.Exception.Message);&#13;
    }&#13;
    &#13;
    if ($res -and $res.sNames){&#13;
        return $res.sNames;&#13;
    }&#13;
    &#13;
    return "";&#13;
}&#13;
&#13;
function enumRootClass {&#13;
    param([string]$namespace, [string]$class)&#13;
    &#13;
    try {&#13;
        # If we have credential&#13;
        if ($cred) {&#13;
            $sb = { Get-WmiObject -namespace $namespace -class $class -ComputerName $computer -Credential $cred -ErrorAction Stop };&#13;
        }&#13;
        # If we do not have credential, but we have computer (use MID service account credential)&#13;
        elseif ($computer) {&#13;
            $sb = { Get-WmiObject -namespace $namespace -class $class -ComputerName $computer -ErrorAction Stop };&#13;
        } else {&#13;
            $sb = { Get-WmiObject -namespace $namespace -class $class -ErrorAction Stop }&#13;
        }&#13;
        &#13;
        SNCLog-DebugInfo("About to run:" + $ExecutionContext.InvokeCommand.ExpandString($sb));&#13;
        Invoke-Command $sb | Format-Single-Property -Property "Name";&#13;
    } catch {&#13;
        Write-Error ("Could not get query $query on namespace=$namespace. Original Exception: " + $_.Exception.Message);&#13;
    }&#13;
}&#13;
&#13;
function Format-Single-Property {&#13;
    [cmdletbinding()]&#13;
    param([parameter(Mandatory=$true, ValueFromPipeline=$true)]$pipelineInput, [string]$Property)&#13;
&#13;
    Process {&#13;
        ForEach ($input in $pipelineInput) {&#13;
            $input.$Property;&#13;
        }&#13;
    }&#13;
}&#13;
&#13;
function enumClasses{&#13;
    param([string]$namespace)&#13;
    &#13;
    # If we did not get a namespace, use the default&#13;
    if (-not $namespace){&#13;
        $nameSpace = "root\cimv2";&#13;
    }&#13;
    &#13;
    return enumRootClass -namespace $namespace -class "meta_class";&#13;
}&#13;
&#13;
function enumNamespaces{&#13;
    param([string]$namespace)&#13;
    &#13;
    # If we did not get a namespace, use the default&#13;
    if (-not $namespace){&#13;
        $nameSpace = "root";&#13;
    }&#13;
&#13;
    return enumRootClass -namespace $nameSpace -class "__NAMESPACE";&#13;
}&#13;
&#13;
function getProcessUserAndDomain {&#13;
    param([string]$commaSeparatedPids);&#13;
    $pids = $commaSeparatedPids -split "," | ForEach-Object { $_.Trim() };&#13;
&#13;
    # If we have credential&#13;
    if ($cred){&#13;
        SNCLog-DebugInfo "About to run: Get-WmiObject -ClassName 'Win32_Process' -ComputerName $computer -Credential $cred -ErrorAction Stop | Where-Object -Property 'processid' -Value $pids -In;";&#13;
        $processes = Get-WmiObject -ClassName 'Win32_Process' -ComputerName $computer -Credential $cred -ErrorAction Stop | Where-Object -Property 'processid' -Value $pids -In;&#13;
    }&#13;
    # If we do not have credential, but we have computer (use MID service account credential)&#13;
    elseif ($computer){&#13;
        SNCLog-DebugInfo "About to run: Get-WmiObject -ClassName 'Win32_Process' -ComputerName $computer -ErrorAction Stop | Where-Object -Property 'processid' -Value $pids -In;";&#13;
        $processes = Get-WmiObject -ClassName 'Win32_Process' -ComputerName $computer -ErrorAction Stop | Where-Object -Property 'processid' -Value $pids -In;&#13;
    }else{&#13;
        SNCLog-DebugInfo "About to run: Get-WmiObject -ClassName 'Win32_Process' -ErrorAction Stop | Where-Object -Property 'processid' -Value $pids -In;";&#13;
        $processes = Get-WmiObject -ClassName 'Win32_Process' -ErrorAction Stop | Where-Object -Property 'processid' -Value $pids -In;&#13;
    }&#13;
&#13;
    foreach ($process in $processes) {&#13;
        $owner = $process | Invoke-WmiMethod -Name 'GetOwner' -ErrorAction Stop;&#13;
        "ProcessId:$($process.ProcessId),User:$($owner.User),Domain:$($owner.Domain)";&#13;
    }&#13;
}</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>nisan.barzion</sys_created_by><sys_created_on>2019-08-16 23:19:02</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>fb4635bd53d373008ec4ddeeff7b12e0</sys_id><sys_mod_count>41</sys_mod_count><sys_name>WMIQueryOperations.psm1</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_fb4635bd53d373008ec4ddeeff7b12e0</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:57</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-1132253735</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>64230c7d41a231107f440d8147faed3a</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e00b330000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>WMIQueryOperations.psm1</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>9a10415d72a23110ea4672a7385df73a</update_guid>
<update_guid_history>9a10415d72a23110ea4672a7385df73a:-1132253735,1a10415d56a231107d9efb57c67ac639:-902007002</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a_null</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="" extends="cmdb_qb_result_base" table="u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a"><active>true</active><array>false</array><attributes>ignore_baseline=true</attributes><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label/><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element/><element_reference>false</element_reference><foreign_database/><formula/><function_definition/><function_field>false</function_field><internal_type display_value="Collection">collection</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 00:09:03</sys_created_on><sys_id>ee1fa7a1416231107f440d8147faed3c</sys_id><sys_name>u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a_null</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:09:03</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><virtual_type>script</virtual_type><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>1715005943</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>64230c7d41a231107f440d8147faed3d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda9c155f0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a</table>
<target_name>Windows 2012, 2016, 2019 Query-Query Results</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>ba1fa7a17762311064e500fd711a225e</update_guid>
<update_guid_history>ba1fa7a17762311064e500fd711a225e:1715005943</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_0306b403c32321003e76741e81d3ae6a</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>RfirFDEAb8koYxVJdsXchA==</checksum><description>Defines the order of execution of patterns beyond the before/after attributes on the pattern itself</description><directory>false</directory><name>pattern_order.txt</name><parent display_value="ServiceWatch">ed844850c31321003e76741e81d3ae39</parent><script># Patterns order is Ascending.&#13;
&#13;
# HTTP patterns&#13;
Tomcat=A2E52652-EF79-449C-B7A6-2C6FF6398BEB&#13;
Apache on Unix=100&#13;
Apache on Windows=300&#13;
IIS=200&#13;
Websphere Windows=301&#13;
Websphere Unix=3DC4657E-5686-4F97-86EC-37DD564495B1&#13;
</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2014-10-08 12:25:35</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>0306b403c32321003e76741e81d3ae6a</sys_id><sys_mod_count>2</sys_mod_count><sys_name>pattern_order.txt</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_0306b403c32321003e76741e81d3ae6a</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:23</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-390407209</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>6423c87d41a231107f440d8147faeddc</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e244c60000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>pattern_order.txt</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>f9a0cd1106e23110bb2f3dd646b52ed7</update_guid>
<update_guid_history>f9a0cd1106e23110bb2f3dd646b52ed7:-390407209,b5a0cd1141e23110076cd56f7fd60fd6:2050240691</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_587f32695312320023bdae4a16dc348f</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>K40q6lMMcCFvVjuFPcKxpw==</checksum><description/><directory>false</directory><name>linux_lsof_command.sh</name><parent display_value="ADME">ec515c705352320023bdae4a16dc3488</parent><script>#!/bin/sh&#13;
# Copyright © ServiceNow, Inc. 2017. All rights reserved.&#13;
&#13;
BASE_DIR=$1&#13;
cp "${BASE_DIR}/connection_samples/all_connections.log" "${BASE_DIR}/connection_samples/all_connections_tmp.log"&#13;
sudo lsof -iTCP -n -P | grep 'LISTEN' | grep -v "::" | awk -F' ' '{print "on " $2 " " $9}' | sed 's/:/ /g' | sort | uniq &gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
sudo lsof -iTCP -n -P | grep 'ESTABLISHED' | grep -v "::" |  sed 's/-&gt;/ /g' | awk -F' ' '{print "to " $2 " " $10 " " $9}' | sed 's/:/ /g' | sort | uniq &gt;&gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
cat "${BASE_DIR}/connection_samples/connection_sample.log" "${BASE_DIR}/connection_samples/all_connections_tmp.log" | sort &gt; "${BASE_DIR}/connection_samples/all_connections.log"</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>evan.qu</sys_created_by><sys_created_on>2017-04-23 08:11:24</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>587f32695312320023bdae4a16dc348f</sys_id><sys_mod_count>6</sys_mod_count><sys_name>linux_lsof_command.sh</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_587f32695312320023bdae4a16dc348f</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:55</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-978582516</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>68230c7d41a231107f440d8147faed36</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e003dc0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>linux_lsof_command.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>7510015d21a231109b4da771e5d39fe8</update_guid>
<update_guid_history>7510015d21a231109b4da771e5d39fe8:-978582516,f110015dd9a231103b15fa443da7d3e7:1796680491</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_e7f41b889ff322001d753758442e706f</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>5tqA+tzp7YSKMUx/QntHzg==</checksum><description/><directory>false</directory><name>storage.bash</name><parent display_value="SSHScriptFiles">48deb961ff123100ab8fffffffffff07</parent><script>#!/bin/bash

id=/proc/ide
sd=/sys/bus/scsi/devices
ld=/var/log/dmesg
dn=/dev/null
PATH=$PATH:/sbin

shopt -s extglob

#Checks if the command exist and permissions are granted

echo "[[==PROBE:proc_ide==]]"

if [ -d $id ]; then
  for dev in `ls $id | grep ide`; do
  #Cheks if the /proc/ide exist and it is a DIR,
  #Then gets all the dirs that are ide and puts them in the Dev var
   for disk in `ls $id/$dev`; do
   #Then gets all files/folders in ID/Dev and adds them creating a path variable pdev
    pdev="$id/$dev/$disk"

    if [ -f $pdev/driver ]; then
     printf "ide:/dev/$disk,`cat $pdev/model 2&gt;$dn`,`cat $pdev/capacity 2&gt;$dn`,`cat $pdev/media 2&gt;$dn`\n"
     #Checks if the path/pdev + driver is file and prints the above line
    fi
   done
  done
fi


#Starting the sys_block
echo "[[==PROBE:sys_block==]]"
if [ -d /sys/block ]; then
    #Checks it /sys/block is folder
    # List all /sys/blocks that are LVM devices (dm-*), SCSI (sd*), and CD/DVD (sr*)
    for blockDir in $(ls -d /sys/block/* | grep '^/sys/block/\(dm-\|sd\|sr\|nvme*\|xvda*\)'); do
        #get a list of the dirs in sys/block and then ges the name of the command without the PATH
        blockName=$(basename ${blockDir})
        echo "sysBlock:"
        echo "  name: $blockName"
        echo "  deviceMajorMinor: $(cat $blockDir/dev)"
        echo "  sectors: $(cat $blockDir/size)"
        echo "  sectorSize: $(cat $blockDir/queue/hw_sector_size 2&gt;/dev/null || echo 0)"

        # Device
        if [ -d ${blockDir}/device ]; then
            blockHost=$(basename $(readlink ${blockDir}/device) | egrep '([0-9]+:[0-9]+:[0-9]+:[0-9]+|nvme)')
            if [ -z "${blockHost}" ]; then
               blockHost=$(basename $(readlink ${blockDir}/device))
            fi
             if [ -n "${blockHost}" ]; then
                echo "  host: $blockHost"
                echo "  vendor: $(cat $blockDir/device/vendor)"
                echo "  model: $(cat $blockDir/device/model)"

                # The uevent file write-only until kernel 2.6.24
                uevent=$(cat $blockDir/device/uevent 2&gt;/dev/null)
                if [ $? -eq 0 ]; then

                    echo "  devType: $(basename $(ls -ld $blockDir/device/subsystem | awk '{ print $NF }'))"
                else
                    # Grabs the "scsi" or "ide" in paths like "../../../sys/bus/scsi" or "../../../sys/bus/ide"
                    echo "  devType: $(echo $uevent | grep DEVTYPE | awk -F= '{ print $2 }')"
                fi
            fi
        fi

        # Device Mapper (DM)
        if [ -d ${blockDir}/dm ]; then
            echo "  dmName: $(cat $blockDir/dm/name)"
            echo "  dmId: $(cat $blockDir/dm/uuid)"
        fi

        # Partitions
        partitionDirs=$(ls -d $blockDir/$blockName* 2&gt;/dev/null)
        for partitionDir in $partitionDirs; do
            echo "  partitions:"
            echo "    name: $(basename $partitionDir)"
            echo "    deviceMajorMinor: $(cat $partitionDir/dev)"
            echo "    number: $(cat $partitionDir/partition 2&gt;/dev/null || basename $partitionDir | sed -re 's/[^0-9]+//g')"
            echo "    beginOffset: $(cat $partitionDir/start)"
            echo "    sectors: $(cat $partitionDir/size)"
        done
    done
elif [ -d $sd ]; then
  echo "[[==PROBE:scsi_path_map==]]"
  for dev in `ls $sd | egrep '[0-9]+:[0-9]+:[0-9]+:[0-9]+'`; do
   for block in `ls $sd/${dev} | grep ^block`; do
    echo -n ${dev},
    if test ${block} = 'block'
    then
     echo `ls $sd/${dev}/${block}`
    else
     echo `expr ${block} : 'block:\(.*\)'`
    fi
   done
  done
fi

echo "[[==PROBE:proc_mounts==]]"
if [ -e /proc/mounts ]; then
#if file exitst
    cat /proc/mounts | awk '{ print "procMount:" ; print "  name: " $1 ; print "  mountPoint: " $2 ; print "  filesystem: " $3 ; print "  options: " $4 }'
fi

echo "[[==PROBE:dmsetup==]]"
# List each device mapping along with its component parts (which may be other device mappings)

# Get a list of all device mappings. Format: alias (major:minor) E.g., mpathb (235:0)
dmsetupLsOutput=$(sudo dmsetup ls)
# For each mapped device ...
if [ "$dmsetupLsOutput" != "No devices found" ]; then
    # Rows separated by spaces, columns separated by semi-colons, all extra characters removed
    # Example input:
    # root--vg-swap--lv	(253, 1)
    # root--vg-root--lv	(253, 0)
    # Example output: root--vg-swap--lv 253:1;root--vg-root--lv 253:0
    dmsetupLsOutput=$(echo $dmsetupLsOutput | sed -e's/\s//g' | sed -e"s/(/;/g" | sed -e 's/,/:/g' | sed -e"s/)/ /g")

    for dmsetupLsLine in $dmsetupLsOutput; do
        dmAlias=$(echo $dmsetupLsLine | awk 'BEGIN { FS=";" } ; { print $1 }')
        dmMajorMinor=$(echo $dmsetupLsLine | awk 'BEGIN { FS=";" } ; { print $2 }')

        # Each section starts with "mappedDevice:"
        echo "mappedDevice: $dmAlias $dmMajorMinor "

        # Print a list of storage components
        #dmsetupTable=$(sudo dmsetup table)
        echo "extends"
        sudo dmsetup table /dev/mapper/$dmAlias
    done
fi

echo "[[==PROBE:multipath_ll==]]"
# Dump the output of multipath -ll, which shows any device mappings for MPIO.
multipathLL=$(sudo multipath -ll)
multipathOutput="$($multipathLL 2&gt;/dev/null)"

if [ $? -eq 0 ] &amp;&amp; [ -n "$multipathOutput" ]; then
    # Trim bold.
    echo "$multipathOutput" | tr -d '^'
fi

echo "[[==PROBE:sys_iscsi==]]"
# Probe for SAN (Storage Attached Network) device information.

if [ -d /sys/class/iscsi_session ]; then
    ISCSI_SESSION_DIRS=$(find /sys/class/iscsi_session -maxdepth 1 -type l)

    for ISCSI_SESSION_DIR in $ISCSI_SESSION_DIRS; do
        echo "iscsiSession:"
        IQN=$(cat $ISCSI_SESSION_DIR/targetname)
        echo "  targetIqn: ${IQN}"

        TARGET_DIRS=$(ls -d $ISCSI_SESSION_DIR/device/target+([0-9]):+([0-9]):+([0-9])/+([0-9]):+([0-9]):+([0-9]):+([0-9]))

        for TARGET_DIR in $TARGET_DIRS; do
            echo "  device:"
            LUN=$(basename $TARGET_DIR | awk '{ split($0, o, ":"); print o[4]; }')

            DEVICE_DIRS=$(ls -d $TARGET_DIR/block)

            for DEVICE_DIR in $DEVICE_DIRS; do
                DEVICE_NAME=$(cat $TARGET_DIR/block/[a-zA-Z0-9_-]*/uevent | grep DEVNAME | sed -e's/DEVNAME=//g')
                echo "    id: $DEVICE_NAME"
                echo "    lun: $LUN"
            done

        done
    done
fi

echo "[[==PROBE:sys_iscsi_initiator==]]"
# Get our iSCSI initiator
cat /etc/iscsi/initiatorname.iscsi

echo "[[==PROBE:fc==]]"
# Probe for FC Host information

if [ -d /sys/class/fc_host ]; then
    #HBAs
    baseScsiDir=/sys/class/scsi_host
    scsiHostProtocols=$(ls $baseScsiDir/host*/protocol 2&gt; /dev/null)

    # Old style - each driver has its own way.
    for scsiHostProtocol in $scsiHostProtocols; do
        if [ $(cat $scsiHostProtocol) != "fc" ]; then
            continue
        fi

        fcHostDir=$(dirname $scsiHostProtocol)
        fcHostId=$(basename $fcHostDir)
        echo "fcHba:"
        echo "  serialNumber: $(cat $fcHostDir/serialnum)"
        echo "  model: $(cat $fcHostDir/modelname)"
        echo "  modelDescription: $(cat $fcHostDir/modeldesc)"
    done

    # New style - FC info in /sys/class/fc_host/host*, generic info at /sys/class/scsi_host/host*
    fcHostDirs=$(ls -d /sys/class/fc_host/host*)
    for fcHostDir in $fcHostDirs; do
        fcHostId=$(basename $fcHostDir)
        fcHostDir=$baseScsiDir/$fcHostId
        if [ -e $fcHostDir/serial_num ]; then
            echo "fcHba:"
            echo "  serialNumber: $(cat $fcHostDir/serial_num)"
            echo "  model: $(cat $fcHostDir/model_name)"
            echo "  modelDescription: $(cat $fcHostDir/model_desc)"
        fi
    done

    # Ports
    fcHostDirs=$(ls -d /sys/class/fc_host/host*)

    for fcHostDir in $fcHostDirs; do
        fcHostId=$(basename $fcHostDir)
        echo "fcPort:"
        echo "  wwpn: $(cat $fcHostDir/port_name 2&gt; /dev/null)"
        echo "  wwnn: $(cat $fcHostDir/node_name 2&gt; /dev/null)"
        echo "  speed: $(cat $fcHostDir/speed 2&gt; /dev/null)"
        echo "  port_type: $(cat $fcHostDir/port_type)"
        if [ -e  $fcHostDir/device/scsi_host/host*/serialnum ]; then
            echo "  hbaSerialNumber: $(cat $fcHostDir/device/scsi_host/host*/serialnum 2&gt; /dev/null)"
        else
            echo "  hbaSerialNumber: $(cat $baseScsiDir/$fcHostId/serial_num 2&gt; /dev/null)"
        fi

        # Print block device names assigned to this port
        remotePortDirs=$(ls -d $fcHostDir/device/rport-* 2&gt; /dev/null)
        for remotePortDir in $remotePortDirs; do
            # Display information about each target port
            fcRemotePortDir="$remotePortDir/fc_remote_ports/$(basename $remotePortDir)"
            echo "  targetPort:"
            echo "    wwpn: $(cat $fcRemotePortDir/port_name 2&gt; /dev/null)"
            echo "    wwnn: $(cat $fcRemotePortDir/node_name 2&gt; /dev/null)"
            # Display each block device for this remote port
            portBlockDirs=$(ls -d $remotePortDir/target*/[0-9]*/block/* 2&gt;/dev/null)
            if [ -n "$portBlockDirs" ]; then
                blockNames=()
                for portBlockDir in $portBlockDirs; do
                    blockNames+="$(basename $portBlockDir)"
                done

                # Convert the array to a CSV
                blockNames=$(IFS=, ; echo "$(basename ${portBlockDirs[*]})")
                echo "    blockDeviceNames: $blockNames"
            fi
        done
    done
fi

exit 0</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2016-12-15 11:18:28</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>e7f41b889ff322001d753758442e706f</sys_id><sys_mod_count>23</sys_mod_count><sys_name>storage.bash</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_e7f41b889ff322001d753758442e706f</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:24</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-220673480</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>68230c7d41a231107f440d8147faed39</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e2486b0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>storage.bash</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>4ea0015155e231107cbce0b260d3ccf1</update_guid>
<update_guid_history>4ea0015155e231107cbce0b260d3ccf1:-220673480,caa00151b1e23110878ad2a15335c6f0:478733570</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_choice_task_state</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_choice action="INSERT_OR_UPDATE" field="state" table="task" version="3"><sys_choice_set action="INSERT_OR_UPDATE"><element>state</element><name>task</name><sys_class_name>sys_choice_set</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-10-03 16:39:13</sys_created_on><sys_id>2c32eb1b9f2131107f44e6ca4224ab69</sys_id><sys_mod_count>0</sys_mod_count><sys_name>state</sys_name><sys_package display_value="Task table schema" source="com.glide.task">c032eb1b9f2131107f44e6ca4224ab1f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_choice_task_state</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-10-03 16:39:13</sys_updated_on></sys_choice_set><sys_choice action="INSERT_OR_UPDATE"><dependent_value/><element>state</element><hint/><inactive>false</inactive><label>Pending</label><language>en</language><name>task</name><sequence>-5</sequence><synonyms/><sys_created_by>system</sys_created_by><sys_created_on>2023-10-03 16:39:13</sys_created_on><sys_domain>global</sys_domain><sys_domain_path/><sys_id>e032eb1b9f2131107f44e6ca4224ab69</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-10-03 16:39:13</sys_updated_on><value>-5</value></sys_choice><sys_choice action="INSERT_OR_UPDATE"><dependent_value/><element>state</element><hint/><inactive>false</inactive><label>Open</label><language>en</language><name>task</name><sequence>1</sequence><synonyms/><sys_created_by>system</sys_created_by><sys_created_on>2023-10-03 16:39:13</sys_created_on><sys_domain>global</sys_domain><sys_domain_path/><sys_id>2432eb1b9f2131107f44e6ca4224ab69</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-10-03 16:39:13</sys_updated_on><value>1</value></sys_choice><sys_choice action="INSERT_OR_UPDATE"><dependent_value/><element>state</element><hint/><inactive>false</inactive><label>Work in Progress</label><language>en</language><name>task</name><sequence>2</sequence><synonyms/><sys_created_by>system</sys_created_by><sys_created_on>2023-10-03 16:39:13</sys_created_on><sys_domain>global</sys_domain><sys_domain_path/><sys_id>6432eb1b9f2131107f44e6ca4224ab69</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-10-03 16:39:13</sys_updated_on><value>2</value></sys_choice><sys_choice action="INSERT_OR_UPDATE"><dependent_value/><element>state</element><hint/><inactive>false</inactive><label>Closed Complete</label><language>en</language><name>task</name><sequence>3</sequence><synonyms/><sys_created_by>system</sys_created_by><sys_created_on>2023-10-03 16:39:13</sys_created_on><sys_domain>global</sys_domain><sys_domain_path/><sys_id>a432eb1b9f2131107f44e6ca4224ab69</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-10-03 16:39:13</sys_updated_on><value>3</value></sys_choice><sys_choice action="INSERT_OR_UPDATE"><dependent_value/><element>state</element><hint/><inactive>false</inactive><label>Closed Incomplete</label><language>en</language><name>task</name><sequence>4</sequence><synonyms/><sys_created_by>system</sys_created_by><sys_created_on>2023-10-03 16:39:13</sys_created_on><sys_domain>global</sys_domain><sys_domain_path/><sys_id>e432eb1b9f2131107f44e6ca4224ab69</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-10-03 16:39:13</sys_updated_on><value>4</value></sys_choice><sys_choice action="INSERT_OR_UPDATE"><dependent_value/><element>state</element><hint/><inactive>false</inactive><label>Closed Skipped</label><language>en</language><name>task</name><sequence>5</sequence><synonyms/><sys_created_by>system</sys_created_by><sys_created_on>2023-10-03 16:39:13</sys_created_on><sys_domain>global</sys_domain><sys_domain_path/><sys_id>2832eb1b9f2131107f44e6ca4224ab69</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-10-03 16:39:13</sys_updated_on><value>7</value></sys_choice></sys_choice></record_update>]]></payload>
<payload_hash>1369408313</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>68230c7d41a231107f440d8147faed3c</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3f764ba0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>task</table>
<target_name>Task.State</target_name>
<type>Choice list</type>
<update_domain>global</update_domain>
<update_guid>fbe505d13e66311093b1618f472c4115</update_guid>
<update_guid_history>fbe505d13e66311093b1618f472c4115:1369408313</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_2de97c95092231107f445d7a5f5e13a2</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>cl.datacenter_instance</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:18:52</sys_created_on><sys_id>2de97c95092231107f445d7a5f5e13a2</sys_id><sys_mod_count>1</sys_mod_count><sys_name>cl.datacenter_instance</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_2de97c95092231107f445d7a5f5e13a2</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:24:05</sys_updated_on><type>string</type><value>false</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=2de97c95092231107f445d7a5f5e13a2"/></record_update>]]></payload>
<payload_hash>204425170</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>68230c7d41a231107f440d8147faed3f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd402f5620000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cl.datacenter_instance</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>38d8c55145a631104bae90047f06fc4e</update_guid>
<update_guid_history>38d8c55145a631104bae90047f06fc4e:204425170,ede97c952b223110482e4203cc7f75ab:-83253707</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>cmdb_health_orphan_rule_e3f763e5412231107f440d8147faed8c</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="cmdb_health_orphan_rule"><cmdb_health_orphan_rule action="INSERT_OR_UPDATE"><class>cmdb_ci_email_server</class><condition/><filter>{"attributes":"","operator":"OR","groups":[{"operator":"AND","rules":[{"relation":"60bc4e22c0a8010e01f074cbe6bd73c3","class":"cmdb_ci_server","$$hashKey":"object:15"}],"$$hashKey":"object:12"}]}</filter><no_relationship>false</no_relationship><sys_class_name>cmdb_health_orphan_rule</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 23:37:58</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>e3f763e5412231107f440d8147faed8c</sys_id><sys_mod_count>0</sys_mod_count><sys_name>cmdb_ci_email_server</sys_name><sys_overrides/><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>cmdb_health_orphan_rule_e3f763e5412231107f440d8147faed8c</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 23:37:58</sys_updated_on></cmdb_health_orphan_rule></record_update>]]></payload>
<payload_hash>625339773</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>6823c87d41a231107f440d8147faeddb</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda7fa01e0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cmdb_ci_email_server</target_name>
<type>CMDB Health Orphan Rule</type>
<update_domain>global</update_domain>
<update_guid>ebf763e5eb2231102f10f7a28ec8ee8d</update_guid>
<update_guid_history>ebf763e5eb2231102f10f7a28ec8ee8d:625339773</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_51fff6695312320023bdae4a16dc34c7</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>bvrgTp7tfuE5JfwM6oxmhQ==</checksum><description/><directory>false</directory><name>solaris_ps_command.sh</name><parent display_value="ADME">ec515c705352320023bdae4a16dc3488</parent><script>#!/bin/sh&#13;
# Copyright © ServiceNow, Inc. 2017. All rights reserved.&#13;
# &#13;
# NOTE: this takes two arguments: base dir in $1, zone name in $2&#13;
#&#13;
# Only get our processes, not our child zone processes&#13;
# Core of this script is very similar to 'Solaris - Active Processes' probe parameter ps.sh.&#13;
#&#13;
ZONENAME=$2&#13;
IFS="&#13;
"&#13;
ZONECMD=/usr/bin/zonename&#13;
PSCMD="/usr/bin/ps"&#13;
PSARGS="-o pid,ppid"&#13;
AWKCMD="awk"&#13;
&#13;
# Solaris 10 and older have ucb/ps installed; Solaris 11 does not by default.&#13;
# But Solaris 11 /usr/bin/ps generates /usr/ucb/ps compatible output for when -&#13;
# is not at the front of the first command argument.&#13;
#&#13;
SOLVERSION=`uname -r`&#13;
&#13;
BASE_DIR=$1&#13;
CALLPOINT_DIR=`dirname $0`&#13;
ADME_PID=`cat $CALLPOINT_DIR/../adme_collector.pid` &#13;
&#13;
# First output just the heading for ps's output, tacking on a COMMAND column&#13;
#echo PID PPID COMMAND&#13;
&#13;
# Check for existence of zonename command&#13;
if [ ! -z "$ZONENAME" ]; then&#13;
        ZONEPARAM="-z ${ZONENAME}"&#13;
elif [ -f $ZONECMD ]; then&#13;
    # exists: limit ps to display processes for this zone&#13;
        ZONEPARAM="-z `$ZONECMD`"&#13;
else&#13;
    # doesn't exist: ps to display all processes &#13;
        ZONEPARAM="-e"&#13;
fi&#13;
&#13;
# Replace awk command with nawk if it is available &#13;
# awk has a byte limit of 2559 bytes on older solaris machines&#13;
if hash nawk 2&gt;/dev/null; then&#13;
  AWKCMD="nawk"&#13;
fi&#13;
&#13;
cp /dev/null "${BASE_DIR}/process_samples/process_sample.log"&#13;
cp "${BASE_DIR}/process_samples/all_processes.log" "${BASE_DIR}/process_samples/all_processes_tmp.log"&#13;
# Iterate through each line of ps output...&#13;
for LINE in `$PSCMD $ZONEPARAM $PSARGS | grep -v "PID PPID" | sort | uniq`; do&#13;
    PID=`echo $LINE | $AWKCMD '{print $1}'`&#13;
    # Check that this line isn't the header, and it's valid in /proc&#13;
    if [ "$PID" != "PID" -a -f "/proc/$PID/status" ]; then&#13;
        # run ucb/ps as root get full, non-truncated command+args even for processes we don't own.&#13;
        # Check if Solaris 11, which may not have /usr/ucb/ps installed.&#13;
        # SNC runtime script preprocessor requires ${sudo:...} contain literal string, not a $myvar.&#13;
        case $SOLVERSION in&#13;
            "5.11") CMD=`${sudo:/usr/bin/ps} awwx $PID | tail +2 | $AWKCMD '{$1="";$2="";$3="";$4="";print $0}'`;;&#13;
            *) CMD=`${sudo:/usr/ucb/ps} -awwx $PID | tail +2 | $AWKCMD '{$1="";$2="";$3="";$4="";print $0}'`;;&#13;
        esac&#13;
        # tack on the command+args to the output        &#13;
        echo $LINE $CMD  &gt;&gt; "${BASE_DIR}/process_samples/process_sample.log"&#13;
    fi&#13;
done&#13;
cat "${BASE_DIR}/process_samples/process_sample.log" "${BASE_DIR}/process_samples/all_processes_tmp.log" | grep -v "$BASE_DIR" | sort &gt; "${BASE_DIR}/process_samples/all_processes.log"&#13;
&#13;
</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>evan.qu</sys_created_by><sys_created_on>2017-04-23 08:13:39</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>51fff6695312320023bdae4a16dc34c7</sys_id><sys_mod_count>10</sys_mod_count><sys_name>solaris_ps_command.sh</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_51fff6695312320023bdae4a16dc34c7</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:55</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-1708521257</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>6c230c7d41a231107f440d8147faed35</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e003180000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>solaris_ps_command.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>3110015d13a23110c75ae1881674aad2</update_guid>
<update_guid_history>3110015d13a23110c75ae1881674aad2:-1708521257,bd10015d34a231105b75fe8d7bb6c0d0:179783656</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_d5d939bd53d373008ec4ddeeff7b121d</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>XaBVVtsjITmv04QHL04PuQ==</checksum><description>All Files operations for WMI Collector</description><directory>false</directory><name>WMIFileOperations.psm1</name><parent display_value="WMICollector">5b2635bd53d373008ec4ddeeff7b1261</parent><script>&lt;# &#13;
    This function is duplicated in the both WMI and WinRM FileOperations modules rather than&#13;
    placed in the CommonUtils module in order to prevent someone from calling the function&#13;
    without the necessary WMI or WinRM module loaded&#13;
	&#13;
#&gt;&#13;
function getFileContent {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Gets the file content of the given path.&#13;
&#13;
    .PARAMETER path&#13;
        Specifies the path of the text file.&#13;
    .PARAMETER encoding&#13;
        Specifies the encoding of the text file.&#13;
&#13;
    .OUTPUTS&#13;
        System.String&#13;
            The file content as a string.&#13;
#&gt;&#13;
    param(&#13;
        [string]$path = $(throw 'The path parameter is required'),&#13;
        [string]$encoding = 'Default'&#13;
    )&#13;
&#13;
    # isUncPath and getFileContentUncPath are in CommonUtils.psm1&#13;
    if (isUncPath -path $path) {&#13;
        SNCLog-DebugInfo "Getting file content through UNC path $path";&#13;
        $output = getFileContentUncPath -uncPath $path -encoding $encoding&#13;
    } else {&#13;
        SNCLog-DebugInfo "Getting file content through local path $path";&#13;
        $output = getFileContentLocalPath -localPath $path -encoding $encoding&#13;
    }&#13;
    &#13;
    $output;&#13;
}&#13;
&#13;
function getFileContentLocalPath {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Gets the file content of the given local path.&#13;
&#13;
    .PARAMETER localPath&#13;
        Specifies the local path of the text file.&#13;
    .PARAMETER encoding&#13;
        Specifies the encoding of the text file.&#13;
&#13;
    .OUTPUTS&#13;
        System.String&#13;
            The file content as a string.&#13;
#&gt;&#13;
    param(&#13;
        [string]$localPath = $(throw 'The localPath parameter is required'),&#13;
        [string]$encoding = 'Default'&#13;
    )&#13;
&#13;
    if (isUncPath -path $localPath) {&#13;
        throw "$localPath is an UNC path"&#13;
    }&#13;
&#13;
    if ($computer) {&#13;
        $uncPath = mapAdminShareUncPath -remoteHost $computer -localPath $localPath;&#13;
        SNCLog-DebugInfo "getting file content from remote host using admin share: getFileContentUncPath -uncPath $uncPath -encoding $encoding"&#13;
        getFileContentUncPath -uncPath $uncPath -encoding $encoding&#13;
    } else {&#13;
        SNCLog-DebugInfo "`$computer is not set, getting file content from local MID server host: Get-Content -Path $localPath -Encoding $encoding"&#13;
        Get-Content -Path $localPath -Encoding $encoding&#13;
    }&#13;
}&#13;
&#13;
function mapAdminShareUncPath {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Maps the given local absolute path to a UNC path using admin share of the remote host.&#13;
&#13;
    .PARAMETER remoteHost&#13;
        Specifies the remote host to map the local path to.&#13;
    .PARAMETER localPath&#13;
        Specifies the local path to map.&#13;
&#13;
    .OUTPUTS&#13;
        System.String&#13;
            The mapped UNC path based on the admin share of the remote host.&#13;
#&gt;&#13;
    param(&#13;
        [string]$remoteHost = $(throw 'The remoteHost parameter is required'),&#13;
        [string]$localPath = $(throw 'The localPath parameter is required'))&#13;
    &#13;
    &#13;
    # replace drive ':' character with admin share character&#13;
    $localPath = $localPath.Replace(':', '$');&#13;
&#13;
    return Join-Path -Path "\\$remoteHost" -ChildPath $localPath&#13;
}&#13;
&#13;
function uncPathToLocalPath {&#13;
    param([string] $uncPath)&#13;
    $uncPath = $uncPath -replace '\\\\.*?\\', '';&#13;
    #Replace only first $ symbol for user share
    $index = $uncPath.indexOf("$");&#13;
    $uncPath = $uncPath.remove($index,1).insert($index, ":");&#13;
    return $uncPath;&#13;
}&#13;
&#13;
&lt;#&#13;
    $destFileName - just a file name no path&#13;
#&gt;&#13;
function putFileToTarget{&#13;
    param([string]$sourcePath, [string]$destFileName, [bool]$changeFilePermission)&#13;
    if (-not $tmpDir) {&#13;
        throw 'Could not put file because $tmpDir is null';&#13;
    }&#13;
    &#13;
    # Standardize slashes&#13;
    $sourcePath = standardizePath -path $sourcePath;&#13;
    $destFileName = standardizePath -path $destFileName;&#13;
&#13;
    # If the source file does not exist - exit&#13;
    if (-not $sourcePath -or -not (test-path -path $sourcePath -PathType Leaf)){&#13;
        throw "Source file $sourcePath does not exist on the MID host";&#13;
    }&#13;
&#13;
    # get the filename from the path&#13;
    $fileName = Split-Path -Path $sourcePath -Leaf&#13;
&#13;
&#13;
    # Build the destination path&#13;
    if (-not $destFileName){&#13;
        $dstFullPath = [System.IO.Path]::Combine($tmpDir,$filename);&#13;
    } else {&#13;
        $dstFullPath = [System.IO.Path]::Combine($tmpDir,$destFileName);&#13;
    } &#13;
   &#13;
    # Build a UNC path to the destination on the remote computer&#13;
    $dstFullUncPath = mapAdminShareUncPath -remoteHost $computer -localPath $dstFullPath;&#13;
    try{&#13;
        putFileUncPath -sourcePath $sourcePath -destinationUncPath $dstFullUncPath -changeFilePermission $changeFilePermission;&#13;
    } catch {&#13;
        throw ("Could not put file as $dstFullUncPath. " + $_.Exception.Message);&#13;
    }&#13;
    &#13;
    return $dstFullPath;&#13;
}&#13;
&#13;
&lt;#&#13;
    This method uses the same logic as the old Neebula WMICollector to fetch temporary directory.&#13;
    First we try to get the TempDirectory out of the Win32_BootConfiguration using WMI Query.&#13;
    If TempDirectory is int system32 - we cannot use it as there is a known issue running commands from this dir with Windows2008.&#13;
    If we failed to fetch TempDirectory using WMI query or that it has system32 in the path we try agian.&#13;
    We try next with registry call to the HKEY_CURRENT_USER, Environment and getting the TEMP variable. Same logic about system32.&#13;
    If all fails we default to c:\temp&#13;
#&gt;&#13;
function getTempDirectory{&#13;
    param([string]$subdirectory, [string]$serviceName, [boolean]$useSecureTemp)&#13;
    # If already set - return&#13;
    if ($tmpDir){&#13;
        return $tmpDir;&#13;
    }&#13;
    &#13;
   $psBaseDir = [Environment]::GetEnvironmentVariable("SNC_base_dir")&#13;
   if ($psBaseDir) {&#13;
       $tmpDir = $psBaseDir&#13;
    } else {&#13;
        # This Method is in WMIFileOperations&#13;
        # Try and get use local path and attach temp to it&#13;
        $tmpdir = getUserTmpDir&#13;
        SNCLog-DebugInfo "We got user temp dir: $tmpDir";&#13;
&#13;
        if (-not $tmpDir -or $tmpDir.indexOf("system32") -gt -1){&#13;
          SNCLog-DebugInfo "We cannot use system32 based dir found in User TEMP, will not use $tmpDir; Trying to get another temp directory from TempDirectory\Win32_BootConfiguration";&#13;
           # This Method is in WMIQueryOperations&#13;
           try{&#13;
              $qResults = executeQuery -query "Select TempDirectory from Win32_BootConfiguration";&#13;
            } catch {&#13;
               SNCLog-DebugInfo ("Could not executeQuery: Select TempDirectory from Win32_BootConfiguration. Error " + $_.Exception.Message);&#13;
          }&#13;
          $tmpdir = $null;&#13;
           if ($qResults){&#13;
              # lookupValueByKeyFromString Method is in CommonUtils&#13;
              $tmpDir = lookupValueByKeyFromString -str $qResults -lookupValue "TempDirectory" -delimiter ":";&#13;
          }&#13;
          if (-not $tmpDir -or $tmpDir.indexOf("system32") -gt -1){&#13;
              SNCLog-DebugInfo "We cannot use system32 based dir found in Win32_BootConfiguration\TempDirectory, will not use $tmpDir; default to: c:\temp";&#13;
              $tmpDir = "c:\temp"; # Just like as WMIColelctor&#13;
          }&#13;
     }&#13;
}&#13;
&#13;
    $tmpDir = Join-Path -Path $tmpDir -ChildPath $subdirectory;&#13;
    &#13;
    $uncPath = mapAdminShareUncPath -remoteHost $computer -localPath $tmpDir;&#13;
    $discoveryUser = $cred.UserName;&#13;
&#13;
&#13;
    if ($useSecureTemp) {&#13;
        # createAndSecureFolderForUser is in EnforceFolderPermissions.psm1&#13;
        $uncTmpDir = createAndSecureFolderForUser -folder $uncPath -discoveryUser $discoveryUser -serviceName $serviceName -secureFolder $true;&#13;
        if ($uncTmpDir) {&#13;
            SNCLog-DebugInfo "UNC tmp dir is $uncTmpDir"&#13;
            SNCLog-DebugInfo "Converting UNC tmp dir to local path tmp dir";&#13;
        &#13;
            $tmpDir = uncPathToLocalPath -uncPath $uncTmpDir;&#13;
            SNCLog-DebugInfo "Tmp dir is $tmpDir";&#13;
            return $tmpDir;&#13;
        }&#13;
        SNCLog-DebugInfo "Failed to create secure temp folder using base path $uncPath";&#13;
    }&#13;
    &#13;
    SNCLog-DebugInfo "Attempting to create unsecure temp folder $uncPath";&#13;
    # attempt to create unsecure temp folder&#13;
    if (createFolder -folder $uncPath -secureFolder $false) {&#13;
        SNCLog-DebugInfo "Successfully created unsecure temp folder $uncPath";&#13;
        SNCLog-DebugInfo "Converting UNC tmp dir to local path tmp dir";&#13;
        &#13;
        $tmpDir = uncPathToLocalPath -uncPath $uncPath;&#13;
        SNCLog-DebugInfo "Tmp dir is $tmpDir";&#13;
        return $tmpDir;&#13;
    }&#13;
&#13;
    SNCLog-DebugInfo "Failed to create unsecured temp folder $uncPath";&#13;
}&#13;
&#13;
function getUserTmpDir{&#13;
&#13;
    SNCLog-DebugInfo "Trying to get user temp directory from registry: HEKY_CURRENT_USER";&#13;
    clearRegistryFetchArrays;&#13;
    try{&#13;
        $userTmpDir = getRegistryValues -hive "HKEY_CURRENT_USER" -key "ENVIRONMENT" -commaSeparatedNames "TMP";&#13;
    } catch {&#13;
        SNCLog-DebugInfo ("Could not get user temp dir using registry. Error: " + $_.Exception.Message);&#13;
        return;&#13;
    }&#13;
    return lookupValueByKeyFromString -lookupValue "TMP" -str $userTmpDir -delimiter ":";&#13;
}&#13;
&#13;
&lt;#&#13;
    This method create a directory. It can be used on a remove target using a UNC or a shared drive path&#13;
#&gt;&#13;
function createDirectory{&#13;
    param([string]$fullPath)&#13;
    &#13;
    # For WMI&#13;
    # Reason for failure could be because we could not fetch file from admin$\temp - that is ok&#13;
    if ($computer){&#13;
        SNCLog-DebugInfo "Creating remote directory where the output will be on C drive";&#13;
        launchProcess -computer $computer -cred $cred -command "mkdir $fullPath" -UTF8 -remoteBaseDir "c$";&#13;
    } else {&#13;
        # Run local command as this is on the MID server&#13;
        try{&#13;
            SNCLog-DebugInfo "Creating $fullPath locally using: New-Item -ItemType 'directory' -Path '$fullPath' -ErrorAction Stop;";&#13;
            New-Item -ItemType "directory" -Path $fullPath -force -ErrorAction Stop &gt; $null;&#13;
        }&#13;
        catch {&#13;
            throw "Could not create $fullPath. Quit";&#13;
        }&#13;
    }&#13;
}&#13;
&#13;
&lt;# &#13;
    This function is duplicated in the both WMI and WinRM FileOperations modules rather than&#13;
    placed in the CommonUtils module in order to prevent someone from calling the function&#13;
    without the necessary WMI or WinRM module loaded&#13;
#&gt;&#13;
function deleteFile {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Deletes the file at the given path.&#13;
&#13;
    .PARAMETER path&#13;
        Specifies the path of the file to delete.&#13;
&#13;
    .OUTPUTS&#13;
        None.&#13;
#&gt;&#13;
    param([string]$path = $(throw 'The path parameter is required'))&#13;
&#13;
    # isUncPath and deleteFileUncPath are in CommonUtils.psm1&#13;
    if (isUncPath -path $path) {&#13;
        SNCLog-DebugInfo "Deleting file through UNC path $path";&#13;
        deleteFileUncPath -uncPath $path -credential $snccred;&#13;
    } else {&#13;
        SNCLog-DebugInfo "Deleting file through local path $path";&#13;
        deleteFileLocalPath -localPath $path;&#13;
    }&#13;
}&#13;
&#13;
function deleteFileLocalPath{&#13;
    param([string]$localPath = $(throw 'The path parameter is required'))&#13;
    &#13;
    if (isUncPath -path $localPath) {&#13;
        throw "$localPath is an UNC path"&#13;
    }&#13;
&#13;
    try{&#13;
        if ($computer) {&#13;
            $uncPath = mapAdminShareUncPath -remoteHost $computer -localPath $localPath;&#13;
            SNCLog-DebugInfo "getting file content from remote host using admin share: getFileContentUncPath -uncPath $uncPath -encoding $encoding"&#13;
            # This method is in CommonUtils&#13;
            deleteFileUncPath -uncPath $uncPath&#13;
        } else {&#13;
            SNCLog-DebugInfo "`$computer is not set, getting file content from local MID server host: Get-Content -Path $localPath -Encoding $encoding"&#13;
            Get-Content -Path $localPath -Encoding $encoding&#13;
        }&#13;
    } catch{&#13;
        throw ("Could not remove $localPath. Exception: " + $_.Exception.Message);&#13;
    }&#13;
}&#13;
&#13;
function getUserNameWithDomain {&#13;
    if ($cred) {&#13;
        $user = $cred.UserName;&#13;
        if ($user -and ($user.indexOf("\") -lt 0 -or $user.startsWith(".\"))) {&#13;
            SNCLog-DebugInfo "User does not have domain, will attach the computer name";&#13;
            try{&#13;
                $qRes = executeQuery -query "Select Name from Win32_ComputerSystem";&#13;
            } catch {&#13;
                SNCLog-DebugInfo ("Could not executeQuery: Select Name from Win32_ComputerSystem. Error " + $_.Exception.Message);&#13;
            }&#13;
            $compName = lookupValueByKeyFromString -lookupValue "Name" -str $qRes -delimiter ":"&#13;
            &#13;
            if (($user.indexOf("\") -lt 0)) {&#13;
                return $compName + "\" + $user;&#13;
            }&#13;
            # we are here because we got .\user&#13;
            return ($user.replace(".", $compName));&#13;
        }&#13;
        &#13;
        return $user;&#13;
    }&#13;
    &#13;
    return (whoami).trim();&#13;
}&#13;
&#13;
function getFileOwner {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Gets the owner of the specified file&#13;
&#13;
    .PARAMETER path&#13;
        The path to the file&#13;
&#13;
    .OUTPUTS&#13;
        The owner of the file&#13;
#&gt;&#13;
    param([string]$path = $(throw "path parameter is required"))&#13;
&#13;
    if (isUncPath -path $path) {&#13;
        $acl = getFileAclUncPath -uncPath $path;&#13;
    } else {&#13;
        $acl = getFileAclLocalPath -localPath $path;&#13;
    }&#13;
&#13;
    return $acl.Owner;&#13;
}&#13;
&#13;
function getFileAclLocalPath {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Gets the acl of the specified file&#13;
&#13;
    .PARAMETER localPath&#13;
        The local path to the file&#13;
&#13;
    .OUTPUTS&#13;
        The acl of the file&#13;
#&gt;&#13;
    param([string]$localPath = $(throw "localPath parameter is required"))&#13;
&#13;
    try {&#13;
        if ($computer) {&#13;
            # if we have a computer name, create UNC with it and get the acl&#13;
            $uncPath = "\\{0}\{1}" -f $computer, $localPath.Replace(':', '$');&#13;
            SNCLog-DebugInfo "getting file ACL from remote host using admin share: getFileAclUncPath -uncPath $uncPath"&#13;
            $acl = getFileAclUncPath -uncPath $uncPath;&#13;
        } else {&#13;
            # no computer, this is a local call, just use the local path&#13;
            SNCLog-DebugInfo "getting file ACL from local MID: Get-Acl -uncPath $localPath"&#13;
            $acl = Get-Acl $localPath;&#13;
        }&#13;
    } catch {&#13;
        Write-Error ("Could not get file ACL from $localPath. Original exception: " + $_.Exception.Message);&#13;
    }&#13;
&#13;
    return $acl;&#13;
}</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>nisan.barzion</sys_created_by><sys_created_on>2019-08-16 23:33:25</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>d5d939bd53d373008ec4ddeeff7b121d</sys_id><sys_mod_count>35</sys_mod_count><sys_name>WMIFileOperations.psm1</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_d5d939bd53d373008ec4ddeeff7b121d</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:56</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-251399186</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>6c230c7d41a231107f440d8147faed38</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e009f50000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>WMIFileOperations.psm1</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>8210415dbea231109e951c56c59d6b34</update_guid>
<update_guid_history>8210415dbea231109e951c56c59d6b34:-251399186,0210415d2ba2311054bc05ef4f055d33:1097733392</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_authentication_policy_criteria_m2m_09a7b381c7722010df1417b703c26057</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_authentication_policy_criteria_m2m"><sys_authentication_policy_criteria_m2m action="INSERT_OR_UPDATE"><policy display_value="Step-Down MFA Policy">285a15d373512010616ca9843cf6a749</policy><sys_auth_filter_criteria display_value="Role Based MFA">c326b116c7312010df1417b703c2601d</sys_auth_filter_criteria><sys_created_by>admin</sys_created_by><sys_created_on>2021-03-08 16:49:19</sys_created_on><sys_id>09a7b381c7722010df1417b703c26057</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2021-06-08 08:37:02</sys_updated_on><used>true</used></sys_authentication_policy_criteria_m2m></record_update>]]></payload>
<payload_hash>-196133244</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>6c230c7d41a231107f440d8147faed3b</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3ff55440000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>c326b116c7312010df1417b703c2601d</target_name>
<type>List of filter criteria</type>
<update_domain>global</update_domain>
<update_guid>fee7415dfc6631100c25c88198c034ed</update_guid>
<update_guid_history>fee7415dfc6631100c25c88198c034ed:-196133244</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_1ae9bc95092231107f445d7a5f5e1374</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>cl.appstore.storeInstance</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:18:55</sys_created_on><sys_id>1ae9bc95092231107f445d7a5f5e1374</sys_id><sys_mod_count>1</sys_mod_count><sys_name>cl.appstore.storeInstance</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_1ae9bc95092231107f445d7a5f5e1374</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:24:04</sys_updated_on><type>string</type><value>apprepo.service-now.com</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=1ae9bc95092231107f445d7a5f5e1374"/></record_update>]]></payload>
<payload_hash>-1121290405</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>6c230c7d41a231107f440d8147faed3e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd402f1e80000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cl.appstore.storeInstance</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>a8d8c5511aa63110624ca36475fdcf1f</update_guid>
<update_guid_history>a8d8c5511aa63110624ca36475fdcf1f:-1121290405,aee9bc95152231100509cdff26f96094:418946238</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_2d271ec1537a320023bdae4a16dc3475</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>zN9t92CVw0Pq+UmUYTxdBA==</checksum><description/><directory>false</directory><name>aix_netstat_command.sh</name><parent display_value="ADME">ec515c705352320023bdae4a16dc3488</parent><script>#!/bin/sh&#13;
# Copyright © ServiceNow, Inc. 2017. All rights reserved.&#13;
BASE_DIR=$1&#13;
cp "${BASE_DIR}/connection_samples/all_connections.log" "${BASE_DIR}/connection_samples/all_connections_tmp.log"&#13;
#netstat output | match tcp | collepse all space into one space | remove CLOSED conneciton | sort | uniq&#13;
sudo netstat -Aan | grep tcp | tr -s ' ' | grep -v CLOSED | sort | uniq &gt; "${BASE_DIR}/connection_samples/connections_list.log"&#13;
#get pid of each connection &#13;
while read line; do &#13;
	rmsock `echo $line | cut -d ' ' -f1` tcpcb | cut -d ' ' -f9; &#13;
done &lt; "${BASE_DIR}/connection_samples/connections_list.log" &gt;"${BASE_DIR}/connection_samples/connections_pid.log"&#13;
#combine connection result with PID added | remove keyword with before which is error&#13;
#TODO: filter any other error type?&#13;
paste "${BASE_DIR}/connection_samples/connections_list.log" "${BASE_DIR}/connection_samples/connections_pid.log" | grep -v "before" &gt; "${BASE_DIR}/connection_samples/connections_with_pid.log"&#13;
#cat connections | match LISTEN | print result | separate ip.port &#13;
cat  "${BASE_DIR}/connection_samples/connections_with_pid.log" | grep LISTEN | awk -F' ' '{print "on " $8 " " $5 }' | sed 's/\(.*\)\./\1 /' &gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
cat  "${BASE_DIR}/connection_samples/connections_with_pid.log" | grep ESTABLISHED | awk -F' ' '{print "to " $8 " " $6 " " $5 }' | sed 's/\(.*\)\./\1 /' | awk -F' ' '{print $1" " $2" " $4" " $5" " $3 }' | sed 's/\(.*\)\./\1 /' &gt;&gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
cat "${BASE_DIR}/connection_samples/connection_sample.log" "${BASE_DIR}/connection_samples/all_connections_tmp.log" | sort &gt; "${BASE_DIR}/connection_samples/all_connections.log"</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>evan.qu</sys_created_by><sys_created_on>2017-05-16 12:29:55</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>2d271ec1537a320023bdae4a16dc3475</sys_id><sys_mod_count>3</sys_mod_count><sys_name>aix_netstat_command.sh</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_2d271ec1537a320023bdae4a16dc3475</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:54</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-954475885</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>6c23c87d41a231107f440d8147faeddd</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e0013e0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>aix_netstat_command.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>6910015dc0a23110a158dc994bc539b8</update_guid>
<update_guid_history>6910015dc0a23110a158dc994bc539b8:-954475885,e510015d48a2311099b40f795c46afb7:-276775775</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_8b18820053a002007c949096a11c084b</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description>&lt;span style = 'font-family: Arial; font-size: 13px; color: #4a4a4a;'&gt;Allow class switching during identification and reconciliation.&lt;ul style='margin: 0px; padding-left:15px;'&gt;&lt;li&gt;Type: Yes | No&lt;/li&gt;&lt;li&gt;Default: Yes&lt;/li&gt;&lt;/ul&gt;&lt;/span&gt;</description><ignore_cache>false</ignore_cache><is_private>false</is_private><name>glide.class.switch.enabled</name><read_roles/><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2015-06-04 23:55:19</sys_created_on><sys_id>8b18820053a002007c949096a11c084b</sys_id><sys_mod_count>2</sys_mod_count><sys_name>glide.class.switch.enabled</sys_name><sys_package display_value="Configuration Management (CMDB)" source="com.snc.cmdb">dfa3e79f9f2131107f44e6ca4224abef</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_8b18820053a002007c949096a11c084b</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:03:45</sys_updated_on><type>boolean</type><value>false</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=8b18820053a002007c949096a11c084b"/></record_update>]]></payload>
<payload_hash>1996787029</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>70230c7d41a231107f440d8147faed41</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda9738750000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>glide.class.switch.enabled</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>45edab2171623110a1c7d84b49d4956f</update_guid>
<update_guid_history>45edab2171623110a1c7d84b49d4956f:1996787029,4dedab21a062311049325ed59db2b554:-406639878</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_security_acl_78267fb9c3403200adce9624a1d3aea1</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_security_acl"><sys_security_acl action="INSERT_OR_UPDATE"><active>true</active><admin_overrides>true</admin_overrides><advanced>false</advanced><condition/><description/><local_or_existing/><name>sys_history_set</name><operation display_value="read">read</operation><script/><security_attribute/><sys_class_name>sys_security_acl</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2017-01-02 10:27:49</sys_created_on><sys_id>78267fb9c3403200adce9624a1d3aea1</sys_id><sys_mod_count>2</sys_mod_count><sys_name>sys_history_set</sys_name><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_security_acl_78267fb9c3403200adce9624a1d3aea1</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:47:47</sys_updated_on><type display_value="record">record</type></sys_security_acl></record_update>]]></payload>
<payload_hash>-1901877119</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>70230c7d41a231107f440d8147faed44</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e1bb340000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>sys_history_set</table>
<target_name>sys_history_set</target_name>
<type>Access Control</type>
<update_domain>global</update_domain>
<update_guid>518041116de231106c985c168134f8e9</update_guid>
<update_guid_history>518041116de231106c985c168134f8e9:-1901877119</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_56f7420053a002007c949096a11c08d0</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description>&lt;span style = 'font-family: Arial; font-size: 13px; color: #4a4a4a;'&gt;Allow class downgrades during identification and reconciliation.&lt;ul style='margin: 0px; padding-left:15px;'&gt;&lt;li&gt;Type: Yes | No&lt;/li&gt;&lt;li&gt;Default: Yes&lt;/li&gt;&lt;/ul&gt;&lt;/span&gt;</description><ignore_cache>false</ignore_cache><is_private>false</is_private><name>glide.class.downgrade.enabled</name><read_roles/><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2015-06-04 23:54:43</sys_created_on><sys_id>56f7420053a002007c949096a11c08d0</sys_id><sys_mod_count>2</sys_mod_count><sys_name>glide.class.downgrade.enabled</sys_name><sys_package display_value="Configuration Management (CMDB)" source="com.snc.cmdb">dfa3e79f9f2131107f44e6ca4224abef</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_56f7420053a002007c949096a11c08d0</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:03:44</sys_updated_on><type>boolean</type><value>false</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=56f7420053a002007c949096a11c08d0"/></record_update>]]></payload>
<payload_hash>-1625814771</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>74230c7d41a231107f440d8147faed40</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda9737170000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>glide.class.downgrade.enabled</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>70edab217a623110ffedcb897d0fab52</update_guid>
<update_guid_history>70edab217a623110ffedcb897d0fab52:-1625814771,f4edab219b623110d366c2af53c80c50:-2047518654</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_fab070c3c3122200eeed99c8d1d3ae09</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description>Verify hostname and certificate chain presented by remote SSL hosts. Set to true to protect against MITM attacks. Overrides the com.glide.communications.trustmanager_trust_all property</description><ignore_cache>false</ignore_cache><is_private>false</is_private><name>com.glide.communications.httpclient.verify_hostname</name><read_roles/><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2016-10-10 17:28:29</sys_created_on><sys_id>fab070c3c3122200eeed99c8d1d3ae09</sys_id><sys_mod_count>2</sys_mod_count><sys_name>com.glide.communications.httpclient.verify_hostname</sys_name><sys_package display_value="High Security Settings" source="com.glide.high_security">5b58ef9f9fa131107f44e6ca4224ab7f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_fab070c3c3122200eeed99c8d1d3ae09</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:25:31</sys_updated_on><type>boolean</type><value>true</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=fab070c3c3122200eeed99c8d1d3ae09"/></record_update>]]></payload>
<payload_hash>-1060316662</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>74230c7d41a231107f440d8147faed43</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd404507e0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>com.glide.communications.httpclient.verify_hostname</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>6a298d9101a6311042f1ccd286834331</update_guid>
<update_guid_history>6a298d9101a6311042f1ccd286834331:-1060316662,73d93c9549223110ec860fec86ee5c18:-1087324091,23d93c95e1223110f6a6e54091a90412:-1060316662</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_e9e97c95092231107f445d7a5f5e13af</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>cl.password</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:18:52</sys_created_on><sys_id>e9e97c95092231107f445d7a5f5e13af</sys_id><sys_mod_count>1</sys_mod_count><sys_name>cl.password</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_e9e97c95092231107f445d7a5f5e13af</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:24:07</sys_updated_on><type>string</type><value>jpYRkYBWWzTz</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=e9e97c95092231107f445d7a5f5e13af"/></record_update>]]></payload>
<payload_hash>267826820</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>78230c7d41a231107f440d8147faed42</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd402ff1e0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cl.password</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>edd8c55114a6311064851a174cde0286</update_guid>
<update_guid_history>edd8c55114a6311064851a174cde0286:267826820,b1e97c95d3223110e920ca8d2d4693c5:2104868481</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_wizard_answer_fa1fa7a1416231107f440d8147faed5a</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_wizard_answer"><sys_wizard_answer action="INSERT_OR_UPDATE"><active>true</active><answer>New Windows 2012, 2016, 2019 Query-Query Results</answer><button_label/><dependent_value/><element/><name>Windows 2012, 2016, 2019 Query-Query Results</name><next_question/><order>100</order><payload_name/><question display_value="Query Builder Results" name="Query Builder Results">85e4ab1b9f6131107f44e6ca4224abb9</question><roles/><script/><sys_class_name>sys_wizard_answer</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 00:09:04</sys_created_on><sys_id>fa1fa7a1416231107f440d8147faed5a</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Windows 2012, 2016, 2019 Query-Query Results</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_wizard_answer_fa1fa7a1416231107f440d8147faed5a</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:09:04</sys_updated_on><table/><target_url>u_cmdb_qb_result_335c16197bab41278b083220e1363ca398e3766a.do</target_url><type>1</type></sys_wizard_answer></record_update>]]></payload>
<payload_hash>1625553960</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>78230c7d41a231107f440d8147faed45</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda9c15360000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>Windows 2012, 2016, 2019 Query-Query Results</target_name>
<type>Answer</type>
<update_domain>global</update_domain>
<update_guid>ba1fa7a17c623110b5b71928a545ea5c</update_guid>
<update_guid_history>ba1fa7a17c623110b5b71928a545ea5c:1625553960</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_a0a13a03779a1110cd1b756f1b5a9958</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description>Toggles the info message on topic page that displays information about the new category surfacing feature</description><ignore_cache>true</ignore_cache><is_private>false</is_private><name>taxonomy.category.new_feature_alert</name><read_roles/><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2022-10-07 08:53:57</sys_created_on><sys_id>a0a13a03779a1110cd1b756f1b5a9958</sys_id><sys_mod_count>12</sys_mod_count><sys_name>taxonomy.category.new_feature_alert</sys_name><sys_package display_value="Content Taxonomy" source="com.snc.taxonomy">a612fb9b9f2531107f44e6ca4224abb4</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_a0a13a03779a1110cd1b756f1b5a9958</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-15 16:14:59</sys_updated_on><type>boolean</type><value>false</value><write_roles>maint</write_roles></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=a0a13a03779a1110cd1b756f1b5a9958"/></record_update>]]></payload>
<payload_hash>-654953879</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>7c230c7d41a231107f440d8147faed41</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3c3b4520000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>taxonomy.category.new_feature_alert</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>bc09bcd15f223110c1fdb95beb8da909</update_guid>
<update_guid_history>bc09bcd15f223110c1fdb95beb8da909:-654953879,2409bcd10a2231103b8d0736095af908:-74777054</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_section_48d8e729412231107f440d8147faed83</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_ui_section caption="" section_id="48d8e729412231107f440d8147faed83" sys_domain="global" table="cmdb_health_staleness_rule" version="3" view=""><sys_ui_element action="INSERT_OR_UPDATE"><element>.begin_split</element><position>0</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 23:41:35</sys_created_on><sys_id>d8d8e729412231107f440d8147faed8b</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="cmdb_health_staleness_rule" sys_domain="global" view="Default view">48d8e729412231107f440d8147faed83</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 23:41:35</sys_updated_on><sys_user/><type>.begin_split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>duration</element><position>1</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 23:41:35</sys_created_on><sys_id>90d8e729412231107f440d8147faed8c</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="cmdb_health_staleness_rule" sys_domain="global" view="Default view">48d8e729412231107f440d8147faed83</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 23:41:35</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.split</element><position>2</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 23:41:35</sys_created_on><sys_id>14d8e729412231107f440d8147faed8c</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="cmdb_health_staleness_rule" sys_domain="global" view="Default view">48d8e729412231107f440d8147faed83</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 23:41:35</sys_updated_on><sys_user/><type>.split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>sys_scope</element><position>3</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 23:41:35</sys_created_on><sys_id>94d8e729412231107f440d8147faed8c</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="cmdb_health_staleness_rule" sys_domain="global" view="Default view">48d8e729412231107f440d8147faed83</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 23:41:35</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>sys_domain</element><position>4</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 23:41:35</sys_created_on><sys_id>18d8e729412231107f440d8147faed8c</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="cmdb_health_staleness_rule" sys_domain="global" view="Default view">48d8e729412231107f440d8147faed83</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 23:41:35</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.end_split</element><position>5</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 23:41:35</sys_created_on><sys_id>d0d82f29412231107f440d8147faed2a</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="cmdb_health_staleness_rule" sys_domain="global" view="Default view">48d8e729412231107f440d8147faed83</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 23:41:35</sys_updated_on><sys_user/><type>.end_split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>applies_to</element><position>6</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 23:41:35</sys_created_on><sys_id>54d82f29412231107f440d8147faed2a</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="cmdb_health_staleness_rule" sys_domain="global" view="Default view">48d8e729412231107f440d8147faed83</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 23:41:35</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_section action="INSERT_OR_UPDATE"><caption/><header>false</header><name>cmdb_health_staleness_rule</name><roles/><sys_class_name>sys_ui_section</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 23:41:34</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>48d8e729412231107f440d8147faed83</sys_id><sys_mod_count>0</sys_mod_count><sys_name>cmdb_health_staleness_rule</sys_name><sys_overrides/><sys_package display_value="Configuration Management (CMDB)" source="com.snc.cmdb">dfa3e79f9f2131107f44e6ca4224abef</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_section_48d8e729412231107f440d8147faed83</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 23:41:34</sys_updated_on><sys_user/><title>true</title><view display_value="Default view" name="NULL">Default view</view><view_name/></sys_ui_section></sys_ui_section></record_update>]]></payload>
<payload_hash>1976927974</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>7c230c7d41a231107f440d8147faed44</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda82ec130000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>cmdb_health_staleness_rule</table>
<target_name>CMDB Health Staleness Rule</target_name>
<type>Form Layout</type>
<update_domain>global</update_domain>
<update_guid>1cd82f29a5223110235bfd2b3f086d2b</update_guid>
<update_guid_history>1cd82f29a5223110235bfd2b3f086d2b:1976927974,94d8e729d3223110d584de743ef4d187:269220907</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_9ca54850c31321003e76741e81d3ae35</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>4uYxGCHLeuDsWskKRDf1AA==</checksum><description>Regular expression describing commands and responses in case of failures</description><directory>false</directory><name>command_validation.properties</name><parent display_value="ServiceWatch">ed844850c31321003e76741e81d3ae39</parent><script>COMMAND_REGEX=sqlplus RESPONSE_REGEX=(ACCESSDENIED|ORA-01017|ORA-28000|ORA-12154|Usage\:)&#13;
COMMAND_REGEX=sqlcmd RESPONSE_REGEX=(Connection string is not valid|Login failed|Access is denied|E_ACCESSDENIED)&#13;
COMMAND_REGEX=powershell RESPONSE_REGEX=(Logon failure|Access is denied|WinRM cannot process the request|.*\(401\) Unauthorized)&#13;
COMMAND_REGEX=procwdx RESPONSE_REGEX=Permission denied&#13;
COMMAND_REGEX=^cat\s+ RESPONSE_REGEX=cat:.*Permission denied$&#13;
COMMAND_REGEX=mysql RESPONSE_REGEX=ERROR 1045</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2014-09-17 09:34:53</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>9ca54850c31321003e76741e81d3ae35</sys_id><sys_mod_count>4</sys_mod_count><sys_name>command_validation.properties</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_9ca54850c31321003e76741e81d3ae35</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:23</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-1798468091</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a0230c7d41a231107f440d8147faed37</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e247120000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>command_validation.properties</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>4aa0015100e23110100d60fd1d68ebac</update_guid>
<update_guid_history>4aa0015100e23110100d60fd1d68ebac:-1798468091,c6a00151d3e2311073f1ba99efde65ab:-994977016</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_fa45bfc89f3322001d753758442e70af</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>Phn+2lwZKNtnFKCg0mJOXg==</checksum><description/><directory>false</directory><name>unix_fqdn.sh</name><parent display_value="SSHScriptFiles">48deb961ff123100ab8fffffffffff07</parent><script>#!/bin/sh
hostname=`hostname 2&gt; /dev/null`
if [ "$?" -ne "0" ]; then
    echo "Unable to find a hostname!"
    exit 1
fi
echo $hostname | grep '\.' &gt;/dev/null 2&gt;&amp;1
if [ "$?" -eq "0" ]; then
	echo $hostname
else
	# search for keyword starting at the beginning of the line with optional whitespace
	domain=`grep '^[\s]*domain' /etc/resolv.conf`
	if [ -z "$domain" ]; then
		domain=`grep '^[\s]*search' /etc/resolv.conf`
	fi
	if [ "$domain" ]; then
		# use parameter parsing to tokenize 
		set -- $domain
		if [ $2 ]; then
			echo $hostname.$2
		fi
	fi
fi
exit 0</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>oron.subayi</sys_created_by><sys_created_on>2016-12-15 13:38:58</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>fa45bfc89f3322001d753758442e70af</sys_id><sys_mod_count>1</sys_mod_count><sys_name>unix_fqdn.sh</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_fa45bfc89f3322001d753758442e70af</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:24</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>2075779094</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a0230c7d41a231107f440d8147faed3a</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e2496e0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>unix_fqdn.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>46a001512ce231105abb59a685556cf8</update_guid>
<update_guid_history>46a001512ce231105abb59a685556cf8:2075779094,c2a00151bde231104b30b7e2f008d3f7:1815752132</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_orphan_ci_remediation_null</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="" extends="task" table="orphan_ci_remediation"><active>true</active><array>false</array><attributes/><audit>true</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label/><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element/><element_reference>false</element_reference><foreign_database/><formula/><function_definition/><function_field>false</function_field><internal_type display_value="Collection">collection</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>orphan_ci_remediation</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-10-03 16:54:04</sys_created_on><sys_id>ce95e79f9f6131107f44e6ca4224abc3</sys_id><sys_name>orphan_ci_remediation</sys_name><sys_package display_value="Configuration Management (CMDB)" source="com.snc.cmdb">dfa3e79f9f2131107f44e6ca4224abef</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_orphan_ci_remediation_null</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 01:07:32</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><virtual_type>script</virtual_type><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>-2132243003</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a0230c7d41a231107f440d8147faed3d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bdad19d190000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>orphan_ci_remediation</table>
<target_name>Orphan CI Remediation</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>df7cfb6588a23110cf8279ac81859a6b</update_guid>
<update_guid_history>df7cfb6588a23110cf8279ac81859a6b:-2132243003,9f7cfb65fba23110e618fdafa6580163:-1789982606</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>cmdb_health_metric_pref_0cda5ba11309220010eb529f3244b026</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="cmdb_health_metric_pref"><cmdb_health_metric_pref action="INSERT_OR_UPDATE"><active>true</active><create_task>true</create_task><failure_threshold>50000</failure_threshold><metric display_value="Orphan">c6272b5137130200f212cc028e41f168</metric><sys_class_name>cmdb_health_metric_pref</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2016-08-05 10:41:13</sys_created_on><sys_domain>global</sys_domain><sys_domain_path/><sys_id>0cda5ba11309220010eb529f3244b026</sys_id><sys_mod_count>3</sys_mod_count><sys_name>c6272b5137130200f212cc028e41f168</sys_name><sys_overrides/><sys_package display_value="Configuration Management (CMDB)" source="com.snc.cmdb">dfa3e79f9f2131107f44e6ca4224abef</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>cmdb_health_metric_pref_0cda5ba11309220010eb529f3244b026</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:56:57</sys_updated_on><task_assignee_group display_value="Application Development" name="Application Development">0a52d3dcd7011200f2d224837e6103f2</task_assignee_group><weighted_average_contribution>30</weighted_average_contribution></cmdb_health_metric_pref></record_update>]]></payload>
<payload_hash>-1736940910</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a023c87d41a231107f440d8147faeddb</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bdac7ed9f0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>c6272b5137130200f212cc028e41f168</target_name>
<type>CMDB Health Metric Preference</type>
<update_domain>global</update_domain>
<update_guid>101abb21e8a23110d308ea8b3d3b85df</update_guid>
<update_guid_history>101abb21e8a23110d308ea8b3d3b85df:-1736940910,d01abb219ba2311021a74950c6581add:1485770142</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>cmdb_recommended_fields_70688a6de42231107f443c8410589e33</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="cmdb_recommended_fields"><cmdb_recommended_fields action="INSERT_OR_UPDATE"><active>true</active><recommended>support_group,owned_by,location</recommended><sys_class_name>cmdb_recommended_fields</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 16:40:16</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>70688a6de42231107f443c8410589e33</sys_id><sys_mod_count>0</sys_mod_count><sys_name>cmdb_ci_server</sys_name><sys_overrides/><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>cmdb_recommended_fields_70688a6de42231107f443c8410589e33</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 16:40:16</sys_updated_on><table>cmdb_ci_server</table></cmdb_recommended_fields></record_update>]]></payload>
<payload_hash>2053170171</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a023c87d41a231107f440d8147faeddc</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd90135b50000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>cmdb_ci_server</table>
<target_name>cmdb_ci_server</target_name>
<type>CMDB Recommended Field</type>
<update_domain>global</update_domain>
<update_guid>38688a6d9c22311069297d968048d034</update_guid>
<update_guid_history>38688a6d9c22311069297d968048d034:2053170171</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_5781cd717f203100ed1c3b19befa91bc</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>2RVCU6DeZCtWVWUU05k1lQ==</checksum><description/><directory>false</directory><name>TibcoFilesParser.ksh</name><parent display_value="SSHScriptFiles">48deb961ff123100ab8fffffffffff07</parent><script>proj=`pwd`&#13;
proj=`echo $proj | sed -e 's|.*/||'`&#13;
tmpdir="/tmp/$proj/"&#13;
echo "TEMPDIR=$tmpdir"&#13;
&#13;
if [[ ! -d $tmpdir ]]&#13;
	then&#13;
		mkdir -p $tmpdir&#13;
		touch $tmpdir/NeebulaBWVariables.ini &#13;
&#13;
		for i in `find . -name *.substvar` &#13;
			do&#13;
			export  bdir=`echo $i| sed -e 's|defaultVars.substvar||' | sed -e 's|./defaultVars/||'`&#13;
			for j in `cat $i` &#13;
				do &#13;
				if [[ $j =~ "&lt;globalVariable&gt;" ]]&#13;
					then &#13;
						str="" &#13;
					fi&#13;
				if [[ $j =~ "&lt;name&gt;" ]]&#13;
					then &#13;
						str=`echo $j | cut -d\&gt; -f2| cut -d\&lt; -f1` &#13;
					fi&#13;
				if [[ $j =~ "&lt;value&gt;" ]] &#13;
					then&#13;
						str="$str%%#!#!#`echo $j | cut -d\&gt; -f2| cut -d\&lt; -f1`" &#13;
					fi&#13;
				if [[ $j =~ "&lt;/globalVariable&gt;" ]] &#13;
					then&#13;
						echo "%%$bdir$str" &gt;&gt; $tmpdir/NeebulaBWVariables.ini &#13;
					fi&#13;
			done&#13;
		done&#13;
		IFS=$'\n'&#13;
		for i in `find . -type f | egrep "process$|\.shared|\.serviceagent"` &#13;
			do &#13;
				file=`echo "$i" | tr "/" "\n" | egrep "process$|\.shared|\.serviceagent"`&#13;
				folder=`echo "$i" | sed -e "s|$file$||"`&#13;
				mkdir -p $tmpdir/$folder&#13;
				cp -f $i $tmpdir/$folder&#13;
			done&#13;
		IFS=$'\n'&#13;
		for i in `cat $tmpdir/NeebulaBWVariables.ini`&#13;
			do &#13;
				from=`echo $i | awk 'BEGIN { FS = "#!#!#" } ; { print $1 }'`&#13;
				to=`echo $i | awk 'BEGIN { FS = "#!#!#" } ; { print $2 }'`&#13;
				for j in `find $tmpdir -type f -exec egrep -l $from {} \;| grep -v "NeebulaBWVariables.ini" `&#13;
					do &#13;
						cd `dirname "$j"`&#13;
						filename=$j&#13;
						sed "s|$from|$to|g" "$filename" &gt; tempfile&#13;
						mv -f tempfile "$filename"&#13;
						cd -&#13;
					done&#13;
			done&#13;
	chmod -R 755 $tmpdir&#13;
	fi</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2014-11-23 09:08:57</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>5781cd717f203100ed1c3b19befa91bc</sys_id><sys_mod_count>3</sys_mod_count><sys_name>TibcoFilesParser.ksh</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_5781cd717f203100ed1c3b19befa91bc</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:23</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-1535418791</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a4230c7d41a231107f440d8147faed36</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e246850000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>TibcoFilesParser.ksh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>42a00151d3e23110458473a88dc7afa6</update_guid>
<update_guid_history>42a00151d3e23110458473a88dc7afa6:-1535418791,fda0015104e2311047030fc12d0514a4:1542971720</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_e786770c9f3322001d753758442e70b8</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>8F4S2c+KgrHQ/psoji75DA==</checksum><description/><directory>false</directory><name>Sstorage.bash</name><parent display_value="SSHScriptFiles">48deb961ff123100ab8fffffffffff07</parent><script>#!/bin/bash
# Executes various commands to retrieve disk and file system information.

echo "[[==PROBE:iostat==]]"
# Enumerate storage devices

iostat -Enr

echo "[[==PROBE:prtvtoc==]]"
# Gather partition information for each disk

storage_device_ids=$(iostat -En | awk '/^c/ { print $1 }')
for storage_device_id in $storage_device_ids ; do
    prtvtocCmd='${sudo:prtvtoc}'
    $prtvtocCmd /dev/rdsk/${storage_device_id}s2
done

echo "[[==PROBE:diff_iostat==]]"
# Create a map between Linux device IDs and Solaris device IDs

diff &lt;(iostat -E) &lt;(iostat -En) | awk '/^(&lt;|&gt;)/ { print $2 }'

echo "[[==PROBE:zpool_list==]]"
# List ZFS pool members

zpool list

echo "[[==PROBE:zpool_status==]]"
# List ZFS pools

zpool status | awk '$1 == "NAME", $1 == ""'

echo '[[==PROBE:df==]]'
# Probe for file systems

df -k

FCINFO=/usr/sbin/fcinfo
if [ -f $FCINFO ]; then
echo '[[==PROBE:fcinfo_hba==]]'
# Collect corresponding information for hha and its ports

${sudo:fcinfo hba-port}


echo '[[==PROBE:fcinfo_target==]]'
# Collect remote_ports and LUNs are seen by every port on hba

PORTWWN=`${sudo:fcinfo hba-port} | grep 'Port WWN' | cut -d ":" -f 2`
for port in $PORTWWN; do
echo '**Remote ports for:' $port
${sudo:fcinfo remote-port -sl -p $port}
done
fi

echo "[[==PROBE:sys_iscsi_initiator==]]"
# Get our iSCSI initiator
${sudo:iscsiadm list initiator-node} | grep 'Initiator node name'

echo '[[==PROBE:iscsi_session==]]'
# Probe for iSCSI sessions

iscsiadmCmd='${sudo:iscsiadm list target -S}'
$iscsiadmCmd | nawk '/Target:/ { print "iscsiSession:" ; print "  targetIqn: " $2 } /LUN:/ { print "  device: " ; print "    lun: " $2 } /OS Device Name:/ { cmd = "basename " $4; cmd | getline deviceId ; close(cmd) ; print "    id: " deviceId }'

exit 0</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2016-12-15 13:44:32</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>e786770c9f3322001d753758442e70b8</sys_id><sys_mod_count>1</sys_mod_count><sys_name>Sstorage.bash</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_e786770c9f3322001d753758442e70b8</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:24</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>268199619</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a4230c7d41a231107f440d8147faed39</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e248420000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>Sstorage.bash</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>4aa00151cde231107d9cf72ed60a5aee</update_guid>
<update_guid_history>4aa00151cde231107d9cf72ed60a5aee:268199619,c6a00151ade23110023ce1933cc35fed:-315768367</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_authentication_policy_criteria_m2m_b47e53c0c7322010df1417b703c26046</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_authentication_policy_criteria_m2m"><sys_authentication_policy_criteria_m2m action="INSERT_OR_UPDATE"><policy display_value="Step-Up MFA Policy">163ad1d373512010616ca9843cf6a789</policy><sys_auth_filter_criteria display_value="User Based MFA">6956fd56c7312010df1417b703c260dc</sys_auth_filter_criteria><sys_created_by>admin</sys_created_by><sys_created_on>2021-03-05 12:25:20</sys_created_on><sys_id>b47e53c0c7322010df1417b703c26046</sys_id><sys_mod_count>3</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2021-06-08 08:37:02</sys_updated_on><used>true</used></sys_authentication_policy_criteria_m2m></record_update>]]></payload>
<payload_hash>1649292187</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a4230c7d41a231107f440d8147faed3c</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3ff56390000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>6956fd56c7312010df1417b703c260dc</target_name>
<type>List of filter criteria</type>
<update_domain>global</update_domain>
<update_guid>32e7415dd1663110cc868292456884f3</update_guid>
<update_guid_history>32e7415dd1663110cc868292456884f3:1649292187</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_21488953957830107f44eb4508b8ade5</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>cl.activeUsers</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2021-06-22 13:55:02</sys_created_on><sys_id>21488953957830107f44eb4508b8ade5</sys_id><sys_mod_count>160</sys_mod_count><sys_name>cl.activeUsers</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_21488953957830107f44eb4508b8ade5</sys_update_name><sys_updated_by>trainingadmin</sys_updated_by><sys_updated_on>2023-11-16 23:33:35</sys_updated_on><type>string</type><value>12</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=21488953957830107f44eb4508b8ade5"/></record_update>]]></payload>
<payload_hash>1553111312</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a4230c7d41a231107f440d8147faed3f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda7b9cda0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cl.activeUsers</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>93f6ef6598223110bc476249eea70df8</update_guid>
<update_guid_history>93f6ef6598223110bc476249eea70df8:1553111312,ead5e725192231105a3d92cbaa7237de:-670738148,6d8b47e9f766311073b776488ede884f:-731750273,146a03a925663110dd53aafacffda28d:-691075523,87390f2934663110ece95ae6bdf8f854:-670738148,da18c7e5ea663110484d6ee096303cf0:1532773937,50f6c3a576663110297b507d361da9a5:-2030047859,2fc5cf250f6631103cb38b9d53712c26:-891154859,a6a48be152663110c3c7c951cfeebcf0:-240358859,4d8347a1d56631106452a0e3db03ead9:430774516,2f52436126663110c2519ffb2815ac9c:1101907891,9e314fed2226311057c806d60460093a:1651017016,19100bade526311006e0d67a0c12d5af:1793378641,8cfe366d342631103cf5e5545247fd1a:-1932142155,b7cdfee95f26311074ac9869b501a1b7:1772967836,a9acfaa9ee263110509381aec2674874:-1281419585,d48bf669692631105a0235b019df526a:-1118720585,035af2299b263110813a9ff27d059234:-508599335,b939bea5c3263110ebcbf55e249105ec:-20502335,7d949e6d006231106b4a26e4a6a58b36:-164960,4973162d5c62311002ca0e3cfb2f90a6:-40839710,bb4212e94f6231106119f42092bdd468:-508599335,5e21966975623110ba2d14ba3dc736fb:-650960960,4d00dee537623110a48f41bfac1020cd:-1810191335,f3de86a5e26231106f6a0e5d01ce11b0:1772967836,3abd8e253e623110ec47897c73447c0c:-2013491655,e99c46e1bf6231104feede1f95066dc5:1183257391,0c7b4e61606231108f2bfc39d634f646:512124016,764a462126623110ff57b348c0293ce8:390099766,2929cead45223110dd1242785fe870c3:-179346734,54080a6df9223110da93f6672c105b1a:-748793234,8fd6c22d4c2231103713aafc22d9ae2a:-891154859,75b502a9632231100cce282954afd2db:2142895187,28940a29162231109102799d5035d07a:1573448687,9023cee120223110b3bc3a18169bc264:-650400773,c0f10a9160aa3110b9c11c8416156bb0:-731750273,d1af3111daaa3110ecfbef7687addb81:-711412898,fe5d395d176a3110c369bdf3851ad024:-691075523,681bfd995b6a31101bb50a46dd6abb49:-670738148,b5c8b5193b6a31102dec4517d728e4cb:-650400773,1b76bd558d6a3110d24af1b55a04df0f:-630063398,5e553915a86a3110278648530031fab8:-609726023,053435d1c16a311016eb9d6fb91e49e3:-589388648,c8133191de6a311079bf032d18487e81:-569051273,aae13d11df6a3110455d5ec3bc73a232:-548713898,eac0f5dd502a311058b89da15c7bf1ba:-1379251859,44afe19d0c2a311076fb4bc96b3e62b9:1101907891,ec0bc15500a63110bd4459283759f34c:1183257391,1cd88551eda6311076f52fc1daa724b5:1162920016,1bb8015144a6311036f7353e6f34e421:-991605043,48780ddd476631105f2fa753ce4ddd4d:1879746003</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_433fbe295312320023bdae4a16dc34af</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>K40q6lMMcCFvVjuFPcKxpw==</checksum><description/><directory>false</directory><name>hpux_lsof_command.sh</name><parent display_value="ADME">ec515c705352320023bdae4a16dc3488</parent><script>#!/bin/sh&#13;
# Copyright © ServiceNow, Inc. 2017. All rights reserved.&#13;
&#13;
BASE_DIR=$1&#13;
cp "${BASE_DIR}/connection_samples/all_connections.log" "${BASE_DIR}/connection_samples/all_connections_tmp.log"&#13;
sudo lsof -iTCP -n -P | grep 'LISTEN' | grep -v "::" | awk -F' ' '{print "on " $2 " " $9}' | sed 's/:/ /g' | sort | uniq &gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
sudo lsof -iTCP -n -P | grep 'ESTABLISHED' | grep -v "::" |  sed 's/-&gt;/ /g' | awk -F' ' '{print "to " $2 " " $10 " " $9}' | sed 's/:/ /g' | sort | uniq &gt;&gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
cat "${BASE_DIR}/connection_samples/connection_sample.log" "${BASE_DIR}/connection_samples/all_connections_tmp.log" | sort &gt; "${BASE_DIR}/connection_samples/all_connections.log"</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>evan.qu</sys_created_by><sys_created_on>2017-04-23 08:10:39</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>433fbe295312320023bdae4a16dc34af</sys_id><sys_mod_count>7</sys_mod_count><sys_name>hpux_lsof_command.sh</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_433fbe295312320023bdae4a16dc34af</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:55</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>867010444</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a423c87d41a231107f440d8147faedde</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e002d80000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>hpux_lsof_command.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>3d10015d4fa231104692e295eacdbcce</update_guid>
<update_guid_history>3d10015d4fa231104692e295eacdbcce:867010444,b910015de9a231106664502fbec734cd:1973807723</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_4474d3889ff322001d753758442e7008</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>i+QRfuFPZyNVHl4uUey5gw==</checksum><description/><directory>false</directory><name>linux_fqdn.sh</name><parent display_value="SSHScriptFiles">48deb961ff123100ab8fffffffffff07</parent><script>#!/bin/sh
hostname=`hostname -f 2&gt; /dev/null`
#hostname var = hostname -f 2&gt; command
if [ "$?" -ne "0" ]; then
    echo "Unable to find a hostname!"
    exit 1
fi
#check the output if not null proceed
echo $hostname | grep "\." &gt;/dev/null 2&gt;&amp;1
if [ "$?" -eq "0" ]; then
	echo $hostname
    #if there is no . get hostname
else
	domain=`dnsdomainname 2&gt; /dev/null`
    #gets the dnsdomainname command
	if [ $domain ]; then
		echo $hostname.$domain
        #if the domain exist create hostname+domain
	else
		# search for keyword starting at the beginning of the line with optional whitespace
		domain=`grep ^[[:space:]]*domain /etc/resolv.conf`
		if [ -z "$domain" ]; then
			domain=`grep ^[[:space:]]*search /etc/resolv.conf`
		fi
		if [ "$domain" ]; then
			# use parameter parsing to tokenize 
			set -- $domain
			if [ $2 ]; then
				echo $hostname.$2
			fi
		fi
	fi
fi
exit 0</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>oron.subayi</sys_created_by><sys_created_on>2016-12-15 11:15:57</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>4474d3889ff322001d753758442e7008</sys_id><sys_mod_count>2</sys_mod_count><sys_name>linux_fqdn.sh</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_4474d3889ff322001d753758442e7008</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:23</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-131404797</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a8230c7d41a231107f440d8147faed35</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e2463b0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>linux_fqdn.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>7da00151b1e23110671b4aa82041f0a2</update_guid>
<update_guid_history>7da00151b1e23110671b4aa82041f0a2:-131404797,f9a00151a4e231106d8b1ed43512e3a1:213274170</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_d2a19c705352320023bdae4a16dc343c</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>qthwafMh/uRw6MIzPxvecQ==</checksum><description/><directory>false</directory><name>adme_collector.sh</name><parent display_value="ADME">ec515c705352320023bdae4a16dc3488</parent><script>#!/bin/sh&#13;
# Copyright © ServiceNow, Inc. 2017. All rights reserved.&#13;
#&#13;
# adme_collector.sh&#13;
#    Collector Script For Application Dependency Mapping (Ehnanced)&#13;
#&#13;
# Parameters:&#13;
#     base_dir&#13;
#     sampling_interval&#13;
#     max_total_samples&#13;
#&#13;
# File system structure:&#13;
#    $BASE_DIR&#13;
#        |&#13;
#        ————/scripts                  - location of adme_collector.sh and helper scripts &#13;
#        ----/logs                     - location of stdout and stderr redirection&#13;
#        ————/process_samples          - location of process sample files&#13;
#        ————/connection_samples       - location of connection sample files&#13;
#        ————/result                   - location of processes.logs and connections.log&#13;
#&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# PUBLIC PARAMETERS &#13;
# &#13;
#################################################################################&#13;
&#13;
BASE_DIR=&#13;
SAMPLING_INTERVAL=&#13;
MAX_TOTAL_SAMPLES=&#13;
USE_NET_TOOLS=&#13;
&#13;
#################################################################################&#13;
#&#13;
# MAIN VARIABLES &#13;
# &#13;
#################################################################################&#13;
&#13;
CONNECTION_INFO_COMMAND=&#13;
PROCESS_INFO_COMMAND=&#13;
&#13;
CURRENT_SAMPLE_COUNT=0&#13;
&#13;
UNIX_FLAVOR=&#13;
UNIX_PREFIX=&#13;
CURRENT_USER=&#13;
EFFECTIVE_USER_ID=&#13;
&#13;
USE_NETSTAT="false"&#13;
USE_LSOF="false"&#13;
&#13;
ERROR_LOG_FILENAME="stderr.log"&#13;
CONSOLE_LOG_FILENAME="stdout.log"&#13;
&#13;
&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# CONSTANTS &#13;
# &#13;
#################################################################################&#13;
&#13;
&#13;
#CURRENT_DATE_COMMAND="env LC_ALL=C date '+%a %b %e %H:%M %Z %Y'";&#13;
#CURRENT_DATE_COMMAND="env LC_ALL=C date '+%Y-%m-%d__%H_%M_%S'";&#13;
&#13;
# -u flag tells the command to get UTC time, so we don't worry about time zone&#13;
CURRENT_DATE_COMMAND="env LC_ALL=C date -u +%Y_%m_%d_%Hh_%Mm_%Ss";&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# Print usage message&#13;
# &#13;
#################################################################################&#13;
print_usage()&#13;
{&#13;
    echo "Usage:"&#13;
    echo "    $0 &lt;base_dir&gt; &lt;sampling_interval&gt; &lt;max_total_samples&gt;"&#13;
    echo "        base_dir                   - an already existing base directory for on disk data structures "&#13;
    echo "                                           - must be a absolute path to a directory "&#13;
    echo "                                           - effective user running this script must have rwx privileges on this directory"&#13;
    echo "        sampling_interval          - how often to sample process and connection data in seconds"&#13;
    echo "                                           - must be a minimum of 5 seconds "&#13;
    echo "        max_total_samples          - the limit of samples being taken by the script"&#13;
    echo "                                           - the script will stop running after max_total_samples samples are taken"&#13;
    echo "                                                                                   "&#13;
}&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# Validate soft dependency - print a warning if we don't have it&#13;
#&#13;
#################################################################################&#13;
validate_soft_dependency()&#13;
{&#13;
    COMMAND_LOCATION=`command -v "$1"`&#13;
    &#13;
    if [ $? -ne 0 ] ; then&#13;
    	COMMAND_LOCATION=`which "$1"`&#13;
    	&#13;
    	if [ $? -ne 0 ] ; then&#13;
        	echo &gt;&amp;2 "    WARNING: Could not locate soft dependency '$1' on system...parts of Application Dependency (Enhanced) may not work."&#13;
        	echo &gt;&amp;2 "         "      &#13;
   &#13;
        	echo "    WARNING: Could not locate soft dependency '$1' on system...parts of Application Dependency (Enhanced) may not work."&#13;
        	echo " "&#13;
        	return&#13;
        fi&#13;
    fi&#13;
    &#13;
    echo "    Located soft dependency '$1' in '$COMMAND_LOCATION'"&#13;
}&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# Validate dependency - to find out errors&#13;
#&#13;
#################################################################################&#13;
validate_dependency_for_errors()&#13;
{&#13;
	echo "Validate command $1" &gt;&amp;2&#13;
    COMMAND_LOCATION=`command -v "$1"`&#13;
    &#13;
    if [ $? -ne 0 ] ; then&#13;
    	COMMAND_LOCATION=`which "$1"`&#13;
    	&#13;
    	if [ $? -ne 0 ] ; then&#13;
        	echo  "    WARNING: Could not locate soft dependency '$1' on system...parts of Application Dependency (Enhanced) may not work." &gt;&amp;2&#13;
       		echo  "         "    &gt;&amp;2 &#13;
       		return&#13;
       	fi&#13;
    fi&#13;
&#13;
    echo "    Located soft dependency '$1' in '$COMMAND_LOCATION'" &gt;&amp;2&#13;
    &#13;
    if [ "$1" = "netstat" ] ; then&#13;
    	echo " Possible error in sudoer configuration or requiretty is not configured" &gt;&amp;2&#13;
    fi&#13;
    &#13;
    if [ "$1" = "lsof" ] ; then&#13;
    	echo " Possible error in sudoer configuration or requiretty is not configured" &gt;&amp;2&#13;
    fi    &#13;
    &#13;
}&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# Validate dependencies &#13;
#&#13;
#################################################################################&#13;
validate_dependencies()&#13;
{&#13;
    echo "Validating soft (partial functionality without these) dependencies...."&#13;
&#13;
    validate_soft_dependency 'awk'&#13;
    validate_soft_dependency 'basename'&#13;
    validate_soft_dependency 'bc'&#13;
    validate_soft_dependency 'cat'&#13;
    validate_soft_dependency 'chmod'&#13;
    validate_soft_dependency 'cp'&#13;
    validate_soft_dependency 'cut'&#13;
    validate_soft_dependency 'dirname'&#13;
    validate_soft_dependency 'env'&#13;
    validate_soft_dependency 'expr'&#13;
    validate_soft_dependency 'find'&#13;
    validate_soft_dependency 'grep'&#13;
    validate_soft_dependency 'head'&#13;
    validate_soft_dependency 'mkdir'&#13;
    validate_soft_dependency 'printf'&#13;
    validate_soft_dependency 'ps'&#13;
    validate_soft_dependency 'read'&#13;
    validate_soft_dependency 'rm'&#13;
    validate_soft_dependency 'sed'&#13;
    validate_soft_dependency 'sort'&#13;
    validate_soft_dependency 'tr'&#13;
    validate_soft_dependency 'uname'&#13;
    validate_soft_dependency 'wc'&#13;
    validate_soft_dependency 'which'&#13;
    validate_soft_dependency 'whoami'&#13;
    validate_soft_dependency 'netstat' &#13;
    validate_soft_dependency 'lsof'&#13;
&#13;
    echo " "&#13;
}&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# Validate arguments&#13;
#&#13;
#################################################################################&#13;
validate_arguments()&#13;
{&#13;
&#13;
    echo "Validating arguments..."&#13;
&#13;
    if [ $# -ne 4 ] ;  then&#13;
        echo "Incorrect number of arguments....expecting 4, saw $#"&#13;
        echo " "&#13;
        print_usage;&#13;
        exit 1;&#13;
    fi&#13;
&#13;
    BASE_DIR="$1";&#13;
&#13;
    if [ ! -d "$BASE_DIR" ]; then&#13;
        echo "'$BASE_DIR' does not appear to exist, or is not a valid directory!"&#13;
        echo " "&#13;
        print_usage;&#13;
        exit 1;       &#13;
    fi&#13;
&#13;
&#13;
    if [ ! -w "$BASE_DIR" ]; then&#13;
        echo "'$BASE_DIR' does not appear to a writeable directory!"&#13;
        echo " "&#13;
        print_usage;&#13;
        exit 1;       &#13;
    fi&#13;
&#13;
&#13;
    if [ ! -d "$BASE_DIR/scripts" ]; then&#13;
        echo "'$BASE_DIR/scripts' does not appear to exist, or is not a valid directory!"&#13;
        echo "A valid installation of Application Dependency (Enhanced) will have this directory present...aborting." &#13;
        echo " "&#13;
        print_usage;&#13;
        exit 1;       &#13;
    fi&#13;
&#13;
&#13;
&#13;
    SAMPLING_INTERVAL="$2";&#13;
    case "$SAMPLING_INTERVAL" in&#13;
        *[!0-9]*|'') &#13;
            echo "Provided sampling interval of '$SAMPLING_INTERVAL' is not a valid integer!"&#13;
            echo " "&#13;
            print_usage;&#13;
            exit 1;&#13;
            ;;&#13;
        *)   &#13;
            echo "    Provided sampling interval of '$SAMPLING_INTERVAL' seconds"&#13;
            ;;&#13;
&#13;
    esac&#13;
 &#13;
&#13;
    MAX_TOTAL_SAMPLES="$3"&#13;
    case "$MAX_TOTAL_SAMPLES" in&#13;
        *[!0-9]*|'') &#13;
            echo "Provided total sample count limit of '$MAX_TOTAL_SAMPLES' is not a valid integer!"&#13;
            echo " "&#13;
            print_usage;&#13;
            exit 1;&#13;
            ;;&#13;
        *)   &#13;
            echo "    Provided total sample count of '$MAX_TOTAL_SAMPLES' samples"&#13;
            ;;&#13;
    esac&#13;
&#13;
    &#13;
    # Check to make sure $SAMPLING_INTERVAL is at least 5 seconds&#13;
    if [ "$SAMPLING_INTERVAL" -lt 5 ]; then&#13;
        echo "sampling_interval '$SAMPLING_INTERVAL' needs to be at least 5 seconds." &#13;
        echo " "&#13;
        print_usage;&#13;
        exit 1;&#13;
    fi&#13;
 &#13;
    USE_NET_TOOLS="$4"&#13;
&#13;
    echo " "&#13;
}&#13;
&#13;
#################################################################################&#13;
#&#13;
# Create PID file - easier management/killing of collector processes later&#13;
#&#13;
#################################################################################&#13;
create_pid_file()&#13;
{&#13;
    CALLING_SCRIPT_FULL_NAME="$0"&#13;
    CALLING_SCRIPT_NAME=`basename "$CALLING_SCRIPT_FULL_NAME" .sh`&#13;
    PID_FILE_FILENAME="${BASE_DIR}/${CALLING_SCRIPT_NAME}.pid"&#13;
&#13;
    echo "Creating PID file for '$CALLING_SCRIPT_FULL_NAME' at '$PID_FILE_FILENAME'"&#13;
    echo $$ 1&gt; "$PID_FILE_FILENAME"&#13;
&#13;
    echo "  "&#13;
}&#13;
&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# Set up stdout and stderr redirection&#13;
#&#13;
#################################################################################&#13;
setup_redirection()&#13;
{&#13;
&#13;
    CONSOLE_LOG_FILENAME="${BASE_DIR}/logs/${CONSOLE_LOG_FILENAME}"&#13;
    ERROR_LOG_FILENAME="${BASE_DIR}/logs/${ERROR_LOG_FILENAME}"&#13;
&#13;
    echo "Setting up redirection...."&#13;
    echo "    All future console logging will be in '$CONSOLE_LOG_FILENAME'" &#13;
    echo "    All future error logging will be in '$ERROR_LOG_FILENAME'" &#13;
&#13;
    exec  &gt;&gt;  "$CONSOLE_LOG_FILENAME"&#13;
    exec  2&gt;&gt; "$ERROR_LOG_FILENAME"&#13;
    echo " ";&#13;
}&#13;
&#13;
&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# Helper function to create or clean a directory &#13;
#&#13;
#################################################################################&#13;
create_or_clean_directory()&#13;
{&#13;
&#13;
    if [ -d "$1" ]; then&#13;
        echo "    '$1 already exists...wiping it clean!";&#13;
        rm -rf $1&#13;
    else&#13;
        echo "    '$1' does not exist yet...creating it!";&#13;
    fi&#13;
    &#13;
    mkdir -p "$1"&#13;
&#13;
}&#13;
&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# Set up directory structure&#13;
#&#13;
#################################################################################&#13;
setup_directory_structure()&#13;
{&#13;
    echo "Setting up directory structure....in '$BASE_DIR'";&#13;
&#13;
    create_or_clean_directory "${BASE_DIR}/logs"&#13;
    create_or_clean_directory "${BASE_DIR}/process_samples"&#13;
    create_or_clean_directory "${BASE_DIR}/connection_samples"&#13;
    create_or_clean_directory "${BASE_DIR}/result"&#13;
&#13;
   echo " "&#13;
}&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# Detect Unix Flavor&#13;
#&#13;
#################################################################################&#13;
detect_unix_flavor()&#13;
{&#13;
    UNIX_FLAVOR=`uname -s`&#13;
    echo "Detected *NIX flavor of '$UNIX_FLAVOR'"&#13;
}&#13;
&#13;
&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# Detect Current User&#13;
#&#13;
#################################################################################&#13;
detect_current_user()&#13;
{&#13;
   COMMAND_LOCATION=`command -v whoami`&#13;
   if [ $? -eq 0 ] ; then&#13;
      CURRENT_USER=`whoami`&#13;
      echo "Detected current user of '$CURRENT_USER'"&#13;
	fi&#13;
&#13;
    if [ "$UNIX_PREFIX" != "solaris" ] ; then&#13;
		 EFFECTIVE_USER_ID=`id -u`&#13;
		 echo "Effective user id is $EFFECTIVE_USER_ID"&#13;
		 if [ "$EFFECTIVE_USER_ID" -eq 0 ] ; then&#13;
 &#13;
			 echo "    This script is being run with super user privileges "&#13;
		 else&#13;
			 echo "    This script is NOT being run with superuser privileges "    &#13;
		 fi &#13;
	fi&#13;
&#13;
    echo " "    &#13;
}&#13;
&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# Set the canonical unix prefix&#13;
#&#13;
#################################################################################&#13;
set_unix_prefix()&#13;
{&#13;
&#13;
    case "$UNIX_FLAVOR" in&#13;
        AIX)&#13;
            UNIX_PREFIX="aix";&#13;
            ;;&#13;
	SunOS)&#13;
            UNIX_PREFIX="solaris"&#13;
            ;;&#13;
        HP-UX)&#13;
            UNIX_PREFIX="hpux"&#13;
            ;;&#13;
        *)&#13;
            UNIX_PREFIX="linux"&#13;
            ;;&#13;
    esac&#13;
&#13;
&#13;
    echo "Setting canonical unix prefix to '$UNIX_PREFIX'"&#13;
    echo " "&#13;
}&#13;
&#13;
&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# Determine if netstat should be used&#13;
#&#13;
#################################################################################&#13;
determine_netstat_use()&#13;
{&#13;
	#Default netstat is enabled&#13;
    check_netstat=`command -v netstat`&#13;
	if [ $? -eq 0 ] ; then&#13;
		USE_NETSTAT="true"&#13;
	fi    &#13;
	case "$UNIX_PREFIX" in&#13;
		solaris)&#13;
			# If netstat command has the -u option, use it&#13;
			if [ "`netstat -u`" ]&#13;
			then&#13;
				USE_NETSTAT="true"&#13;
			else&#13;
				USE_NETSTAT="false"&#13;
			fi&#13;
			;;&#13;
		hpux)&#13;
			# HPUX always use lsof&#13;
			USE_NETSTAT="false"&#13;
			;;&#13;
		*)&#13;
			;;&#13;
	esac&#13;
}&#13;
&#13;
&#13;
determine_lsof_use()&#13;
{&#13;
	check_lsof=`command -v lsof`;&#13;
	if [ $? -eq 0 ] ; then&#13;
		USE_LSOF="true"&#13;
	fi&#13;
}&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# Set the connection information command we will use&#13;
#&#13;
#################################################################################&#13;
set_connection_info_command()&#13;
{&#13;
    # Prepend full executable path&#13;
    if [ "$USE_NETSTAT" = "true" ] &amp;&amp; [ "$USE_NET_TOOLS" = "true" ];&#13;
    then&#13;
        CONNECTION_INFO_COMMAND="${BASE_DIR}/scripts/${UNIX_PREFIX}_netstat_command.sh"&#13;
    elif [ "$USE_LSOF" = "true" ]&#13;
    then&#13;
        CONNECTION_INFO_COMMAND="${BASE_DIR}/scripts/${UNIX_PREFIX}_lsof_command.sh"&#13;
    else&#13;
        CONNECTION_INFO_COMMAND="${BASE_DIR}/scripts/${UNIX_PREFIX}_ss_command.sh"&#13;
    fi&#13;
&#13;
    echo "Setting command we will use to collect connection information to '$CONNECTION_INFO_COMMAND'"&#13;
    echo " "&#13;
}&#13;
&#13;
&#13;
&#13;
&#13;
#################################################################################&#13;
#&#13;
# Set the process information command we will use&#13;
#&#13;
#################################################################################&#13;
set_process_info_command()&#13;
{&#13;
&#13;
    # Prepend full executable path&#13;
    PROCESS_INFO_COMMAND="${BASE_DIR}/scripts/${UNIX_PREFIX}_ps_command.sh"&#13;
&#13;
    echo "Setting command we will use to collect process information to '$PROCESS_INFO_COMMAND'"&#13;
    echo " "&#13;
&#13;
}&#13;
&#13;
#################################################################################&#13;
#&#13;
#  After reaching the sample count limitation, or errors delete everything except &#13;
#  the pid file, the results and stderr&#13;
#&#13;
#################################################################################&#13;
cleanup()&#13;
{&#13;
	rm -rf $BASE_DIR/connection_samples&#13;
	rm -rf $BASE_DIR/process_samples&#13;
	rm -rf $BASE_DIR/logs/stdout.log&#13;
}&#13;
&#13;
#################################################################################&#13;
#&#13;
# Echo out error validation and logging&#13;
#&#13;
#################################################################################&#13;
error_logging()&#13;
{&#13;
	echo "Error validation" &gt;&amp;2&#13;
	if [ "$USE_NETSTAT" = "true" ]&#13;
    then&#13;
	    validate_dependency_for_errors 'netstat' &#13;
	else&#13;
    	validate_dependency_for_errors 'lsof'&#13;
    fi&#13;
	echo "Exiting process." &gt;&amp;2&#13;
	cleanup   &#13;
}&#13;
&#13;
#################################################################################&#13;
#&#13;
# Main Body of Script&#13;
#&#13;
#################################################################################&#13;
&#13;
&#13;
validate_arguments $*&#13;
&#13;
create_pid_file; &#13;
&#13;
setup_directory_structure;&#13;
&#13;
setup_redirection;&#13;
&#13;
validate_dependencies;&#13;
&#13;
detect_unix_flavor;&#13;
&#13;
set_unix_prefix;&#13;
&#13;
determine_netstat_use;&#13;
&#13;
determine_lsof_use;&#13;
&#13;
detect_current_user;&#13;
&#13;
set_connection_info_command;&#13;
&#13;
set_process_info_command;&#13;
&#13;
CURRENT_DATE="`${CURRENT_DATE_COMMAND}`"&#13;
echo "    The current timestamp is $CURRENT_DATE"&#13;
echo " "&#13;
&#13;
cp /dev/null "${BASE_DIR}/connection_samples/all_connections.log"&#13;
cp /dev/null "${BASE_DIR}/process_samples/all_processes.log"&#13;
CURRENT_SAMPLE_COUNT=1&#13;
 while [ "$CURRENT_SAMPLE_COUNT" -le "$MAX_TOTAL_SAMPLES" ]&#13;
 do&#13;
 	CURRENT_DATE="`${CURRENT_DATE_COMMAND}`"&#13;
 	echo "About to take sample $CURRENT_SAMPLE_COUNT. Current timestamp is $CURRENT_DATE"&#13;
    "$CONNECTION_INFO_COMMAND" "$BASE_DIR"  2&gt;&gt;  "$ERROR_LOG_FILENAME"&#13;
&#13;
    if [ "$CURRENT_SAMPLE_COUNT" -eq 1 ]&#13;
    then&#13;
    	if [ -s "${BASE_DIR}/connection_samples/all_connections.log"  ]&#13;
    	then&#13;
    		echo "Connection sample file is not empty"&#13;
    	else&#13;
    		echo "Connection sample file size is 0" &gt;&amp;2&#13;
    		error_logging&#13;
    		exit 1&#13;
    	fi&#13;
    fi&#13;
    &#13;
    #matching with ADM in text based tabular format&#13;
    #if type=to ip is remote ip, port is remote port&#13;
    #if type=on ip is local ip, port is local port &#13;
    echo "COUNT TYPE PID IP PORT LOCAL_IP LOCAL_PORT" &gt; 	"${BASE_DIR}/result/connections.log" &#13;
    cat "${BASE_DIR}/connection_samples/all_connections.log"  | sort | uniq -c &gt;&gt; "${BASE_DIR}/result/connections.log"&#13;
&#13;
&#13;
	"$PROCESS_INFO_COMMAND" "$BASE_DIR"  2&gt;&gt;  "$ERROR_LOG_FILENAME"&#13;
&#13;
    if [ "$CURRENT_SAMPLE_COUNT" -eq 1 ]&#13;
    then&#13;
    	if [ -s "${BASE_DIR}/process_samples/all_processes.log" ]&#13;
    	then&#13;
    		echo "Process sample file is not empty"&#13;
    	else&#13;
    		echo "Process sample file size is 0" &gt;&amp;2&#13;
    		error_logging&#13;
    		exit 1&#13;
    	fi&#13;
    fi&#13;
&#13;
	#matching with ADM in text based tabular format with added count&#13;
    #Column order: COUNT PID PPID COMMAND&#13;
 	echo "COUNT PID PPID COMMAND" &gt;     "${BASE_DIR}/result/processes.log" &#13;
 	cat "${BASE_DIR}/process_samples/all_processes.log" | sort | uniq -c &gt;&gt; "${BASE_DIR}/result/processes.log"  &#13;
&#13;
    CURRENT_SAMPLE_COUNT=`expr "$CURRENT_SAMPLE_COUNT" + 1`    &#13;
    sleep "$SAMPLING_INTERVAL"    &#13;
 done&#13;
&#13;
# After reaching the sample count limitation, delete everything except the pid file and the result&#13;
cleanup&#13;
echo "    "&#13;
echo "    total sample count limit of $MAX_TOTAL_SAMPLES is reached, exiting."&#13;
&#13;
exit 0</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>evan.qu</sys_created_by><sys_created_on>2017-04-20 11:44:11</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>d2a19c705352320023bdae4a16dc343c</sys_id><sys_mod_count>31</sys_mod_count><sys_name>adme_collector.sh</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_d2a19c705352320023bdae4a16dc343c</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:56</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-1434202086</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a8230c7d41a231107f440d8147faed38</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e009280000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>adme_collector.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>8e10415df7a23110b87ffa64d45c7f30</update_guid>
<update_guid_history>8e10415df7a23110b87ffa64d45c7f30:-1434202086,0e10415dc8a23110776567ca6ba3d12f:-253807735</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>remediation_rule_a1c233e5416231107f440d8147faedcf</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="remediation_rule"><remediation_rule action="INSERT_OR_UPDATE"><active>true</active><execution>2</execution><name>Remediate Orphans</name><sys_class_name>remediation_rule</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 00:25:48</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>a1c233e5416231107f440d8147faedcf</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Remediate Orphans</sys_name><sys_overrides/><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>remediation_rule_a1c233e5416231107f440d8147faedcf</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:25:48</sys_updated_on><task_filter/><type>orphan_ci_remediation</type><workflow display_value="Remediate Orphan WF">d172bf65416231107f440d8147faed6a</workflow></remediation_rule></record_update>]]></payload>
<payload_hash>-89354739</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a8230c7d41a231107f440d8147faed3b</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bdaab67580000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>Remediate Orphans</target_name>
<type>CMDB Remediation Rule</type>
<update_domain>global</update_domain>
<update_guid>c8f2f3e526623110b247b72babebbe65</update_guid>
<update_guid_history>c8f2f3e526623110b247b72babebbe65:-89354739</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_19e97c95092231107f445d7a5f5e1359</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>cl.management.host</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:18:51</sys_created_on><sys_id>19e97c95092231107f445d7a5f5e1359</sys_id><sys_mod_count>1</sys_mod_count><sys_name>cl.management.host</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_19e97c95092231107f445d7a5f5e1359</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:24:07</sys_updated_on><type>string</type><value>clabs</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=19e97c95092231107f445d7a5f5e1359"/></record_update>]]></payload>
<payload_hash>-1667783032</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a8230c7d41a231107f440d8147faed3e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd402fd520000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cl.management.host</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>1dd8c551fea631109e46688eef186283</update_guid>
<update_guid_history>1dd8c551fea631109e46688eef186283:-1667783032,21e97c958b223110285110c6d2699f9f:-1543759893</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_2c7d37409f7322001d753758442e707d</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>5Dm/0pBA3YPxuNvNyt/qKA==</checksum><description/><directory>false</directory><name>cpus.sh</name><parent display_value="SSHScriptFiles">48deb961ff123100ab8fffffffffff07</parent><script>for i in `lsdev -C -F 'name,status' -c processor | grep -vi defined`; do
      PROC=`echo $i | cut -d "," -f1`
      lsattr -E -F 'attribute,value' -l $PROC
done</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>oron.subayi</sys_created_by><sys_created_on>2016-12-15 14:14:56</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>2c7d37409f7322001d753758442e707d</sys_id><sys_mod_count>3</sys_mod_count><sys_name>cpus.sh</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_2c7d37409f7322001d753758442e707d</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:23</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-334302626</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>a823c87d41a231107f440d8147faeddd</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e245e70000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cpus.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>7da0015122e2311031f222267a2c6f6d</update_guid>
<update_guid_history>7da0015122e2311031f222267a2c6f6d:-334302626,f9a0015137e23110c5f2759348abd36c:1527611287</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_b9f5730c9f3322001d753758442e70f8</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>SF6Vk8rL01/h9XnrSG/Dvw==</checksum><description/><directory>false</directory><name>suntype.sh</name><parent display_value="SSHScriptFiles">48deb961ff123100ab8fffffffffff07</parent><script>#!/bin/sh
# $Id$
# 
# hosttype: Figure out what sort of sun this is.
#
# Version 2.1   August 14, 1998
# John DiMarco &lt;jdd@cs.toronto.edu&gt;
# University of Toronto, Computer Science Laboratory (CSLab)

PATH="/bin:/usr/bin:/usr/etc:/usr/sbin:/usr/ucb"; export PATH
VERBOSE="VERBOSE yes"	
PROMINFO="yes"		# use prtconf/devinfo.  Otherwise use hostid only.

# awk has a byte limit of 2559 bytes on older solaris machines
# default to using nawk if available. nawk has a limit of 1073741823 bytes.
AWKCMD="awk"
if hash nawk 2&gt;/dev/null; then
  AWKCMD="nawk"
fi

# output system configuration directly
/usr/sbin/prtconf | grep 'System Configuration:'

while getopts vH c; do
  case $c in
  v) VERBOSE="VERBOSE yes" ;;
  H) PROMINFO="no" ;;
  *) echo "Usage $0 [-v][-H]" 1&gt;&amp;2; exit 3 ;;
  esac
done
export VERBOSE PROMINFO

# misc function definitions
get_hostid() {
  # Output the host id, if possible
  echo HOSTID
  if [ -x /usr/bin/hostid ]; then
    /usr/bin/hostid 2&gt;/dev/null
  elif [ -x /usr/ucb/hostid ]; then
    /usr/ucb/hostid 2&gt;/dev/null
  fi
}
get_prominfo() {
  # Output the output of prtconf/devinfo -pv, if possible
  echo PROMINFO
  if [ "yes" = "$PROMINFO" ]; then
    if [ -x /usr/sbin/prtconf ]; then
      /usr/sbin/prtconf -pv 2&gt;/dev/null
    elif [ -x /usr/etc/devinfo ]; then
      /usr/etc/devinfo -pv 2&gt;/dev/null
    fi
  fi
}

(
echo $VERBOSE
cat &lt;&lt;END_OF_TABLE
#
# ID = model code from hostid.
# DEV_NAME = Sun internal development name
# SYSTEM_NAME = System name
# MODEL_NAME = Model name(s)
# CLK = CLock speed
# CPU_NAME = name of CPU (Integer Unit)
# 		NB: cpu name in table may not always be correct.
# 
# This data is overridden by prtconf/devinfo -pv data, if available.
#
ID DEV_NAME    SYSTEM_NAME      MODEL_NAME           CLK  CPU_NAME (IU)
## ########### ################ #################### #### #################
01 unknown     2/100            100U,150U,120,170    10   Motorola,MC68010
02 unknown     2/50             50,130,160           10   Motorola,MC68010
11 Carrera     3/100            75,140,150,160,180   16.7 Motorola,MC68020
12 M25         3/50             _NA                  12.5 Motorola,MC68020
13 Sirius      3/200            260,280              25   Motorola,MC68020
14 Prism       3/110            _NA                  16.7 Motorola,MC68020
17 Ferrari     3/60             _NA                  20   Motorola,MC68020
18 unknown     3E               _NA                  ??.? Motorola,MC68020
21 Sunrise     4/200            260,280              16.7 Fujitsu,MB86903
22 Cobra       4/100            110,150              14.2 Fujitsu,SF9010
23 Stingray    4/300            310,330,370,390      25   Cypress,CY7C601
24 Sunray      4/400            470,490              33   Cypress,CY7C601
31 RoadRunner  386i             150,250              ??.? Intel,80386DX
32 Apache      486i             unknown              ??.? Intel,80486DX
41 Pegasus     3/400            470,490              33   Motorola,MC68030
42 Hydra       3/80             _NA                  20   Motorola,MC68030
51 Campus      SPARCstation-1   4/60                 20   LSI,L64801
52 Phoenix     SPARCstation-IPC 4/40                 25   LSI,L64801
53 CampusB     SPARCstation-1+  4/65                 25   LSI,L64801
54 OffCampus   SPARCstation-SLC 4/20                 20   LSI,L64801
55 Calvin      SPARCstation-2   4/75                 40   Cypress,CY7C601
56 NodeWarrior SPARCstation-ELC 4/25                 33   Weitek,W8601
57 Hobbes      SPARCstation-IPX 4/50                 40   Weitek,W8601
61 Polaris     4E               _NA                  ??.? unknown,SPARC
71 Galaxy      SPARCsystem-600  _MBUS                40   variable
72 Campus2     SPARCstation-10  _MBUS                40   variable
72 Kodiak      SPARCstation-20  _MBUS                50   variable
80 Sunergy     SPARCclassic     4/15                 50   TI,TMS390S10
80 Sunergy     SPARCstation-LX  4/30                 50   TI,TMS390S10
80 Aurora      SPARCstation-5   _SS5                 ??.? unknown,SPARC
80 Perigee     SPARCstation-4   _SS4                 ??.? unknown,SPARC
80 Gypsy       unknown          Voyager              60   unknown,SPARC
80 Scorpion    SPARCserver-1000 _XDBUS               ??.? variable
80 Dragon      SPARCserver-2000 _XDBUS               ??.? variable
# There's no simple way to distinguish between the three different kinds
# of Ultra-1 systems, or the four different kinds of Ultra enterprise systems.
80 Neutron(U1)/Electron(U1E)/Dublin(U150) Ultra-1 Ultra1 ??.? SUNW,UltraSPARC
80 Pulsar      Ultra-2          Ultra2               ??.? variable
80 Quark       Ultra-30         Ultra30              ??.? variable
80 Deuterium   Ultra-60         Ultra60              ??.? variable
80 Javelin     Ultra-250        Ultra250             ??.? variable
80 Tazmo       Ultra-4          Ultra450             ??.? variable
80 Duraflame(E3k)/Campfire(E4/5k)/Sunfire(E6k)/Duraflame+(EX500) Ultra-Enterprise EXX00 ??.? variable
80 Starfire    Ultra-Enterprise-10000 Enterprise10000 ??.? variable
80 Darwin      Ultra-5_10       Ultra5,Ultra10       ??.? variable
END_OF_TABLE
get_hostid
get_prominfo
) | sed -e '/translations:/d' -e '/post-to-obp:/d' | $AWKCMD '
BEGIN {
  #
  # SS10/20/600 type table:
  # Maps from module clock rate to system name.
  #
  mtype[33]=2 
  mtype[36]=3
  mtype[40]=4
  mtype[40.3]=4
  mtype[50]=5
  mtype[60]=6
  mtype[75]=7
  mtype[85]=8
  #
  # Some constants
  #
  MB=1048576
  KB=1024
  M=1000000
  ROSS="Ross 605 SPARC"
  #
  # Maps from reported processor name to generic processor name
  #
  ptype["Motorola,MC68010"]="68K"
  ptype["Motorola,MC68020"]="68K"
  ptype["Motorola,MC68030"]="68K"
  ptype["Intel,80386DX"]="x86"
  ptype["Intel,80486DX"]="x86"
  ptype["Fujitsu,MB86900IU"]="SPARC"
  ptype["Fujitsu,SF9010IU"]="SPARC"
  ptype["Cypress,CY7C601"]="SPARC"
  ptype["Weitek,W8601"]="SPARC"
  ptype["LSI,L64811"]="SPARC"
  ptype["TI,TMS390S10"]="MicroSPARC I"
  ptype["TI,TMS390Z50"]="SuperSPARC"
  ptype["TI,TMS390Z55"]="SuperSPARC"
  ptype["Cypress,CY605"]=ROSS
  ptype["Ross,RT605"]=ROSS
  ptype["Ross,RT625"]="HyperSPARC"
  ptype["SUNW,UltraSPARC"]="UltraSPARC"
  ptype["SUNW,UltraSPARC-II"]="UltraSPARC"
  ptype["SUNW,UltraSPARC-IIi"]="UltraSPARC"
}
$1~/^#/ { continue }
$1=="VERBOSE" { verbose=$2; continue }
$1=="ID" || $1=="PROMINFO" || $1=="HOSTID" { mode=$1; continue }
mode=="ID" {
  #
  # read a line of the ID table
  #
  nlines++
  hostidcode[nlines]=$1
  id[$1]=nlines
  devname[nlines]=$2
  sysname[nlines]=$3
  model[nlines]=$4
  clk[nlines]=$5
  cpu[nlines]=$6
  nm[$3]=nlines
}
mode=="HOSTID" {
  hostid=substr($1,0,2)
}
mode=="PROMINFO" {
  if($1=="idprom:"){
    # get hostid code from here if it is not already defined
    if(!hostid){
      hostid=substr($2, 2, 2)
    }
  } else if($1=="clock-frequency:"){
    # convert clock frequency from hex to decimal
    pwr=1;
    clock=0;
    for(i=8;i&gt;0;i--){
      digit=substr($2, i, 1);
      if("a"==digit) digit=10;
      else if("b"==digit) digit=11;
      else if("c"==digit) digit=12;
      else if("d"==digit) digit=13;
      else if("e"==digit) digit=14;
      else if("f"==digit) digit=15;
      clock += digit*pwr;
      pwr *= 16;
    }
    if(!systemclock) systemclock=clock/M
  } else if($1=="ecache-line-size:" || $1=="cache-line-size:"){
    # again, hex to dec. If I was using nawk, I would make
    # this a function, but early SunOS is nawkless
    pwr=1;
    clinesize=0;
    for(i=8;i&gt;0;i--){
      digit=substr($2, i, 1);
      if("a"==digit) digit=10;
      else if("b"==digit) digit=11;
      else if("c"==digit) digit=12;
      else if("d"==digit) digit=13;
      else if("e"==digit) digit=14;
      else if("f"==digit) digit=15;
      clinesize += digit*pwr;
      pwr *= 16;
    }
  } else if($1=="ecache-nlines:" || $1=="cache-nlines:"){
    # again, hex to dec. If I was using nawk, I would make
    # this a function, but early SunOS is nawkless
    pwr=1;
    cnlines=0;
    for(i=8;i&gt;0;i--){
      digit=substr($2, i, 1);
      if("a"==digit) digit=10;
      else if("b"==digit) digit=11;
      else if("c"==digit) digit=12;
      else if("d"==digit) digit=13;
      else if("e"==digit) digit=14;
      else if("f"==digit) digit=15;
      cnlines += digit*pwr;
      pwr *= 16;
    }
  } else if($1=="name:"){
    # process name:
    # first, concatenate all the pieces
    name=$2
    for(i=3;i&lt;=NF;i++) name=name" "$i

    # strip off end quotes
    name = substr(name, 2, length(name)-2)

    # strip off leading "SUNW," if present
    if("SUNW,"==substr(name, 1, 5))
      name=substr(name, 6, length(name)-5)

    # strip off leading "Sun " if present
    if("Sun "==substr(name, 1, 4))
      name=substr(name, 5, length(name)-4)

    if(!systemname){
      # the first "name:" is the system name
      systemname = name
    }
  } else if($1=="device_type:"){
    if("cpu" == substr($2,2,3)){
      iscpu="yes"
      cpucount++
    }
  } else if($1=="Node"){
    if("yes"==iscpu){
      if(clock) {
        cpuclock=clock/M
      } else {
        cpuclock=systemclock
      }
      cpucache=clinesize*cnlines
      cpuname=name
    }
    iscpu="no"
    clock=0
  } else if($1=="banner-name:"){
    i=index($0, ":")+3;
    banner=substr($0, i+1, length($0)-i-1)
  }
}
END{
  # process last remaining cpu, if applicable
  if("yes"==iscpu){
      if(clock) {
        cpuclock=clock/M
      } else {
        cpuclock=systemclock
      }
      cpucache=clinesize*cnlines
      cpuname=name
  }

  if(0==cpucount) cpucount=1

  if(hostid&lt;"80" &amp;&amp; "72"!=hostid) {
    # look up hostid in table
    if(id[hostid]) {
      developname=devname[id[hostid]]
      modelname=model[id[hostid]]
      if (!cpuname) cpuname=cpu[id[hostid]]
      if (!systemname || systemname==modelname) systemname=sysname[id[hostid]]
      if (!cpuclock) cpuclock=clk[id[hostid]]
    }
  } else {
    # look up system name in table
    if(systemname) {
      if(nm[systemname]){
        developname=devname[nm[systemname]]
        modelname=model[nm[systemname]]
        if (!cpuname) cpuname=cpu[id[hostid]]
        if (!cpuclock) cpuclock=clk[id[hostid]]
      }
    }
  }
  if(!cpucount) cpucount=1
  # Compute known model names. 
  if("_MBUS" == modelname){
    # SS10/20/600: Ross 605 or SuperSPARC processors. 
    if(ROSS==ptype[cpuname]) {
      modelname=1""cpucount""0
    } else if("SuperSPARC"==ptype[cpuname]){
      if(cpucount==1) cpucount=""
      if(mtype[cpuclock]) {
        modelname=mtype[cpuclock]""cpucache/MB""cpucount
      } 
    }
    if("_MBUS" == modelname) modelname = "unknown"
  } else if("_SS5" == modelname || "_SS4" == modelname){
    # SPARCstation 4/5: modelname is simply the CPU clock rate
    modelname=cpuclock
  } else if ("_XDBUS" == modelname){
    # SPARCcenter 1000 or 2000.
    ccount=cpucount; if(ccount&lt;10) ccount="0"ccount
    modelname=substr(systemname,13,1)""cpucache/MB""ccount
  } else if (cpuname ~ /UltraSPARC.*/){
    if("Ultra-1"==systemname || "Ultra-5_10"==systemname){
       # modelname is clock speed rounded to nearest 10MHz.
       # modelname=10*sprintf "%d\n", ((cpuclock/10)+0.5)
       modelname=10*sprintf("%d\n", ((cpuclock/10)+0.5))
    } else {
       # modelname is number of cpus followed by clock speed rounded to
       # nearest 10MHz
       # modelname=cpucount""10*sprintf "%d\n", ((cpuclock/10)+0.5)
       modelname=cpucount""10*sprintf("%d\n", ((cpuclock/10)+0.5))
    }
  }

  if(!systemname) systemname="unknown"
  if(!modelname) modelname=systemname
  if(!developname) developname="unknown"
  if(!cpuname) cpuname="unknown"
  if(!cpuclock) cpuclock="unknown"

  if(ptype[cpuname]) cpuname=cpuname" ("ptype[cpuname]")"
  if(cpucache) {
    if(cpucache&gt;=MB) {
      cpucache=cpucache/MB" MB"
    } else {
      cpucache=cpucache/KB" KB"
    }
  }
  if(!systemclock) systemclock=cpuclock
  if("yes"==verbose){
    # output what we have discovered
    print "System name:", systemname
    print "Description:", banner
    print "Development name:", developname
    if("_NA"!=modelname) print "Model:", modelname
    print "Number of cpus:", cpucount
    print "Cpu name:", cpuname
    if(systemclock == cpuclock) {
      print "System/Cpu clock rate (MHz):", cpuclock
    } else {
      print "System clock rate (MHz):", systemclock
      print "Cpu clock rate (MHz):", cpuclock
    }
    if(cpucache) print "External cache:", cpucache
  } else {
    if("_NA"==modelname) {
      modelname=""
    } else {
      modelname=": "modelname
    }
    print systemname, modelname
  }
}
'</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2016-12-15 13:41:56</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>b9f5730c9f3322001d753758442e70f8</sys_id><sys_mod_count>1</sys_mod_count><sys_name>suntype.sh</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_b9f5730c9f3322001d753758442e70f8</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:23</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-156966567</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>ac230c7d41a231107f440d8147faed37</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e247690000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>suntype.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>caa001518be2311005b91c2d332071c8</update_guid>
<update_guid_history>caa001518be2311005b91c2d332071c8:-156966567,4aa0015162e2311091c35a2c6a7ef7c7:1107396883</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>pa_dashboards_98db0f8a0fc03010ce4d142386767e44</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="pa_dashboards"><pa_dashboards action="INSERT_OR_UPDATE"><active>true</active><breakdown_source/><color>#ffffff</color><disable_multiple_element>false</disable_multiple_element><group/><groups/><is_breakdown>false</is_breakdown><managed_breakdown/><managed_publisher/><name>Discovery Dashboard</name><no_tabs>true</no_tabs><notification_link_label/><notification_link_url/><notification_text/><order/><owner/><restrict_to_roles>pa_viewer,pa_contributor</restrict_to_roles><role_override>true</role_override><roles>itil</roles><should_migrate_permissions>false</should_migrate_permissions><sys_class_name>pa_dashboards</sys_class_name><sys_created_by>robert.dunlap</sys_created_by><sys_created_on>2021-05-12 19:30:16</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>98db0f8a0fc03010ce4d142386767e44</sys_id><sys_mod_count>2</sys_mod_count><sys_name>Discovery Dashboard</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>pa_dashboards_98db0f8a0fc03010ce4d142386767e44</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 16:18:55</sys_updated_on><users/><visible_to>2</visible_to></pa_dashboards></record_update>]]></payload>
<payload_hash>-1842913554</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>ac230c7d41a231107f440d8147faed3a</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd8eda9dc0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>Discovery Dashboard</target_name>
<type>Dashboard</type>
<update_domain>global</update_domain>
<update_guid>888386253222311041d3d7fc433e934a</update_guid>
<update_guid_history>888386253222311041d3d7fc433e934a:-1842913554,00838625b62231109cf38bbb7a9e1049:-1447529471</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da_u_configuration_item_1</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_configuration_item_1" table="u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da"><active>true</active><array>false</array><attributes>encode_utf8=false</attributes><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label>Configuration Item 1</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_configuration_item_1</element><element_reference>false</element_reference><foreign_database/><formula/><function_definition/><function_field>false</function_field><internal_type display_value="Reference">reference</internal_type><mandatory>false</mandatory><max_length>32</max_length><name>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference display_value="" name="cmdb_ci">cmdb_ci</reference><reference_cascade_rule>clear</reference_cascade_rule><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 00:15:10</sys_created_on><sys_id>d880f325416231107f440d8147faedc0</sys_id><sys_name>Configuration Item 1</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da_u_configuration_item_1</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:15:11</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><virtual_type/><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>-1608444262</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>ac230c7d41a231107f440d8147faed3d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bdaa1b3720000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</table>
<target_name>Critical Incidents with No Owner-Query Results.Configuration Item 1</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>f4803725a46231107fbf0d026e62f478</update_guid>
<update_guid_history>f4803725a46231107fbf0d026e62f478:-1608444262,948037257b6231103a1ee0f7ff15cf06:-863348078</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_1f86ad250bd2101088b90bdb35673acd</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>UqaeWN0mT/nWlp46ggc5yA==</checksum><description/><directory>false</directory><name>linux_ss_command.sh</name><parent display_value="ADME">ec515c705352320023bdae4a16dc3488</parent><script>#!/bin/sh&#13;
# Copyright © ServiceNow, Inc. 2020. All rights reserved.&#13;
BASE_DIR=$1&#13;
cp "${BASE_DIR}/connection_samples/all_connections.log" "${BASE_DIR}/connection_samples/all_connections_tmp.log"&#13;
#PID format $6 -  users:(("sshd",pid=18174,fd=3),("sshd",pid=18163,fd=3))&#13;
#LISTEN | filter :: | through awk -&gt; split $6 on ")," - loop through array - extract pid using substr - print 'on pid local_ip:port' | seperate ip:port | replace * with 0.0.0.0 | sort&#13;
sudo ss -tlnp | sed "s/pid=//g" | sed "s/fd=//g" | grep LISTEN | grep -v "::" | awk -F' ' '{ n = split($6,a,"\),"); for(i=1;i&lt;=n;i++) { split(a[i],b,","); print "on " b[2] " " $4}}' | sed 's/:/ /g' | sed 's/*/0.0.0.0/g' | sort | uniq &gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
sudo ss -tenp | sed "s/pid=//g" | sed "s/fd=//g" | grep ESTAB | grep users | awk -F' ' '{ n = split($6,a,"\),"); for(i=1;i&lt;=n;i++) { split(a[i],b,","); print "to " b[2] " " $5 " " $4}}'  | sed 's/::ffff://g' | sed 's/:/ /g' | sed 's/*/0.0.0.0/g' | sort | uniq &gt;&gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
cat "$BASE_DIR/connection_samples/connection_sample.log" "$BASE_DIR/connection_samples/all_connections_tmp.log" | sort &gt; "${BASE_DIR}/connection_samples/all_connections.log"</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>moiz.alibhayani</sys_created_by><sys_created_on>2020-07-29 02:56:45</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>1f86ad250bd2101088b90bdb35673acd</sys_id><sys_mod_count>2</sys_mod_count><sys_name>linux_ss_command.sh</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_1f86ad250bd2101088b90bdb35673acd</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:54</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-317161640</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>ac23c87d41a231107f440d8147faeddc</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3dfffaa0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>linux_ss_command.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>2110015d82a2311019e332a39faa78b2</update_guid>
<update_guid_history>2110015d82a2311019e332a39faa78b2:-317161640,6510cd1d17a2311047e5e3a0e9fcc5f6:980996629</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_4cf9fc95092231107f445d7a5f5e13a2</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>cl.app_store_registered</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:19:02</sys_created_on><sys_id>4cf9fc95092231107f445d7a5f5e13a2</sys_id><sys_mod_count>2</sys_mod_count><sys_name>cl.app_store_registered</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_4cf9fc95092231107f445d7a5f5e13a2</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:25:35</sys_updated_on><type>string</type><value>false</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=4cf9fc95092231107f445d7a5f5e13a2"/></record_update>]]></payload>
<payload_hash>-500475570</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>b0230c7d41a231107f440d8147faed40</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd404576d0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cl.app_store_registered</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>8f298d91b5a63110f4dfab65524130a5</update_guid>
<update_guid_history>8f298d91b5a63110f4dfab65524130a5:-500475570,7cd8c5514ba63110dc325150e93ef922:621181921,9cf930d534223110711e0fc798ed880a:293071326</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_f9f03ca50a0a0bb5658db64889d967cb</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description>Enable usage of a secure token to identify and validate incoming requests.  This token is used to prevent cross site request forgery attacks.</description><ignore_cache>false</ignore_cache><is_private>false</is_private><name>glide.security.use_csrf_token</name><read_roles>admin</read_roles><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>dloo</sys_created_by><sys_created_on>2010-06-02 18:33:10</sys_created_on><sys_id>f9f03ca50a0a0bb5658db64889d967cb</sys_id><sys_mod_count>2</sys_mod_count><sys_name>glide.security.use_csrf_token</sys_name><sys_package display_value="High Security Settings" source="com.glide.high_security">5b58ef9f9fa131107f44e6ca4224ab7f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_f9f03ca50a0a0bb5658db64889d967cb</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:25:29</sys_updated_on><type>boolean</type><value>true</value><write_roles>security_admin</write_roles></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=f9f03ca50a0a0bb5658db64889d967cb"/></record_update>]]></payload>
<payload_hash>172889559</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>b0230c7d41a231107f440d8147faed43</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd40440740000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>glide.security.use_csrf_token</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>25294d91b4a631100b28f57096f351ee</update_guid>
<update_guid_history>25294d91b4a631100b28f57096f351ee:172889559,ebd9f8959122311034f2d5dad97e59d1:-1684624424,d3d9f8957c223110907d8c1ec36e4489:172889559</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_c2b8cd1109a631107f445d7a5f5e137b</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>cl.uptime</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>trainingadmin</sys_created_by><sys_created_on>2023-11-15 17:23:37</sys_created_on><sys_id>c2b8cd1109a631107f445d7a5f5e137b</sys_id><sys_mod_count>122</sys_mod_count><sys_name>cl.uptime</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_c2b8cd1109a631107f445d7a5f5e137b</sys_update_name><sys_updated_by>trainingadmin</sys_updated_by><sys_updated_on>2023-11-16 23:33:34</sys_updated_on><type>string</type><value>1076000</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=c2b8cd1109a631107f445d7a5f5e137b"/></record_update>]]></payload>
<payload_hash>718119967</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>b4230c7d41a231107f440d8147faed42</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda7b9a190000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cl.uptime</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>8ff6ef65a422311022ddfc1db8cd17f4</update_guid>
<update_guid_history>8ff6ef65a422311022ddfc1db8cd17f4:718119967,e6d5e7256f2231102c8fc922f34475db:-850461482,3cb4afa1e722311011936857f88e3a3b:-1925689710,6b836b6125223110942d4f142c0d8be8:1854749136,ce036721252231102ccd50a0a3cfb500:1100716549,198b07e9e16631102f7b7bcdd1612ff5:1467947975,106a03a9b66631108358394f314e9f8a:673069636,b2390f295566311021da66d139be3251:-1390989780,c618c7e598663110eccc65f26215dced:-1625168341,54f6c3a51f6631107897fb4fbadce33e:1314220838,1bc5cf251e663110e17e9d5795c60723:-469488689,a2a48be180663110614408236a75c9ed:-984017139,0d8347a1d5663110eabc4f213a46a54d:-2059245367,2b52436120663110836029d194885f99:171662513,da310fed342631105870fe17bf2170c7:-903565715,8d100badb22631109265259ba0a3c12f:-1418094165,88fe366d212631106e210a82b1557317:2081994792,b3cdfee906263110dae604d0b0e424b4:-1563251991,a5acfaa9f52631107a25cf4cc86d3d71:-776942963,d08bf669d4263110ec04db69986ef167:-1571821302,3e5af22914263110e8af26fe4103e130:659086578,7539bea5a3263110d6981c51ae8a4392:-135791761,94187a65d32631101f9916582ae334fb:-1211019989,97e6762574263110878f56b1e582525c:1300237780,86c532e15c26311020b9fedcd492c3e7:225009552,e8a43e61542631102227f7713fdce95e:-569868787,9f733a2100263110d93d116525159b53:-1364747126,a65236ed18e231101835fccd24cacfa3:1146510643,3031fe6d49e231108ff493486188fcf6:71282415,e7003e2d1ee23110c37aaa9177d93426:-723595924,26eee6e956e23110c7442fdbede2145e:1787661845,1dcde2a9e5e23110ba462f12de11f165:992783506,4cacae2939e231102eac487ed12933f9:197905167,0f7baae51be23110372b41198dcbb463:-1585804360,655a66a5b4e231109c595d6c2cbbacca:1633934708,a439626561e231102e8f715df44f22f2:839056369,47082ae192e2311058668fc99f4a4fb0:-236171859,82e6e2a198e23110d3f931af1bd5a4e4:-335785987,dcc5ee216be2311068af747df8bc0927:-1411014215,d394aaedf7a23110fb0426374f70cd9d:-1925542665,3973a6ad5da2311001c3e60decab7d59:25015326,8552a26d9aa231107f48b451a0e40a0c:-489513124,7b212ee9dda23110987269d7bf10638c:-1284391463,16002aa956a231102936f1b4b2d41b26:946516417,c9eed2696ca2311057faac1dd7b13ce0:-128711811,80cd12295ba23110ee33687a6169bb10:-643240261,ea9cdaa525a2311098271c0ec551fc48:-1718468489,417b966520a231100273024b5c8872c8:512439391,1c5ad2255aa231109b8f37ebbe21e650:-2089059,4f29dea199a23110d7d2169775b2fa76:-796967398,21089a6132a2311032124898ec14bd9b:1153590593,6ce6962193a23110e5e6e025b70feb8f:358712254,afb552ed6f623110871bf6c2b91489c9:-155816196,31945e6d30623110f8b09247367b6ef5:1794741795,7473162d70623110c21fe5a2c5d507a3:1280213345,ff42dea987623110d8688f64140ad3cf:765684895,5a219669066231106c64367c019187f8:-309543333,7800dee536623110b8d903eeee9161ca:1641014658,efde86a56862311047466ddf77c1adac:846136319,eabd8e25a7623110e68498d7cd192008:331607869,959c46e195623110a0a3c3bcaf60a16b:-1732451547,087b4e6198623110d034a722a6aa4943:1767637410,724a462157623110fc15872b7a2f87e5:972759071,1d29ceadf022311020cb3dc9a26cf15c:-1371650234,d808c66d75223110b82b0fe57f5ce9d8:2128438723,87d6822d8f223110a468441eab032a47:1613910273,adb502a9002231104e8dee65e5de89d7:538682045,d0940a2912223110c723ac390f24e513:-1310249293,9c73ce252e223110ce914dba92467fd9:-1824777743,7313cee10a223110dd3ca6c29b523e60:1102194039,4ab1462197223110474767efc72a04c8:1100716549,ccf10a91f5aa3110151093713ee2d1ac:434351893,62c006514caa31105743a941aa9b9172:-360526446,ddaf311194aa3110311124d41a2a997d:-1155404785,808e3d9d6d6a31107d23d09421aa03a8:-1950283124,fa5d395daf6a31102d0adaf8a8c7c221:280624756,bd3cf11d6f6a31102fa7ee68a5caf9b7:-514253583,641bfd99406a31107e891ca77bd20b46:-1309131922,3ee9b959076a3110dfc090ca89acc093:641426069,a1c8b519766a311001b36f7efcf1efc8:-153452270,7ca7b1d5366a31105d8968c7251eb261:-667980720,53767d55186a31101c91d55c70d3b7ce:1282577271,5a553915286a3110b3ab325372c66eb5:768048821,013435d1276a3110083fe7eb568a3de0:-26829518,8813fd51966a3110d4c87a708c1cbcf5:-821707857,66e1f911fe6a3110da714879a16a66d8:1409200023,d5c0f5ddc52a3110644fb2f59777c7b7:311235957,80afe19de62a3110efe4e09c68efac46:-180556655,667ead1d3e2a3110bc2840eb82f679df:-560520672,d55d69d9312a31100a0900a2de1eeb7a:-1635748900,583c6599912a3110a9473cacb0114613:2144689946,fe0b6159de2a3110d173b6838c54d721:80630530,b1e92dd5eb2a3110bafe0e39f868de49:-714247809,a4c82995c22a3110eb59ae16f6d58757:-1509126148,df97e155172a31107ad47a161c9afc15:1990962809,8676edd1bc2a31103ba24fef075dfb6e:-73096607,8555a991a32a31103c06711ca3f8828f:-867974946,1724a551232a3110ee3dcb3c326e04e6:-1943203174,0603a111662a311050b33a364631388d:287704706,7ce16d9d04e6311044f842be2874a3a2:-507173633,a7b0695d27e63110182588c573596c66:-1302051972,1a9f551d6de63110d6b26ccb2e60f357:928855908,017e11d968e63110138d6dd3399d4d5d:133977569,d45d1d5957e63110e2c8c94da8435663:-380550881,f62cd519f3e6311061e04d5a17b569e6:-1175429220,b50bd1d504e63110d195e528bc084bf8:1055478660,44e99d5592e63110c3acc7b7bc4e4fcc:-19749568,93b8d9151ae63110bb8387e19b88c748:-534278018,8a97d1d1d2e631104bb36735643268c5:1696629862,f076dd5151e631102893717551759582:901751523,6f45d91112e6311071868900ad116d16:106873184,8624d5dd9ba63110cc0edf39ad15635f:2057431175,b403919d7ea63110e89c86a7d6353d6a:1262552836,2fd19d1d4ca63110a24ea47966e20e70:467674497,6ab059d97ca631103d9b4f273758f8ca:-46853953,c99f4599cda63110e2b92a4438d7c10c:1903704038,eb6ecd19c2a631105389350bede0f1da:1108825699,ee4dc9d5d3a631104e0250e699d49f82:594297249,5d2cc59513a63110ce0f20c6794e0174:-1534983978,e80bc155e5a63110f42c550afb497849:-2049512428,13d9c9d1dca631104ccc33d7c92ac1cb:1427840691,29d8c551faa6311056745dd5d54ffecb:-2097358047,92b8cd118ba631106009d8558d3e4a81:-1039107900</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_user_role_70f4851d092631107f445d7a5f5e13d4</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_user_role"><sys_user_role action="INSERT_OR_UPDATE"><assignable_by/><can_delegate>true</can_delegate><description/><elevated_privilege>false</elevated_privilege><grantable>true</grantable><includes_roles/><name>project_user</name><requires_subscription>-1</requires_subscription><scoped_admin>false</scoped_admin><suffix/><sys_class_name>sys_user_role</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 17:07:09</sys_created_on><sys_id>70f4851d092631107f445d7a5f5e13d4</sys_id><sys_mod_count>0</sys_mod_count><sys_name>project_user</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_user_role_70f4851d092631107f445d7a5f5e13d4</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:07:09</sys_updated_on></sys_user_role></record_update>]]></payload>
<payload_hash>724764918</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>b4230c7d41a231107f440d8147faed45</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3f375060000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>project_user</target_name>
<type>Role</type>
<update_domain>global</update_domain>
<update_guid>fcf4851df42631102efd4043b8026cd7</update_guid>
<update_guid_history>fcf4851df42631102efd4043b8026cd7:724764918</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_9ce93c95092231107f445d7a5f5e13da</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>cl.event.auth</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:18:47</sys_created_on><sys_id>9ce93c95092231107f445d7a5f5e13da</sys_id><sys_mod_count>1</sys_mod_count><sys_name>cl.event.auth</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_9ce93c95092231107f445d7a5f5e13da</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:24:05</sys_updated_on><type>string</type><value>ke8&amp;a50tiHD7</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=9ce93c95092231107f445d7a5f5e13da"/></record_update>]]></payload>
<payload_hash>275646438</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>b8230c7d41a231107f440d8147faed41</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd402f6510000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cl.event.auth</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>f8d8c551bca631102a362b0c8b1c8d51</update_guid>
<update_guid_history>f8d8c551bca631102a362b0c8b1c8d51:275646438,74e97c955d22311006670a93adb68d07:-174603549</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_section_42354e29e42231107f443c8410589ecd</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_ui_section caption="" section_id="42354e29e42231107f443c8410589ecd" sys_domain="global" table="cmdb_group_contains_encoded_query" version="3" view=""><sys_ui_element action="INSERT_OR_UPDATE"><element>group</element><position>0</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 16:26:26</sys_created_on><sys_id>ca35c669e42231107f443c8410589eb2</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="cmdb_group_contains_encoded_query" sys_domain="global" view="Default view">42354e29e42231107f443c8410589ecd</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 16:26:26</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>class</element><position>1</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 16:26:26</sys_created_on><sys_id>8235c669e42231107f443c8410589eb3</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="cmdb_group_contains_encoded_query" sys_domain="global" view="Default view">42354e29e42231107f443c8410589ecd</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 16:26:26</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>simple_condition</element><position>2</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 16:26:26</sys_created_on><sys_id>0635c669e42231107f443c8410589eb3</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="cmdb_group_contains_encoded_query" sys_domain="global" view="Default view">42354e29e42231107f443c8410589ecd</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 16:26:26</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>condition</element><position>3</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 16:26:26</sys_created_on><sys_id>8635c669e42231107f443c8410589eb3</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="cmdb_group_contains_encoded_query" sys_domain="global" view="Default view">42354e29e42231107f443c8410589ecd</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 16:26:26</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>sys_domain</element><position>4</position><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 16:26:26</sys_created_on><sys_id>0a35c669e42231107f443c8410589eb3</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="cmdb_group_contains_encoded_query" sys_domain="global" view="Default view">42354e29e42231107f443c8410589ecd</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 16:26:26</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_section action="INSERT_OR_UPDATE"><caption/><header>false</header><name>cmdb_group_contains_encoded_query</name><roles/><sys_class_name>sys_ui_section</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 16:26:25</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>42354e29e42231107f443c8410589ecd</sys_id><sys_mod_count>0</sys_mod_count><sys_name>cmdb_group_contains_encoded_query</sys_name><sys_overrides/><sys_package display_value="CMDB Group" source="com.snc.cmdb.group">44966bd79fa131107f44e6ca4224ab4c</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_section_42354e29e42231107f443c8410589ecd</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 16:26:25</sys_updated_on><sys_user/><title>true</title><view display_value="Default view" name="NULL">Default view</view><view_name/></sys_ui_section></sys_ui_section></record_update>]]></payload>
<payload_hash>484687921</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>b8230c7d41a231107f440d8147faed44</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd8f4889f0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>cmdb_group_contains_encoded_query</table>
<target_name>CMDB Group Contains Encoded Query</target_name>
<type>Form Layout</type>
<update_domain>global</update_domain>
<update_guid>8e35c669082231102f6f5ba60f44d6b4</update_guid>
<update_guid_history>8e35c669082231102f6f5ba60f44d6b4:484687921,0a354e295a2231109c3f02a0af8a40d0:1354912271</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_8693e39f9f2131107f44e6ca4224ab65</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description>Instance ID</description><ignore_cache>false</ignore_cache><is_private>true</is_private><name>instance_id</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-10-03 16:45:20</sys_created_on><sys_id>8693e39f9f2131107f44e6ca4224ab65</sys_id><sys_mod_count>2</sys_mod_count><sys_name>instance_id</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_8693e39f9f2131107f44e6ca4224ab65</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:18:54</sys_updated_on><type>string</type><value>68d57c1993263d94ba92fc0d6cba1016</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=8693e39f9f2131107f44e6ca4224ab65"/></record_update>]]></payload>
<payload_hash>612374593</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>bc230c7d41a231107f440d8147faed40</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3c748ad0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>instance_id</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>0ee9bc9513223110130409f65f146257</update_guid>
<update_guid_history>0ee9bc9513223110130409f65f146257:612374593,8ae97c95ca22311088a3d2e41c365de1:244441120</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_fed9b895092231107f445d7a5f5e13f7</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>false</ignore_cache><is_private>false</is_private><name>instance_configurator</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:18:41</sys_created_on><sys_id>fed9b895092231107f445d7a5f5e13f7</sys_id><sys_mod_count>112</sys_mod_count><sys_name>instance_configurator</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_fed9b895092231107f445d7a5f5e13f7</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:25:37</sys_updated_on><type>string</type><value>Complete</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=fed9b895092231107f445d7a5f5e13f7"/></record_update>]]></payload>
<payload_hash>1747012467</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>bc230c7d41a231107f440d8147faed43</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd40460f90000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>instance_configurator</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>2729cd911da6311027c438523f9a0819</update_guid>
<update_guid_history>2729cd911da6311027c438523f9a0819:1747012467,cd294d914ca63110400910960e838634:-88519207,b8290d914ba631108ef9920abb3f4efd:-55390843,d0290d91b5a631107b7203d2600a4e78:-474780210,76198991fea63110abcc1d718be9ffae:1736747628,8619899134a63110749ffe74df55be16:112000756,3c19099148a631103e0ba8e02a3ef38c:-1407513491,581909912ca63110822e4fab9dbc1d0b:799360706,cc19c591eea63110437f9089f147537f:-1069402994,a309c5911ea631103d527d4d768c3405:1147426049,1309859124a631109382f7e8b70be6da:2095672145,020945918aa631108468ee28da66be9a:758954573,4e09459100a6311067b8b5f2cdd0b25f:1686222987,5bf8419132a63110fbf657676ce348ff:-914368005,4ff841911aa631109deefb0e67f367ad:636597250,35e80d51c6a63110b2c31eb5ed77580a:-1673985514,dde8c95199a6311000bd761dcad14085:-1599407395,98e8895120a631104fa13a12dd73c63a:564745591,bfd8495194a63110bdb3c3fe22c793b2:882714238,3ad80951d3a63110fc8c8fb0290878b8:2054124835,e6d80951b8a63110766891fbe32e1a32:-973748996,dad8c55178a6311010d68b3aaa69b2fd:670770927,d0d88551cca63110db18a7d4dc7433b1:520334113,bfc84551efa631103787603af1bf0ae2:-959708436,fec8455184a63110b63c2e4b04595a6a:172871197,16c8055132a631106f6a62d1be73cbc3:-432970655,38c8815107a631102fb7e016634b748e:408165630,58c841518ea63110e5e21db871380267:181102103,00c84151e3a631100cf6420146b6c30d:895593332,63b80151c8a63110678549367a46d8f1:115700799,9eb8cd11fda63110af9d9d83e46e63d2:-167758531,91b88d115da631101362efbc15c729d9:-1127260947,acb84d115aa63110b8d7241ae59abbb9:839113347,ccb84d11b2a6311058bbb6ad830fe08f:-1338401294,c0b84d11cca6311067d99157792dd556:1862609253,e7a84d1149a6311036a2256a295dbc1a:666345491,d3a80d1169a6311024b506c020cd64e0:-706767301,e2a8c911f7a6311024076a13954e5fdd:-1132256810,82a8c91194a63110ad05a8f52fb77f61:-610365859,c6788ddd3e6631102c16aad86125b650:-1628762066,c1784dddbd663110589473fdde11906b:624292469,f268c9dde2663110a79c7d726ea59118:-1090943623,ea6889dd76663110d32dde4ec86f9e6c:-772974976,ca6889dde3663110c727a25559b2c136:-1389240245,fd6849dd81663110af09f3daa1e806b6:-456091650,196809ddfe663110dfe2f5a7ff7c36a3:-2066064938,f758c5dd596631101f7fce3a5b265496:1600162186,8f58c5dd2b663110ea3acab9f1079f55:1260732334,ce5885ddd2663110bb6268949ab9bc2a:1351107162,2748c1dde3663110310e446d00fac43d:-1517257415,434881dd646631107a5e0a40160596ea:1340949824,2848cd9d07663110150fd5a399262233:2026382922,43388d9dd8663110d42dda76f4e26826:-1001490909,e228099dbe6631107c4900d46b51557b:-1883654783,0928859df2663110dfcf10ccfa2f4262:1949323418,6b18459d65663110767379f0e98ce534:135209360,8517c159f9663110b5ed6e05150eacb2:202395200,a4178159d4663110bf1f6426f54eb4c2:-1205619661,b0e4811db426311096a9e9a3d6180240:489477924,98e4411d9e263110dd8f7c4ac700de50:739302869,9fd4011dcb26311031a703c616f7a9c5:-732131769,87d4011d64263110953eee8d6b44b220:1204633561,aed4cdd94d263110673616ca82654ea4:-560942353,dad48dd98e2631102cf7a19a426fd2ea:-2012848682,9dd48dd992263110a19817face2eda7f:1255969131,f8d48dd921263110fbbdb2dcbde6e41d:-187228981,a0d44dd91d263110175c6ebd850d3faa:298267406,1cd44dd9622631102db4d6ae6358091e:1408989059,77c40dd96d263110b15d82315a920dba:-2001563587,57c40dd91b2631102a3e3133e9ebbc5f:-1603360410,0bc4c9d97126311017f4bf62fd2d45b9:13935610,e2c4c9d98b2631107fdc0992a8129454:1791210242,12c489d9ab263110a15bdc519b2a7ef9:1296553437,b5c489d9c326311075f4a248f8a5bbb7:-1482728589,a9c489d98a26311049dc30843b5d1434:-2079335281,91c449d99326311086862621022558e6:-661521616,fcc449d9d126311038a81a3077731e02:537319110,ebb409d96026311088c157bba012fa1c:1044136986,43b4c5d9222631108e58a683943e7d3f:-556762301,0eb485d9a0263110ed50f14161d19fb1:476306985,b8b405d9882631101d9ea10ece258efd:1664500577,5cb405d9ba26311023a1550cdd2a1454:-617774426,f6a4c1d9042631105042ab192e65fb26:394957485,8aa441d9c726311063f370106f31e0ea:-2020911426,3ca401d927263110c34a552d248586cf:-699123926,4ca4cd99b82631104354290b0550e87c:-113476890,c7948d99ed263110c8585682093acebd:-458638078,fe944d995f263110ee1661747c472afe:-1207558301,4a944d99db263110923f8878a86cd17c:-483989766,29940d995c26311047e487803a6896be:-2068026345,0d940d9929263110f2c2cc11282f534b:-1712346147,a894c999f82631106a211a081b6ebb99:-1140903209,6384899951263110d5a4c04cd056c5ca:350657248,8f848999d22631100e162de465bb5111:-1453290822,298409996b26311076a6fdfc4afad060:-504605028,c4848599f7263110e6ee483a5394748f:-250504392,eb7485995c263110c744ca14268db80c:222889215,4f7445990526311059f126f967dcfd66:-1402524865,de740599ea26311083a549c2e6821278:1701653805,0274c199f52631104e9a7875832986e3:1664086050,c57481992e26311014ff5eeb488d2ece:1929771170,08744199a9263110fc501770c10cc8a4:715578283,cf640199c0263110e1eb209d61cb0d38:-1908179361,3e540959ef26311061d1f2bfc88f9f77:1708920223,7954c5591b2631101dad3adbd2637e2a:-1487591706,14444d1935263110656d0bb2730d03ae:-1043772838,5b34c919ab26311095f720041502fdcd:-315762765,92148dd5aa263110d71f9945a93673f0:-2076026621,0c144dd5a6263110ca8447333eef3e49:629051868,a2040dd5f62631104072f35fd1a4fa2e:1611255918,897ab059702231101edb2b9386eeaca2:-625451008,27e9fc954f22311023fac56529f98275:-1372634664,1bd9f8955a2231109c51f424c89e6785:-2068300475</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_5552bfb173700010d4c1b7385ef6a7e3</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>OpYz0CdkQn9mlVkSUd6Agw==</checksum><description>Module that contains functions for enforcing folder permissions</description><directory>false</directory><name>SecureTempFolder.psm1</name><parent display_value="PowerShell">ef89e4fc372001006b882d465abe5d60</parent><script>&lt;#&#13;
 # 1. Obtain discoveryUser through service lookup if user not provided&#13;
 # 2. Normalize discoveryUser&#13;
 # 3. Append discoveryUser to parentFolder path&#13;
 # 4. Create folder at full path if it does not exist&#13;
 # 5. Lock down folder if $secureFolder is $true&#13;
 #&gt;&#13;
function createAndSecureFolderForUser {&#13;
    param([string]$folder, [string]$discoveryUser, [string]$serviceName, [boolean]$secureFolder)&#13;
&#13;
    if ($secureFolder) {&#13;
        # 1. Obtain discoveryUser through service lookup if user not provided&#13;
        # 2. Normalize discoveryUser&#13;
        $discoveryUser = getNormalizedUser -discoveryUser $discoveryUser -serviceName $serviceName&#13;
&#13;
        # 3. Append normalized discoveryUser to parentFolder path&#13;
        $folder = Join-Path -Path $folder -ChildPath $discoveryUser&#13;
    }&#13;
    # 4. Create folder at full path if it does not exist&#13;
    # 5. Lock down folder if $secureFolder is $true&#13;
    if (createFolder -folder $folder -secureFolder $secureFolder) {&#13;
        return $folder&#13;
    }&#13;
}&#13;
&#13;
function getNormalizedUser {&#13;
    param([string]$discoveryUser, [string]$serviceName)&#13;
    if (-not $discoveryUser) {&#13;
        # Obtain discoveryUser through service lookup if user not provided&#13;
        $discoveryUser = getServiceAccountUser -serviceName $serviceName&#13;
        if (-not $discoveryUser) {&#13;
            SNCLog-DebugInfo "Could not obtain MID service user from service with the name $serviceName"&#13;
            return&#13;
        }&#13;
    }&#13;
&#13;
    # Normalize discoveryUser&#13;
    $discoveryUser = normalizeDiscoveryUser -discoveryUser $discoveryUser&#13;
&#13;
    return $discoveryUser&#13;
}&#13;
&#13;
function getServiceAccountUser {&#13;
    param([string] $serviceName)&#13;
&#13;
    SNCLog-DebugInfo "Looking for service name $serviceName"&#13;
&#13;
    $service = Get-WmiObject "win32_service" -filter "Name='$serviceName'"&#13;
&#13;
    if (!$service) {&#13;
        SNCLog-DebugInfo "Cannot find service with name $serviceName. Aborting."&#13;
        return $null&#13;
    }&#13;
&#13;
    $logOnAsUser = $service.StartName;&#13;
    SNCLog-DebugInfo "Log on as user detected as $logOnAsUser"&#13;
&#13;
    return $logOnAsUser&#13;
}&#13;
&#13;
function createFolder {&#13;
    param([string]$folder, [boolean]$secureFolder)&#13;
&#13;
    if (Test-Path -Path $folder -PathType Container) {&#13;
        SNCLog-DebugInfo "$folder already exists, will not create folder"&#13;
        # no need to lock down folder if it already exists&#13;
        # can assume that it is already locked down, or doesn't need locking down&#13;
        return $true&#13;
    }&#13;
&#13;
    SNCLog-DebugInfo "Creating folder $folder"&#13;
    # create folder since it does not exist&#13;
    try {&#13;
        $null = New-Item -Path $folder -ItemType 'directory' -Force -ErrorAction Stop&#13;
    } catch {&#13;
        SNCLog-DebugInfo "Could not create folder using 'New-Item -Path $folder -ItemType 'directory' -Force -ErrorAction Stop'"&#13;
        return $false&#13;
    }&#13;
&#13;
    if ($secureFolder) {&#13;
        SNCLog-DebugInfo "Enforcing permissions on $folder"&#13;
        # lock down folder&#13;
        return enforcePerms -folder $folder&#13;
    }&#13;
    return $true&#13;
}&#13;
&#13;
&#13;
&lt;##&#13;
 # PowerShell module that contains functions to enforce stricter file permissions on the&#13;
 # temp folder on target Windows servers used by the WMIProvider.&#13;
 #&#13;
 # For the "temp" folder and its sub-folders, the access control entries (or ACEs) are restricted&#13;
 # to a whitelist of these groups:&#13;
 #   - SYSTEM&#13;
 #   - Builtin/Administrators (local Administrators)&#13;
 #   - if applicable, the specific Discovery user&#13;
 #&gt;&#13;
function enforcePerms {&#13;
    param([string]$folder)&#13;
    &#13;
    # ensure that on error, the script continues&#13;
    $ErrorActionPreference = "Continue"&#13;
&#13;
    if (-not (Test-Path $folder -PathType Container)) {&#13;
        SNCLog-DebugInfo "Cannot locate folder: $folder"&#13;
        return&#13;
    }&#13;
&#13;
    # define the white list, dynamically.  using an ArrayList is better for memory&#13;
    $whiteList = [System.Collections.ArrayList]@()&#13;
    $whiteList.Add("NT AUTHORITY\SYSTEM") &gt; $null&#13;
    $whiteList.Add("BUILTIN\Administrators") &gt; $null&#13;
    $whiteList.Add("CREATOR OWNER") &gt; $null&#13;
    $GROUP_WHITELIST = $whiteList.ToArray()&#13;
&#13;
    SNCLog-DebugInfo "Creating new ACL object"&#13;
    $acl = New-Object System.Security.AccessControl.DirectorySecurity&#13;
&#13;
    SNCLog-DebugInfo "Disabling inheritance on new ACL"&#13;
    $acl.SetAccessRuleProtection($true, $false)&#13;
&#13;
    foreach ($user in $GROUP_WHITELIST) {&#13;
        SNCLog-DebugInfo "Adding full control access rule for user $user"&#13;
        $perm = $user, 'FullControl', 'ContainerInherit, ObjectInherit', 'None', 'Allow'&#13;
        $rule = New-Object -TypeName System.Security.AccessControl.FileSystemAccessRule -ArgumentList $perm&#13;
        $acl.AddAccessRule($rule)&#13;
    }&#13;
&#13;
    SNCLog-DebugInfo "Applying new ACL to folder $folder"&#13;
    $acl | Set-ACL $folder&#13;
    return $true&#13;
}&#13;
&#13;
function normalizeDiscoveryUser {&#13;
    param([string] $discoveryUser = $(throw 'The discoveryUser parameter is required.'))&#13;
    SNCLog-DebugInfo "Discovery user is $discoveryUser"&#13;
    $userAtDomainRegex = [regex] '(\S+)@(\S+)'&#13;
    if ($discoveryUser.startsWith(".\")) {&#13;
        $hostname = hostname&#13;
        # replace the "." with the hostname&#13;
        $discoveryUser = $discoveryUser.replace(".\", "$hostname\")&#13;
        SNCLog-DebugInfo "Swapping hostname of localhost. Discovery user is now $discoveryUser"&#13;
    } else {&#13;
        $match = $userAtDomainRegex.Match($discoveryUser)&#13;
        if ($match.Success) {&#13;
            $domain = $match.Groups[2].Value&#13;
            $user = $match.Groups[1].Value&#13;
            $discoveryUser = "$domain\$user"&#13;
            SNCLog-DebugInfo "Normalizing user@domain username. Discovery user is now $discoveryUser"&#13;
        }&#13;
    }&#13;
    $discoveryUser = $discoveryUser -replace '\\', '_'&#13;
    SNCLog-DebugInfo "Replaced '\' with '_'. Discovery user is now $discoveryUser"&#13;
&#13;
    return $discoveryUser&#13;
}</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>benjamin.phan</sys_created_by><sys_created_on>2019-10-30 21:54:20</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>5552bfb173700010d4c1b7385ef6a7e3</sys_id><sys_mod_count>12</sys_mod_count><sys_name>SecureTempFolder.psm1</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_5552bfb173700010d4c1b7385ef6a7e3</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:55</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-1966843589</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>e0230c7d41a231107f440d8147faed36</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e003880000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>SecureTempFolder.psm1</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>7110015dc2a23110dc13d465ef889ae5</update_guid>
<update_guid_history>7110015dc2a23110dc13d465ef889ae5:-1966843589,fd10015d07a23110a8f9cfbbeb7290e3:-2085779251</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_e34019717f123100ed1c3b19befa91f2</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>XVDr9NeuclzdDfbAk0vIvw==</checksum><description/><directory>false</directory><name>trace_port.d</name><parent display_value="SSHScriptFiles">48deb961ff123100ab8fffffffffff07</parent><script>#pragma D option quiet&#13;
#pragma D option switchrate=10hz&#13;
#pragma D option dynvarsize=2000000&#13;
&#13;
#define BSWAP_8(x)      ((x) &amp; 0xff)&#13;
#define BSWAP_16(x)     ((BSWAP_8(x) &lt;&lt; 8) | BSWAP_8((x) &gt;&gt; 8))&#13;
#define BSWAP_32(x)     ((BSWAP_16(x) &lt;&lt; 16) | BSWAP_16((x) &gt;&gt; 16))&#13;
#define BSWAP_64(x)     ((BSWAP_32(x) &lt;&lt; 32) | BSWAP_32((x) &gt;&gt; 32))&#13;
&#13;
inline unsigned char OPT_port    = $1;&#13;
 &#13;
BEGIN&#13;
{&#13;
	printf("%17s%6s%6s%10s%10s%10s%5s %-16s %-16s\n", "PROC", "PID", "UID", "ZONE", "LPORT", "RPORT", "TYPE", "SOURCE", "TARGET");&#13;
}&#13;
 &#13;
&#13;
fbt:ip:tcp_send_data:entry&#13;
{&#13;
	/* Get LPort details */&#13;
	dig1 = (unsigned int) args[0]-&gt;tcp_tcph-&gt;th_lport[0];&#13;
	dig2 = (unsigned int) args[0]-&gt;tcp_tcph-&gt;th_lport[1];&#13;
	dig1 = dig1&lt;&lt;8;&#13;
	self-&gt;lport = dig1 + dig2;&#13;
	/* Get RPort details */&#13;
	dig1 = (unsigned int) args[0]-&gt;tcp_tcph-&gt;th_fport[0];&#13;
	dig2 = (unsigned int) args[0]-&gt;tcp_tcph-&gt;th_fport[1];&#13;
	dig1 = dig1&lt;&lt;8;&#13;
	self-&gt;rport = dig1 + dig2;&#13;
	/* Get Source Address */&#13;
	ipAddress = (unsigned int) args[0]-&gt;tcp_ipha-&gt;ipha_dst;&#13;
	self-&gt;octect[0] = ipAddress &gt;&gt; 0*8 &amp; 0xFF;&#13;
	self-&gt;octect[1] = ipAddress &gt;&gt; 1*8 &amp; 0xFF;&#13;
	self-&gt;octect[2] = ipAddress &gt;&gt; 2*8 &amp; 0xFF;&#13;
	self-&gt;octect[3] = ipAddress &gt;&gt; 3*8 &amp; 0xFF;&#13;
&#13;
	lipAddress = (unsigned int) args[0]-&gt;tcp_ipha-&gt;ipha_src;&#13;
	self-&gt;octect[4] = lipAddress &gt;&gt; 0*8 &amp; 0xFF;&#13;
	self-&gt;octect[5] = lipAddress &gt;&gt; 1*8 &amp; 0xFF;&#13;
	self-&gt;octect[6] = lipAddress &gt;&gt; 2*8 &amp; 0xFF;&#13;
	self-&gt;octect[7] = lipAddress &gt;&gt; 3*8 &amp; 0xFF;&#13;
&#13;
	self-&gt;ok = 1;&#13;
}&#13;
 &#13;
 &#13;
fbt:ip:tcp_send_data:entry&#13;
/ self-&gt;ok &amp;&amp; self-&gt;lport == OPT_port &amp;&amp; pid != 0 || OPT_port == 0  /&#13;
{&#13;
 	printf("%17s %6d %6d %20s %10d %10d %5s %d.%d.%d.%d  %d.%d.%d.%d\n", execname, pid, uid, zonename, self-&gt;lport, self-&gt;rport, "TCP",&#13;
 	        self-&gt;octect[0], self-&gt;octect[1], self-&gt;octect[2], self-&gt;octect[3],&#13;
 	        self-&gt;octect[4], self-&gt;octect[5], self-&gt;octect[6], self-&gt;octect[7]);&#13;
}&#13;
 &#13;
fbt:ip:tcp_send_data:return&#13;
{&#13;
	self-&gt;ok = 0;&#13;
    self-&gt;lport = 0;&#13;
	self-&gt;rport = 0;&#13;
	self-&gt;octet[0] = 0;&#13;
	self-&gt;octet[1] = 0;&#13;
	self-&gt;octet[2] = 0;&#13;
	self-&gt;octet[3] = 0;&#13;
	self-&gt;octet[4] = 0;&#13;
	self-&gt;octet[5] = 0;&#13;
	self-&gt;octet[6] = 0;&#13;
	self-&gt;octet[7] = 0;&#13;
	self-&gt;octet[8] = 0;&#13;
}&#13;
</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2015-02-18 10:00:15</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>e34019717f123100ed1c3b19befa91f2</sys_id><sys_mod_count>1</sys_mod_count><sys_name>trace_port.d</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_e34019717f123100ed1c3b19befa91f2</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:24</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-434894901</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>e0230c7d41a231107f440d8147faed39</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e248200000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>trace_port.d</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>c6a0015176e2311020548bf646347dd2</update_guid>
<update_guid_history>c6a0015176e2311020548bf646347dd2:-434894901,46a0015122e2311002330164b10bf4d1:745449864</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_authentication_policy_criteria_m2m_547e53c0c7322010df1417b703c2601e</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_authentication_policy_criteria_m2m"><sys_authentication_policy_criteria_m2m action="INSERT_OR_UPDATE"><policy display_value="Step-Up MFA Policy">163ad1d373512010616ca9843cf6a789</policy><sys_auth_filter_criteria display_value="Role Based MFA">c326b116c7312010df1417b703c2601d</sys_auth_filter_criteria><sys_created_by>admin</sys_created_by><sys_created_on>2021-03-05 12:25:18</sys_created_on><sys_id>547e53c0c7322010df1417b703c2601e</sys_id><sys_mod_count>1</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2021-06-08 08:37:02</sys_updated_on><used>true</used></sys_authentication_policy_criteria_m2m></record_update>]]></payload>
<payload_hash>1341432503</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>e0230c7d41a231107f440d8147faed3c</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3ff55ff0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>c326b116c7312010df1417b703c2601d</target_name>
<type>List of filter criteria</type>
<update_domain>global</update_domain>
<update_guid>b6e7415d0666311037bceeac84e4abf1</update_guid>
<update_guid_history>b6e7415d0666311037bceeac84e4abf1:1341432503</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_1fd4011d092631107f445d7a5f5e13c8</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>false</ignore_cache><is_private>false</is_private><name>snc.clabs.mid_server</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 17:06:47</sys_created_on><sys_id>1fd4011d092631107f445d7a5f5e13c8</sys_id><sys_mod_count>0</sys_mod_count><sys_name>snc.clabs.mid_server</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_1fd4011d092631107f445d7a5f5e13c8</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:06:47</sys_updated_on><type>string</type><value>true</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=1fd4011d092631107f445d7a5f5e13c8"/></record_update>]]></payload>
<payload_hash>-1810434704</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>e0230c7d41a231107f440d8147faed3f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3f326210000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>snc.clabs.mid_server</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>3fd4011d792631103317436a0b97bcf5</update_guid>
<update_guid_history>3fd4011d792631103317436a0b97bcf5:-1810434704</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_40aeb6295312320023bdae4a16dc349d</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>K40q6lMMcCFvVjuFPcKxpw==</checksum><description/><directory>false</directory><name>aix_lsof_command.sh</name><parent display_value="ADME">ec515c705352320023bdae4a16dc3488</parent><script>#!/bin/sh&#13;
# Copyright © ServiceNow, Inc. 2017. All rights reserved.&#13;
&#13;
BASE_DIR=$1&#13;
cp "${BASE_DIR}/connection_samples/all_connections.log" "${BASE_DIR}/connection_samples/all_connections_tmp.log"&#13;
sudo lsof -iTCP -n -P | grep 'LISTEN' | grep -v "::" | awk -F' ' '{print "on " $2 " " $9}' | sed 's/:/ /g' | sort | uniq &gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
sudo lsof -iTCP -n -P | grep 'ESTABLISHED' | grep -v "::" |  sed 's/-&gt;/ /g' | awk -F' ' '{print "to " $2 " " $10 " " $9}' | sed 's/:/ /g' | sort | uniq &gt;&gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
cat "${BASE_DIR}/connection_samples/connection_sample.log" "${BASE_DIR}/connection_samples/all_connections_tmp.log" | sort &gt; "${BASE_DIR}/connection_samples/all_connections.log"</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>evan.qu</sys_created_by><sys_created_on>2017-04-23 08:07:59</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>40aeb6295312320023bdae4a16dc349d</sys_id><sys_mod_count>6</sys_mod_count><sys_name>aix_lsof_command.sh</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_40aeb6295312320023bdae4a16dc349d</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:55</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>1278414148</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>e023c87d41a231107f440d8147faedde</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e0028d0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>aix_lsof_command.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>3910015d4ea23110e75d00971da3e3cb</update_guid>
<update_guid_history>3910015d4ea23110e75d00971da3e3cb:1278414148,ed10015d40a2311085b048d40bf537bd:273980387</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_d1efb6695312320023bdae4a16dc3484</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>rJJFSNiHFMgqWA3jEZnGmg==</checksum><description/><directory>false</directory><name>solaris_lsof_command.sh</name><parent display_value="ADME">ec515c705352320023bdae4a16dc3488</parent><script>#!/bin/sh&#13;
# Copyright © ServiceNow, Inc. 2017. All rights reserved.&#13;
&#13;
BASE_DIR=$1&#13;
ZONENAME=$2&#13;
ZONECMD=/usr/bin/zonename&#13;
LSOF="lsof"&#13;
&#13;
if command -v lsof&#13;
then&#13;
    LSOF=`command -v lsof`&#13;
elif which lsof &#13;
then&#13;
    LSOF=`which lsof`&#13;
fi&#13;
&#13;
# Check for existence of zonename command&#13;
if [ ! -z "$ZONENAME" ]; then&#13;
        ZONEPARAM="-z${ZONENAME}"&#13;
elif [ -f $ZONECMD ]; then&#13;
    # exists: limit lsof to display processes for this zone&#13;
        ZONEPARAM="-z`$ZONECMD`"&#13;
else&#13;
    # doesn't exist: leave it blank &#13;
        ZONEPARAM=""&#13;
fi&#13;
&#13;
cp "${BASE_DIR}/connection_samples/all_connections.log" "${BASE_DIR}/connection_samples/all_connections_tmp.log"&#13;
sudo $LSOF -iTCP -n -P $ZONEPARAM | grep -v "::" | grep LISTEN | awk -F' ' '{print "on " $2 " " $10}' | sed 's/:/ /g' | sort | uniq &gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
sudo $LSOF -iTCP -n -P $ZONEPARAM | grep -v "::" | grep ESTABLISH | sed 's/-&gt;/ /g' | awk -F' ' '{print "to " $2 " " $11 " " $10}' | sed 's/:/ /g' | sort | uniq &gt;&gt; "${BASE_DIR}/connection_samples/connection_sample.log"&#13;
cat "${BASE_DIR}/connection_samples/connection_sample.log" "${BASE_DIR}/connection_samples/all_connections_tmp.log" | sort &gt; "${BASE_DIR}/connection_samples/all_connections.log"&#13;
</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>evan.qu</sys_created_by><sys_created_on>2017-04-23 08:13:24</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>d1efb6695312320023bdae4a16dc3484</sys_id><sys_mod_count>7</sys_mod_count><sys_name>solaris_lsof_command.sh</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_d1efb6695312320023bdae4a16dc3484</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:56</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>1149392809</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>e4230c7d41a231107f440d8147faed38</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e008910000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>solaris_lsof_command.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>0e10415d96a2311083d64d9abcadf314</update_guid>
<update_guid_history>0e10415d96a2311083d64d9abcadf314:1149392809,8a10415d5da231101f3ec07939d57e13:-1320483562</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>pa_dashboards_permissions_d8830665e42231107f443c8410589e0e</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="pa_dashboards_permissions"><pa_dashboards_permissions action="INSERT_OR_UPDATE"><dashboard display_value="Discovery Dashboard">98db0f8a0fc03010ce4d142386767e44</dashboard><delete>true</delete><group/><identity>pa_admin</identity><read>true</read><role display_value="pa_admin" name="pa_admin">a4cc30b3bf101100b96dac808c073918</role><sys_class_name>pa_dashboards_permissions</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 16:18:56</sys_created_on><sys_id>d8830665e42231107f443c8410589e0e</sys_id><sys_mod_count>0</sys_mod_count><sys_name>pa_admin</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>pa_dashboards_permissions_d8830665e42231107f443c8410589e0e</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 16:18:56</sys_updated_on><type>1</type><user/><write>true</write></pa_dashboards_permissions></record_update>]]></payload>
<payload_hash>-333954005</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>e4230c7d41a231107f440d8147faed3b</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd8edad780000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>pa_admin</target_name>
<type>Dashboard Permissions</type>
<update_domain>global</update_domain>
<update_guid>988306650b223110f1a5a9ae25fc5d0f</update_guid>
<update_guid_history>988306650b223110f1a5a9ae25fc5d0f:-333954005</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_123e1fa0772111107cb28babbe5a99d5</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description>True/False - Setting this value as true will restrict the GET login requests.</description><ignore_cache>false</ignore_cache><is_private>false</is_private><name>glide.security.restrict.get.login</name><read_roles/><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2022-08-23 11:20:40</sys_created_on><sys_id>123e1fa0772111107cb28babbe5a99d5</sys_id><sys_mod_count>1</sys_mod_count><sys_name>glide.security.restrict.get.login</sys_name><sys_package display_value="Password Policy" source="com.glide.password_policy">1783ef5f9f2131107f44e6ca4224abbd</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_123e1fa0772111107cb28babbe5a99d5</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:25:28</sys_updated_on><type>boolean</type><value>false</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=123e1fa0772111107cb28babbe5a99d5"/></record_update>]]></payload>
<payload_hash>-489093340</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>e4230c7d41a231107f440d8147faed3e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd4043df60000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>glide.security.restrict.get.login</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>d1294d91f1a63110a21b76bbb79cfc95</update_guid>
<update_guid_history>d1294d91f1a63110a21b76bbb79cfc95:-489093340,01294d91bea6311072ff9306aaca8a90:2007022411</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_2b5071f973533300d4c1b7385ef6a704</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>R6qpc/MKEbtsAXFo9FJl4Q==</checksum><description>WinRM implementation of functions for file operations</description><directory>false</directory><name>WinRMFileOperations.psm1</name><parent display_value="WinRMCollector">d90565b173533300d4c1b7385ef6a714</parent><script>function getTempDirectory {&#13;
    param([string] $subdirectory, [string]$serviceName, [boolean]$useSecureTemp)&#13;
    # If already set - return&#13;
    if ($tmpDir) {&#13;
        return $tmpDir;&#13;
    }&#13;
&#13;
    $sb = {&#13;
        param([string] $subdirectory, [string] $discoveryUser, [boolean]$useSecureTemp);&#13;
        $psTargetBaseDir =  [Environment]::GetEnvironmentVariable("SNC_base_dir")&#13;
        if ( $psTargetBaseDir ) {&#13;
                   $tmpDir =  $psTargetBaseDir &#13;
        } else {&#13;
                   $tmpDir = $env:TEMP;&#13;
      }&#13;
        if (-not $tmpDir -or ($tmpDir -match 'system32')) {&#13;
            $tmpDir = (Get-WmiObject -Query 'Select TempDirectory from Win32_BootConfiguration' -ErrorAction Stop).TempDirectory;&#13;
            if (-not $tmpDir -or ($tmpDir -match 'system32')) {&#13;
                $tmpDir = 'C:\temp';&#13;
            }&#13;
        }&#13;
&#13;
        $tmpDir = Join-Path -Path $tmpDir -ChildPath $subdirectory;&#13;
        SNCLog-DebugInfo "tmpDir on target is $tmpDir";&#13;
        if ($useSecureTemp) {&#13;
            # createFolder is imported into remote session at provider startup, from SecureTempFolder.psm1&#13;
            if (createFolder -folder $tmpDir -secureFolder $true) {&#13;
                return $tmpDir;&#13;
            }&#13;
            SNCLog-DebugInfo "Failed to create secure folder $tmpDir";&#13;
        }&#13;
&#13;
        SNCLog-DebugInfo "Attempting to create unsecure folder $tmpDir";&#13;
        if (createFolder -folder $tmpDir -secureFolder $false) {&#13;
            return $tmpDir;&#13;
        }&#13;
&#13;
        SNCLog-DebugInfo "Failed to create unsecure folder $tmpDir";&#13;
    }&#13;
&#13;
    if ($useSecureTemp) {&#13;
        if ($snccred) {&#13;
            $discoveryUser = $snccred.UserName;&#13;
        }&#13;
&#13;
        $discoveryUser = getNormalizedUser -discoveryUser $discoveryUser -serviceName $serviceName;&#13;
&#13;
        # Append discoveryUser to parentFolder path&#13;
        $subdirectory = Join-Path -Path $subdirectory -ChildPath $discoveryUser;&#13;
    }&#13;
&#13;
    try {&#13;
        if ($SNC_session) {&#13;
            $sessionString = "remote session ($($SNC_session.ComputerName))";&#13;
            SNCLog-DebugInfo "Getting temp directory through the ${sessionString}: subdirectory $subdirectory";&#13;
            &#13;
            if (isJEACodeSigning) {&#13;
                $_params = @{&#13;
                    "subdirectory" = $subdirectory&#13;
                    "discoveryUser" = $discoveryUser&#13;
                    "useSecureTemp" = $useSecureTemp&#13;
                }&#13;
                $output = invokeJEAExecuteScript $SNC_session $sb.toString() $_params -ErrorAction Stop;&#13;
            } else {&#13;
                $output = Invoke-Command -Session $SNC_session -ScriptBlock $sb -ArgumentList $subdirectory,$discoveryUser,$useSecureTemp -ErrorAction Stop;&#13;
            }&#13;
        } else {&#13;
            $sessionString = 'local session';&#13;
            SNCLog-DebugInfo "Getting temp directory through the $sessionString";&#13;
            # pass function parameters to the script block and run it&#13;
            $output = &amp; $sb -subdirectory $subdirectory -discoveryUser $discoveryUser -useSecureTemp $useSecureTemp;&#13;
        }&#13;
        return $output;&#13;
    } catch {&#13;
        Write-Error ("Could not get temp directory from $sessionString. Original exception: " + $_.Exception.Message);&#13;
    }&#13;
}&#13;
&#13;
function putFileToTarget {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Copies the source file to the temp directory specified by $tmpDir.&#13;
        Can optionally rename the destination file with the destFileName parameter.&#13;
        Can optionally change the file permissions with the changeFilePermission parameter.&#13;
&#13;
    .PARAMETER sourcePath&#13;
        Specifies the path of the source file.&#13;
    .PARAMETER destFileName&#13;
        Specifies the name of the destination file.&#13;
    .PARAMETER changeFilePermission&#13;
        Specifies whether to change the permissions on the file.&#13;
&#13;
    .OUTPUTS&#13;
        System.String&#13;
            The destination file path.&#13;
#&gt;&#13;
    param([string]$sourcePath = $(throw 'The sourcePath parameter is required.'), [string]$destFileName, [bool]$changeFilePermission)&#13;
    if (-not $tmpDir) {&#13;
        throw 'Could not put file because $tmpDir is null';&#13;
    }&#13;
&#13;
    if (-not (Test-Path $sourcePath -PathType Leaf)) {&#13;
        Write-Error "The source file $sourcePath does not exist or is a directory";&#13;
        return;&#13;
    }&#13;
&#13;
    if (-not $destFileName) {&#13;
        # extract the file name from the source path&#13;
        $destFileName = Split-Path -Path $sourcePath -Leaf;&#13;
    }&#13;
&#13;
    $sb = {&#13;
        param([string]$destFilePath);&#13;
        $allOutput = &amp; ICACLS $destFilePath /grant:r ADMINISTRATORS:F /grant:r EVERYONE:RX 2&gt;&amp;1;&#13;
        $stderr = $allOutput | Where-Object { $_ -is [System.Management.Automation.ErrorRecord] };&#13;
        return @{ exitCode = $LASTEXITCODE; stderr = $stderr };&#13;
    }&#13;
&#13;
    try {&#13;
        if ($SNC_session) {&#13;
            $sessionString = "remote session ($($SNC_session.ComputerName))";&#13;
&#13;
            SNCLog-DebugInfo "Calling SendFileExecuteRemote -Path $sourcePath -Destination $tmpDir -Name $destFileName -Session $SNC_session";&#13;
            # SendFileExecuteRemote comes from ExecuteRemote.psm1&#13;
            $destFilePath = (SendFileExecuteRemote -Path $sourcePath -Destination $tmpDir -Name $destFileName -Session $SNC_session).FullName;&#13;
            SNCLog-DebugInfo "Done putting source file $sourcePath to $destFilePath, change file permission $changeFilePermission, through $sessionString";&#13;
            &#13;
            if ($changeFilePermission) {&#13;
                SNCLog-DebugInfo "Changing file permissions of $destFilePath through $sessionString";&#13;
                &#13;
                if (isJEACodeSigning) {&#13;
                    $_params = @{&#13;
                        "destFilePath" = $destFilePath&#13;
                    }&#13;
                    $exitAndError = invokeJEAExecuteScript $SNC_session $sb.toString() $_params -ErrorAction Stop;&#13;
                } else {&#13;
                    $exitAndError = Invoke-Command -Session $SNC_session -ScriptBlock $sb -ArgumentList $destFilePath -ErrorAction Stop;&#13;
                }&#13;
                $exitCode = $exitAndError['exitCode'];&#13;
                $stderr = $exitAndError['stderr'];&#13;
                if ($exitCode -and $stderr) {&#13;
                    SNCLog-DebugInfo ("Could not change file permissions of $destFilePath. " + ($stderr | Out-String));&#13;
                }&#13;
            }&#13;
        } else {&#13;
            $sessionString = 'local session';&#13;
&#13;
            $destFilePath = Join-Path -Path $tmpDir -ChildPath $destFileName&#13;
            SNCLog-DebugInfo "Putting source file $sourcePath to $destFilePath, change file permission $changeFilePermission, through $sessionString";&#13;
            Copy-Item -Path $sourcePath -Destination $destFilePath -ErrorAction Stop;&#13;
&#13;
            if ($changeFilePermission) {&#13;
                SNCLog-DebugInfo "Changing file permissions of $destFilePath through $sessionString";&#13;
                $exitAndError = &amp; $sb -destFilePath $destFilePath;&#13;
                $exitCode = $exitAndError['exitCode'];&#13;
                $stderr = $exitAndError['stderr'];&#13;
                if ($exitCode -and $stderr) {&#13;
                    SNCLog-DebugInfo ("Could not change file permissions of $destFilePath. " + ($stderr | Out-String));&#13;
                }&#13;
            }&#13;
        }&#13;
        &#13;
        return $destFilePath;&#13;
    } catch {&#13;
        Write-Error ("Could not put source file $sourcePath to $destFilePath through $sessionString. Original exception: " + $_.Exception.Message);&#13;
    }&#13;
}&#13;
&#13;
&lt;# &#13;
    This function is duplicated in the both WMI and WinRM FileOperations modules rather than&#13;
    placed in the CommonUtils module in order to prevent someone from calling the function&#13;
    without the necessary WMI or WinRM module loaded&#13;
#&gt;&#13;
function getFileContent {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Gets the file content of the given path.&#13;
&#13;
    .PARAMETER path&#13;
        Specifies the path of the text file.&#13;
    .PARAMETER encoding&#13;
        Specifies the encoding of the text file.&#13;
&#13;
    .OUTPUTS&#13;
        System.String&#13;
            The file content as a string.&#13;
#&gt;&#13;
    param(&#13;
        [string]$path = $(throw 'The path parameter is required'),&#13;
        [string]$encoding = 'Default'&#13;
    )&#13;
&#13;
    # isUncPath and getFileContentUncPath are in CommonUtils.psm1&#13;
    if (isUncPath -path $path) {&#13;
        SNCLog-DebugInfo "Getting file content through UNC path $path";&#13;
        $output = getFileContentUncPath -uncPath $path -encoding $encoding -credential $snccred;&#13;
    } else {&#13;
        SNCLog-DebugInfo "Getting file content through local path $path";&#13;
        $output = getFileContentLocalPath -localPath $path -encoding $encoding;&#13;
    }&#13;
&#13;
    $output;&#13;
}&#13;
&#13;
function getFileContentLocalPath {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Gets the file content of the given local path.&#13;
&#13;
    .PARAMETER localPath&#13;
        Specifies the local path of the text file.&#13;
    .PARAMETER encoding&#13;
        Specifies the encoding of the text file.&#13;
&#13;
    .OUTPUTS&#13;
        System.String&#13;
            The file content as a string.&#13;
#&gt;&#13;
    param([string]$localPath = $(throw 'The localPath parameter is required'), [string]$encoding = 'Default')&#13;
&#13;
    $sb = {&#13;
        param([string]$localPath, [string]$encoding);&#13;
        try {&#13;
            Get-Content -Path $localPath -Encoding $encoding -ErrorAction Stop;&#13;
        } catch [System.Management.Automation.ParameterBindingException] {&#13;
            # the Encoding parameter on Get-Content is only available in file system drives, so the above call may result in&#13;
            # a parameter binding exception. if so, try Get-Content without the Encoding parameter&#13;
            if ($_.Exception -match 'Encoding') {&#13;
                Get-Content -Path $localPath -ErrorAction Stop;&#13;
            } else {&#13;
                throw;&#13;
            }&#13;
        }&#13;
    }&#13;
&#13;
    try {&#13;
        if ($SNC_session) {&#13;
            $sessionString = "remote session ($($SNC_session.ComputerName))";&#13;
            SNCLog-DebugInfo "Getting file $localPath using encoding $encoding through $sessionString";&#13;
            if (isJEACodeSigning) {&#13;
                $_params = @{&#13;
                    "localPath" = $localPath&#13;
                    "encoding" = $encoding&#13;
                }&#13;
                $output = invokeJEAExecuteScript $SNC_session $sb.toString() $_params -ErrorAction Stop;&#13;
            } else { &#13;
                $output = Invoke-Command -Session $SNC_session -ScriptBlock $sb -ArgumentList $localPath,$encoding -ErrorAction Stop;&#13;
            }    &#13;
        } else {&#13;
            $sessionString = 'local session';&#13;
            SNCLog-DebugInfo "Getting file $localPath using encoding $encoding through $sessionString";&#13;
            # pass function parameters to the script block and run it&#13;
            $output = &amp; $sb -localPath $localPath -encoding $encoding;&#13;
        }&#13;
        &#13;
        return $output;&#13;
    } catch {&#13;
        Write-Error ("Could not get file $localPath through $sessionString. Original exception: " + $_.Exception.Message);&#13;
    }&#13;
}&#13;
&#13;
&lt;# &#13;
    This function is duplicated in the both WMI and WinRM FileOperations modules rather than&#13;
    placed in the CommonUtils module in order to prevent someone from calling the function&#13;
    without the necessary WMI or WinRM module loaded&#13;
#&gt;&#13;
function deleteFile {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Deletes the file at the given path.&#13;
&#13;
    .PARAMETER path&#13;
        Specifies the path of the file to delete.&#13;
&#13;
    .OUTPUTS&#13;
        None.&#13;
#&gt;&#13;
    param([string]$path = $(throw 'The path parameter is required'))&#13;
&#13;
    # isUncPath and deleteFileUncPath are in CommonUtils.psm1&#13;
    if (isUncPath -path $path) {&#13;
        SNCLog-DebugInfo "Deleting file through UNC path $path";&#13;
        deleteFileUncPath -uncPath $path -credential $snccred;&#13;
    } else {&#13;
        SNCLog-DebugInfo "Deleting file through local path $path";&#13;
        deleteFileLocalPath -localPath $path;&#13;
    }&#13;
}&#13;
&#13;
function deleteFileLocalPath {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Deletes the file at the given local path.&#13;
&#13;
    .PARAMETER path&#13;
        Specifies the local path of the file to delete.&#13;
&#13;
    .OUTPUTS&#13;
        None.&#13;
#&gt;&#13;
    param([string]$localPath = $(throw 'The localPath parameter is required'))&#13;
    &#13;
    $sb = {&#13;
        param([string]$localPath);&#13;
        Remove-Item -Path $localPath -ErrorAction Stop;&#13;
    }&#13;
&#13;
    try {&#13;
        if ($SNC_session) {&#13;
            $sessionString = "remote session ($($SNC_session.ComputerName))";&#13;
            SNCLog-DebugInfo "Deleting file $localPath through $sessionString";&#13;
             if (isJEACodeSigning) {&#13;
                $_params = @{&#13;
                    "localPath" = $localPath&#13;
                }&#13;
                $output = invokeJEAExecuteScript $SNC_session $sb.toString() $_params -ErrorAction Stop;&#13;
            } else {&#13;
                $output = Invoke-Command -Session $SNC_session -ScriptBlock $sb -ArgumentList $localPath -ErrorAction Stop;&#13;
             }&#13;
        } else {&#13;
            $sessionString = 'local session';&#13;
            SNCLog-DebugInfo "Deleting file $localPath through $sessionString";&#13;
            # pass function parameters to the script block and run it&#13;
            $output = &amp; $sb -localPath $localPath;&#13;
        }&#13;
        &#13;
        return $output;&#13;
    } catch {&#13;
        Write-Error ("Could not delete file $localPath through $sessionString. Original exception: " + $_.Exception.Message);&#13;
    }&#13;
}&#13;
&#13;
function getFileOwner {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Gets the owner of the specified file&#13;
&#13;
    .PARAMETER path&#13;
        The path to the file&#13;
&#13;
    .OUTPUTS&#13;
        The owner of the file&#13;
#&gt;&#13;
    param([string]$path = $(throw "path parameter is required"))&#13;
&#13;
    if (isUncPath -path $path) {&#13;
        $acl = getFileAclUncPath -uncPath $path;&#13;
    } else {&#13;
        $acl = getFileAclLocalPath -localPath $path;&#13;
    }&#13;
&#13;
    return $acl.Owner;&#13;
}&#13;
&#13;
function getFileAclLocalPath {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Gets the acl of the specified file&#13;
&#13;
    .PARAMETER localPath&#13;
        The local path to the file&#13;
&#13;
    .OUTPUTS&#13;
        The acl of the file&#13;
#&gt;&#13;
    param([string]$localPath = $(throw "localPath parameter is required"))&#13;
&#13;
    $sb = {&#13;
        param([string]$localPath);&#13;
        Get-Acl $localPath -ErrorAction Stop;&#13;
    }&#13;
&#13;
    try {&#13;
        if ($SNC_session) {&#13;
            $sessionString = "remote session ($($SNC_session.ComputerName))";&#13;
            SNCLog-DebugInfo "getting ACL for file $localPath through $sessionString";&#13;
             if (isJEACodeSigning) {&#13;
                $_params = @{&#13;
                    "localPath" = $localPath&#13;
                }&#13;
                $acl = invokeJEAExecuteScript $SNC_session $sb.toString() $_params -ErrorAction Stop;&#13;
            } else {&#13;
                $acl = Invoke-Command -Session $SNC_session -ScriptBlock $sb -ArgumentList $localPath -ErrorAction Stop;&#13;
            }&#13;
        } else {&#13;
            $sessionString = "local session";&#13;
            SNCLog-DebugInfo "getting ACL for file $localPath through $sessionString";&#13;
            $acl = &amp; $sb -localPath $localPath;&#13;
        }&#13;
    } catch {&#13;
        Write-Error ("Could not get file ACL from $localPath through $sessionString. Original exception: " + $_.Exception.Message);&#13;
    }&#13;
&#13;
    return $acl;&#13;
}&#13;
&#13;
function importModuleIntoSession {&#13;
    param([string] $modulePath)&#13;
    $fileContent = Get-Content -Path $modulePath -Raw;&#13;
&#13;
    $sb = {&#13;
        param([string] $moduleString);&#13;
        $scriptBlock = [ScriptBlock]::Create($moduleString);&#13;
        New-Module -ScriptBlock $scriptBlock | Import-Module -Force;&#13;
    }&#13;
&#13;
    try {&#13;
        if ($SNC_session) {&#13;
            $sessionString = "remote session ($($SNC_session.ComputerName))";&#13;
            SNCLog-DebugInfo "importing module $modulePath into $sessionString";&#13;
            if (isJEACodeSigning) {&#13;
                $_params = @{&#13;
                    "moduleString" = $fileContent&#13;
                }&#13;
                invokeJEAExecuteScript $SNC_session $sb.toString() $_params -ErrorAction Stop;&#13;
            } else {&#13;
                Invoke-Command -Session $SNC_session -ScriptBlock $sb -ArgumentList $fileContent -ErrorAction Stop;&#13;
            }&#13;
        } else {&#13;
            SNCLog-DebugInfo "The session is local, skipping importing module";&#13;
        }&#13;
    } catch {&#13;
        Write-Error ("Could import module $modulePath into $sessionString. Original exception: " + $_.Exception.Message);&#13;
    }&#13;
}</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>benjamin.phan</sys_created_by><sys_created_on>2019-08-16 22:52:00</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>2b5071f973533300d4c1b7385ef6a704</sys_id><sys_mod_count>43</sys_mod_count><sys_name>WinRMFileOperations.psm1</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_2b5071f973533300d4c1b7385ef6a704</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:54</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-1061600246</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>e423c87d41a231107f440d8147faeddd</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e0005b0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>WinRMFileOperations.psm1</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>6510015d19a23110cb5fca4465099db5</update_guid>
<update_guid_history>6510015d19a23110cb5fca4465099db5:-1061600246,e110015da2a2311030be226463c836b4:1838383760</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_a65f32695312320023bdae4a16dc348c</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>R9eyANEC26k/Tb7qSQ/R+A==</checksum><description/><directory>false</directory><name>hpux_ps_command.sh</name><parent display_value="ADME">ec515c705352320023bdae4a16dc3488</parent><script>#!/bin/sh&#13;
# Copyright © ServiceNow, Inc. 2017. All rights reserved. &#13;
# Active Processes Command for HP-UX&#13;
BASE_DIR=$1&#13;
CALLPOINT_DIR=`dirname $0`&#13;
ADME_PID=`cat $CALLPOINT_DIR/../adme_collector.pid` &#13;
cp "${BASE_DIR}/process_samples/all_processes.log" "${BASE_DIR}/process_samples/all_processes_tmp.log"&#13;
ps -elx | sed 's/ *//' | tr -s ' ' | cut -d ' ' -f4,5,14- | grep -v "PID PPID COMD" | sort | uniq &gt; "${BASE_DIR}/process_samples/process_sample.log"&#13;
cat "${BASE_DIR}/process_samples/process_sample.log" "${BASE_DIR}/process_samples/all_processes_tmp.log" | sort &gt; "${BASE_DIR}/process_samples/all_processes.log"&#13;
</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>evan.qu</sys_created_by><sys_created_on>2017-04-23 08:11:03</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>a65f32695312320023bdae4a16dc348c</sys_id><sys_mod_count>4</sys_mod_count><sys_name>hpux_ps_command.sh</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_a65f32695312320023bdae4a16dc348c</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:56</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>-636715587</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>e8230c7d41a231107f440d8147faed37</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e0065c0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>hpux_ps_command.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>f110415d04a23110a71119901760910e</update_guid>
<update_guid_history>f110415d04a23110a71119901760910e:-636715587,7110415d35a23110ce60f864a038fe0d:-1779376181</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>multi_factor_criteria_d427668b73003300fdbd04fbc4f6a7b6</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="multi_factor_criteria"><multi_factor_criteria action="INSERT_OR_UPDATE"><active>false</active><description>Enforce multi-factor authentication based on the roles assigned to the user</description><name>Role based multi-factor authentication</name><sys_created_by>admin</sys_created_by><sys_created_on>2019-03-12 11:17:33</sys_created_on><sys_id>d427668b73003300fdbd04fbc4f6a7b6</sys_id><sys_mod_count>15</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2019-03-14 13:02:30</sys_updated_on><type>role_based</type></multi_factor_criteria></record_update>]]></payload>
<payload_hash>-589336594</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>e8230c7d41a231107f440d8147faed3a</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3ff56fa0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>Role based multi-factor authentication</target_name>
<type>Multi-factor Criteria</type>
<update_domain>global</update_domain>
<update_guid>87e7415d92663110a756b9ad321650f5</update_guid>
<update_guid_history>87e7415d92663110a756b9ad321650f5:-589336594</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da_null</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="" extends="cmdb_qb_result_base" table="u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da"><active>true</active><array>false</array><attributes>ignore_baseline=true</attributes><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label/><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element/><element_reference>false</element_reference><foreign_database/><formula/><function_definition/><function_field>false</function_field><internal_type display_value="Collection">collection</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 00:15:08</sys_created_on><sys_id>7370f325416231107f440d8147faeda2</sys_id><sys_name>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da_null</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:15:08</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><virtual_type>script</virtual_type><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>920359187</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>e8230c7d41a231107f440d8147faed3d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bdaa1a7380000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</table>
<target_name>Critical Incidents with No Owner-Query Results</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>4480f325c16231101bb547f98d3b0bbd</update_guid>
<update_guid_history>4480f325c16231101bb547f98d3b0bbd:920359187</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_1e3f1d227f332100ed1c3b19befa91a7</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>qoegVsGnaOIQBw1hQ8KpcA==</checksum><description>Map between WMI namespaces and required security level</description><directory>false</directory><name>wminamespaces.properties</name><parent display_value="ServiceWatch">ed844850c31321003e76741e81d3ae39</parent><script>\\root\\MicrosoftIISv2=PacketPrivacy&#13;
\\root\\WebAdministration=PacketPrivacy&#13;
\\root\\MSCluster=PacketPrivacy</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2014-10-19 12:24:22</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>1e3f1d227f332100ed1c3b19befa91a7</sys_id><sys_mod_count>1</sys_mod_count><sys_name>wminamespaces.properties</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_1e3f1d227f332100ed1c3b19befa91a7</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:23</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>1317067759</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>e823c87d41a231107f440d8147faeddc</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e244e70000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>wminamespaces.properties</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>31a0015104e231108320b76022834e64</update_guid>
<update_guid_history>31a0015104e231108320b76022834e64:1317067759,71a0cd110ae23110e11872bedf8b8dda:1265654298</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_7814ecf753df73008ec4ddeeff7b125f</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>L8A40LBmRKSymjJEyN+Sdw==</checksum><description>Commons util for PowerShell scripts - WMI and WinRM</description><directory>false</directory><name>CommonUtils.psm1</name><parent display_value="PowerShell">ef89e4fc372001006b882d465abe5d60</parent><script>&lt;#&#13;
    This method search a key in a string and returns the value.&#13;
    Supports multi lines strings&#13;
#&gt;&#13;
function lookupValueByKeyFromString {&#13;
    param([string]$str, [string]$lookupValue, [string]$delimiter)&#13;
    &#13;
    &#13;
    if (-not $str) {&#13;
        return "";&#13;
    }&#13;
    &#13;
    # Fetch the lookupValue&#13;
    $parser = [regex]"^$lookupValue\s*$delimiter\s*(.*)";&#13;
    foreach ($line in $($str.Split([Environment]::NewLine))) {&#13;
        if (-not $line -or -not $line.startsWith($lookupValue)) {&#13;
            continue;&#13;
        }&#13;
        &#13;
        $parts = $parser.match($line);&#13;
&#13;
        if ($parts.Success -and $parts.Groups[1] -and $parts.Groups[1].Value) {&#13;
            SNCLog-DebugInfo ("Found $lookupValue = " + $parts.Groups[1].Value.trim());&#13;
            return $parts.Groups[1].Value.trim();&#13;
        }&#13;
    }&#13;
    &#13;
    return "";&#13;
}&#13;
&#13;
function isUncPath {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Checks to see if the given path is an UNC path.&#13;
&#13;
    .PARAMETER path&#13;
        Specifies the path to check.&#13;
#&gt;&#13;
    param([string]$path = $(throw 'The path parameter is required'))&#13;
    &#13;
    (New-Object System.Uri($path)).IsUnc;&#13;
}&#13;
&#13;
function getFileContentUncPath {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Gets the file content of the given UNC path.&#13;
&#13;
    .PARAMETER uncPath&#13;
        Specifies the UNC path of the text file.&#13;
    .PARAMETER encoding&#13;
        Specifies the encoding of the text file.&#13;
    .PARAMETER credential&#13;
        Optional credential object that will be used to access the UNC path.&#13;
&#13;
    .OUTPUTS&#13;
        System.String&#13;
            The file content as a string.&#13;
#&gt;&#13;
    param(&#13;
        [string]$uncPath = $(throw 'The uncPath parameter is required'),&#13;
        [string]$encoding = 'Default',&#13;
        [System.Management.Automation.PSCredential]$credential&#13;
    )&#13;
&#13;
    if (-Not (isUncPath -path $uncPath)) {&#13;
        throw "$uncPath is not a valid UNC path"&#13;
    }&#13;
&#13;
    $parentDir = Split-Path -Path $uncPath&#13;
    $fileName = Split-Path -Path $uncPath -Leaf&#13;
&#13;
    if (-not $credential) {&#13;
        $credential = $cred;&#13;
    }&#13;
&#13;
    $drive = mapDrive -path $parentDir -credential $credential;&#13;
    $mappedPath = mapDrivePath -drive $drive -relativePath $fileName;&#13;
    try {&#13;
        SNCLog-DebugInfo "About to get file content: Get-Content -Path $mappedPath -Encoding $encoding";&#13;
        Get-Content -Path $mappedPath -Encoding $encoding;&#13;
    } finally {&#13;
        unmapDrive -drive $drive;&#13;
    }&#13;
}&#13;
&#13;
function putFileUncPath {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Copies the given source file to the given destination UNC path.&#13;
&#13;
    .PARAMETER sourcePath&#13;
        Specifies the path of the source file.&#13;
    .PARAMETER encoding&#13;
        Specifies the destination UNC path.&#13;
    .PARAMETER changeFilePermission&#13;
        Specifies whether to change the file permissions on the destination file&#13;
    .PARAMETER credential&#13;
        Optional credential object that will be used to access the UNC path.&#13;
&#13;
    .OUTPUTS&#13;
        None.&#13;
#&gt;&#13;
    param(&#13;
        [string]$sourcePath = $(throw 'The sourcePath parameter is required.'),&#13;
        [string]$destinationUncPath = $(throw 'The destinationUncPath parameter is required.'),&#13;
        [bool]$changeFilePermission = $false,&#13;
        [System.Management.Automation.PSCredential]$credential&#13;
    )&#13;
&#13;
    if (-Not (isUncPath -path $destinationUncPath)) {&#13;
        throw "$uncPath is not a valid UNC path"&#13;
    }&#13;
&#13;
    if (-not (Test-Path $sourcePath -PathType Leaf)) {&#13;
        throw "The source file $sourcePath does not exist or is a directory";&#13;
    }&#13;
&#13;
    $parentDir = Split-Path -Path $destinationUncPath&#13;
    $fileName = Split-Path -Path $destinationUncPath -Leaf&#13;
&#13;
    if (-not $credential) {&#13;
        $credential = $cred;&#13;
    }&#13;
&#13;
    $drive = mapDrive -path $parentDir -credential $credential;&#13;
    $mappedPath = mapDrivePath -drive $drive -relativePath $fileName;&#13;
&#13;
    try {&#13;
        SNCLog-DebugInfo "About to put file through UNC path: Copy-Item -Path $sourcePath -Destination $mappedPath";&#13;
&#13;
        # Check if the same file before put by calculating checksum, assuming source file exists&#13;
        $srcHash = (Get-FileHash $sourcePath).hash;&#13;
        $destHash = "";&#13;
        if (Test-Path -Path $mappedPath) {&#13;
            try {&#13;
                [IO.File]::OpenWrite($mappedPath).close();&#13;
                $destHash = (Get-FileHash $mappedPath).hash;&#13;
            } catch {&#13;
                $tmpDest = $mappedPath + (Get-Date -UFormat "%s");&#13;
                Copy-Item $mappedPath $tmpDest;&#13;
                $destHash = (Get-FileHash $tmpDest).hash;&#13;
                Remove-Item $tmpDest;&#13;
            }&#13;
        }&#13;
        if ($srcHash -ne $destHash) {&#13;
            $null = Copy-Item -Path $sourcePath -Destination $mappedPath -ErrorAction Stop;&#13;
        }&#13;
&#13;
        if ($changeFilePermission) {&#13;
            SNCLog-DebugInfo "About to change file permissions: ICACLS $destinationUncPath /grant:r ADMINISTRATORS:F /grant:r EVERYONE:RX";&#13;
            try {&#13;
                $allOutput = &amp; ICACLS $destinationUncPath /grant:r ADMINISTRATORS:F /grant:r EVERYONE:RX 2&gt;&amp;1;&#13;
                # only interested in stderr&#13;
                $stderr = $allOutput | Where-Object { $_ -is [System.Management.Automation.ErrorRecord] };&#13;
                if ($LASTEXITCODE -and $stderr) {&#13;
                    SNCLog-DebugInfo ("Could not change file permissions of $destinationUncPath. " + ($stderr | Out-String));&#13;
                }&#13;
            } catch {&#13;
                SNCLog-DebugInfo ("Could not change file permissions of $destinationUncPath. " + $_.Exception.Message);&#13;
            }&#13;
        }&#13;
    } finally {&#13;
        unmapDrive -drive $drive;&#13;
    }&#13;
}&#13;
&#13;
function deleteFileUncPath {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Delete the file at the given destination UNC path.&#13;
&#13;
    .PARAMETER sourcePath&#13;
        Specifies the UNC path of the file to be deleted.&#13;
    .PARAMETER credential&#13;
        Optional credential object that will be used to access the UNC path.&#13;
&#13;
    .OUTPUTS&#13;
        None.&#13;
#&gt;&#13;
    param(&#13;
        [string]$uncPath = $(throw 'The uncPath parameter is required'),&#13;
        [System.Management.Automation.PSCredential]$credential&#13;
    )&#13;
&#13;
    if (-Not (isUncPath -path $uncPath)) {&#13;
        throw "$uncPath is not a valid UNC path"&#13;
    }&#13;
&#13;
    $parentDir = Split-Path -Path $uncPath&#13;
    $fileName = Split-Path -Path $uncPath -Leaf&#13;
&#13;
    if (-not $credential) {&#13;
        $credential = $cred;&#13;
    }&#13;
&#13;
    $drive = mapDrive -path $parentDir -credential $credential;&#13;
    $mappedPath = mapDrivePath -drive $drive -relativePath $fileName;&#13;
    try {&#13;
        SNCLog-DebugInfo "About to delete file through UNC path: Remove-Item -Path $mappedPath";&#13;
        $null = Remove-Item -Path $mappedPath -Force -ErrorAction Stop;&#13;
    } catch [System.Management.Automation.ItemNotFoundException] {&#13;
        throw&#13;
    }&#13;
    finally {&#13;
        unmapDrive -drive $drive;&#13;
    }&#13;
}&#13;
&#13;
function mapDrive {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Maps the given path to a drive.&#13;
&#13;
    .PARAMETER path&#13;
        Specifies the path to map.&#13;
    .PARAMETER credential&#13;
        Optional credential object that will be used to map the drive.&#13;
&#13;
    .OUTPUTS&#13;
        System.Management.Automation.PSDriveInfo&#13;
            The mapped drive.&#13;
#&gt;&#13;
    param(&#13;
        [string]$path = $(throw 'The path parameter is required'),&#13;
        [System.Management.Automation.PSCredential]$credential&#13;
    )&#13;
&#13;
    $driveName = [Guid]::NewGuid().ToString()&#13;
&#13;
    if (-not $credential) {&#13;
        $credential = $cred;&#13;
    }&#13;
&#13;
    if ($credential) {&#13;
        SNCLog-DebugInfo "About to create a map drive: New-PSDrive -Name $driveName -PSProvider FileSystem -Root $path -Credential $($credential.UserName) -Scope Script -ErrorAction Stop";&#13;
        try {&#13;
            return New-PSDrive -Name $driveName -PSProvider FileSystem -Root $path -Credential $credential -Scope Global -ErrorAction Stop;&#13;
        } catch [System.ComponentModel.Win32Exception] {&#13;
            # if UNC path already exists, most likely it's already mapped with a different credential&#13;
            # all we can do is to use the same mapping (by not specifying credential below) even if it's&#13;
            # not the right credential since Windows allows only 1 SMB connection to each remote host&#13;
            if (Test-Path -Path $path) {&#13;
                SNCLog-DebugInfo "Unable to map drive for user $($credential.UserName) because drive might have been mapped for a different user"&#13;
            } else {&#13;
                # rethrow exception&#13;
                throw;&#13;
            }&#13;
        }&#13;
    }&#13;
&#13;
    SNCLog-DebugInfo "About to create a map drive without using credential: New-PSDrive -Name $driveName -PSProvider FileSystem -Root $path -Scope Script -ErrorAction Stop";&#13;
    return New-PSDrive -Name $driveName -PSProvider FileSystem -Root $path -Scope Global -ErrorAction Stop;&#13;
}&#13;
&#13;
function unmapDrive {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Unmaps the given drive.&#13;
&#13;
    .PARAMETER drive&#13;
        Specifies the drive to unmap.&#13;
#&gt;&#13;
    param([System.Management.Automation.PSDriveInfo]$drive = $(throw 'The drive parameter is required.'))&#13;
&#13;
    Remove-PSDrive -Name $drive.Name -ErrorAction SilentlyContinue;&#13;
}&#13;
&#13;
function mapDrivePath {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Maps the given relative path to the drive's root.&#13;
&#13;
    .PARAMETER drive&#13;
        Specifies the drive as the root of the relative path.&#13;
    .PARAMETER relativePath&#13;
        Specifies the path relative to the drive's root.&#13;
&#13;
    .OUTPUTS&#13;
        System.String&#13;
            The absolute path rooted by the drive.&#13;
#&gt;&#13;
    param(&#13;
        [System.Management.Automation.PSDriveInfo]$drive = $(throw 'The drive parameter is required.'),&#13;
        [string]$relativePath = $(throw 'The relativePath parameter is required')&#13;
    )&#13;
&#13;
    Join-Path -Path "$($drive.Name):" -ChildPath $relativePath;&#13;
}&#13;
&#13;
function standardizePath {&#13;
    param([string]$path)&#13;
    &#13;
    if ($path){&#13;
        return ($path.replace("/", "\"));&#13;
    }&#13;
}&#13;
&#13;
function httpRequest {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Perform an HTTP request&#13;
&#13;
    .PARAMETER User&#13;
        The username used to authenticate the request.&#13;
    .PARAMETER Password&#13;
        The password used to authenticate the request.&#13;
    .PARAMETER URI&#13;
        The resource to request.&#13;
&#13;
    .OUTPUTS&#13;
        The HTTP status code followed by the response body, newline-separated.&#13;
#&gt;&#13;
    param(&#13;
        [string]$User,&#13;
        [string]$Password,&#13;
        [string]$URI = $(throw 'URI is required')&#13;
    )&#13;
&#13;
    if ($User -and $Password) {&#13;
        $httpCred = getCredential -User $User -Password $Password;&#13;
        $httpResponse = Invoke-WebRequest -Credential $httpCred -URI $URI -UseBasicParsing;&#13;
    } else {&#13;
        $httpResponse = Invoke-WebRequest -UseDefaultCredentials -URI $URI -UseBasicParsing;&#13;
    }&#13;
&#13;
&#13;
    return $httpResponse.StatusCode, $httpResponse.Content;&#13;
}&#13;
&#13;
function standardizeNamespace {&#13;
    param([string]$namespace)&#13;
    &#13;
    # If we did not get a namespace, use the default&#13;
    if (-not $namespace){&#13;
        $nameSpace = "root\cimv2";&#13;
    }elseif ($namespace.startsWith("\")){&#13;
        $namespace = $namespace.substring(1); #namespace should not start with a \&#13;
    }&#13;
    &#13;
    return $namespace;&#13;
}&#13;
&#13;
&#13;
&lt;#&#13;
    This method returns a comma separated values of the array items and expand CIM Intances if needed&#13;
#&gt;&#13;
function arrayToString{&#13;
    param([Array]$arr)&#13;
    &#13;
    $items = @();&#13;
    foreach ($item in $arr){&#13;
        &#13;
        if ($item -is [CimInstance]){&#13;
            # In case we got an array of objects, we will create many arrays of its properties&#13;
            $keyValues = @("$INTERNAL_NAMESPACE=$($item.CimSystemProperties.Namespace)", "$INTERNAL_CLASSNAME=$($item.CimSystemProperties.ClassName)");&#13;
            $keyValues += ($item.CimInstanceProperties | ForEach-Object {&#13;
                if ($_.Value -ne $null) {&#13;
                    "$($_.Name)=$($_.Value)";&#13;
                }&#13;
            });&#13;
&#13;
            $commaSeparatedKeyValues = $keyValues -join $OBJECT_DELIMITER&#13;
            if ($commaSeparatedKeyValues) {&#13;
                $items += "${OBJECT_INDICATOR_START}$commaSeparatedKeyValues${OBJECT_INDICATOR_END}";&#13;
            }&#13;
        } else {&#13;
            $items += $item;&#13;
        }&#13;
    }&#13;
&#13;
    $commaSeparatedItems = $items -join $ARRAY_DELIMITER;&#13;
    return "${ARRAY_INDICATOR_START}${commaSeparatedItems}${ARRAY_INDICATOR_END}";&#13;
}&#13;
&#13;
&lt;#&#13;
    When we moved from Get-WmiObject to Get-CimInstance, we noticed that the format of the output is very different.&#13;
    This method is intended to match that output&#13;
#&gt;&#13;
function cimInstanceToString{&#13;
    param([CimInstance]$cimObj, [string]$objName)&#13;
    &#13;
    $rtn = New-Object -TypeName System.Text.StringBuilder;&#13;
    # A fix prefix found in Get-WmiObject&#13;
    $PREFIX = "\\.\";&#13;
    &#13;
    if ($cimObj -and $cimObj.CimInstanceProperties -and $cimObj.CimInstanceProperties.count -gt 0 -and $objName){&#13;
        $null = $rtn.Append("$objName`t:`t");&#13;
        $null = $rtn.Append($PREFIX + ($cimObj.CimSystemProperties.Namespace + ":" + $cimObj.CimSystemProperties.ClassName).replace("/", "\") + ".");&#13;
    }&#13;
&#13;
    foreach ($p in $cimObj.CimInstanceProperties) {&#13;
        if ($p.Value){&#13;
            $str = $p.Value;&#13;
            $name = $p.Name;&#13;
            if ($str -is [string]){&#13;
                # escape \ by replacing \ with \\&#13;
                $str = $str.Replace("\", "\\");&#13;
&#13;
                # escape " by replacing " with \"&#13;
                $str = $str.Replace("`"", "\`"");&#13;
            }&#13;
            $null = $rtn.Append("$name=""$str"",");&#13;
        }&#13;
        &#13;
    }&#13;
    &#13;
    $rtnStr = $rtn.toString();&#13;
    &#13;
    if ($rtnStr.length -gt 0){&#13;
        $rtnStr = $rtnStr.substring(0, $rtnStr.length - 1);&#13;
    }&#13;
&#13;
    return $rtnStr;&#13;
}&#13;
&#13;
function propertyToString{&#13;
    param($property)&#13;
    &#13;
    if ($property.Value -is [array]){&#13;
        # arrayToString method is in CommonUtils&#13;
        $property.Name + "`t:`t" + (arrayToString -arr $property.Value);&#13;
    } elseif ($property.Value -is [CimInstance]){&#13;
        # cimInstanceToString method is in CommonUtils&#13;
        cimInstanceToString -cimObj $property.Value -objName $property.Name;&#13;
    } elseif ($property.Value -is [DateTime]) {&#13;
        $property.Name + "`t:`t" + [Management.ManagementDateTimeConverter]::ToDmtfDateTime($property.Value);&#13;
    }&#13;
    else {&#13;
        $property.Name + "`t:`t" + $property.Value;&#13;
    }&#13;
}&#13;
&#13;
function getInternalWhere {&#13;
     param([string]$query, [string]$namespace)&#13;
&#13;
    $parser = [regex]"(?i).*\s+from\s+\S+(?:\s+where\s+(.+))?";&#13;
    $parts = $parser.match($query);&#13;
&#13;
    if ($parts.Success -and $parts.Groups[1] -and $parts.Groups[1].Value){&#13;
        $rtn = "$INTERNAL_WHERE`t:`t{0}" -f $parts.Groups[1].Value.toString();&#13;
        return $rtn.Trim();&#13;
    }&#13;
}&#13;
&#13;
function isNum{&#13;
    param($value)&#13;
    &#13;
    return $value -match "^\d+\.?\d*$";&#13;
}&#13;
&#13;
function getFileAclUncPath {&#13;
&lt;#&#13;
    .SYNOPSIS&#13;
        Gets the owner of the specified file&#13;
&#13;
    .PARAMETER uncPath&#13;
        The UNC path to the file&#13;
    .PARAMETER credential&#13;
        Credentials to use&#13;
&#13;
    .OUTPUTS&#13;
        The acl of the file&#13;
#&gt;&#13;
    param(&#13;
        [string]$uncPath = $(throw "uncPath parameter is required"),&#13;
        [System.Management.Automation.PSCredential]$credential&#13;
    )&#13;
&#13;
    if (-Not (isUncPath -path $uncPath)) {&#13;
        throw "$uncPath is not a valid UNC path"&#13;
    }&#13;
&#13;
    $parentDir = Split-Path -Path $uncPath&#13;
    $fileName = Split-Path -Path $uncPath -Leaf&#13;
&#13;
    if (-not $credential) {&#13;
        $credential = $cred;&#13;
    }&#13;
&#13;
    $drive = mapDrive -path $parentDir -credential $credential;&#13;
    $mappedPath = mapDrivePath -drive $drive -relativePath $fileName;&#13;
    try {&#13;
        SNCLog-DebugInfo "About to get file ACL: Get-Acl -Path $mappedPath";&#13;
        $acl = Get-Acl -Path $uncPath;&#13;
    } finally {&#13;
        unmapDrive -drive $drive;&#13;
    }&#13;
&#13;
    return $acl;&#13;
}</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>nisan.barzion</sys_created_by><sys_created_on>2019-08-22 22:26:46</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>7814ecf753df73008ec4ddeeff7b125f</sys_id><sys_mod_count>21</sys_mod_count><sys_name>CommonUtils.psm1</sys_name><sys_overrides/><sys_package display_value="Discovery - IP Based" source="com.snc.discovery.ip_based">b17af059092231107f445d7a5f5e130f</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_7814ecf753df73008ec4ddeeff7b125f</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:45:55</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>818751489</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>ec230c7d41a231107f440d8147faed36</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e004370000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>CommonUtils.psm1</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>7910015d58a2311059b7af088dafa5eb</update_guid>
<update_guid_history>7910015d58a2311059b7af088dafa5eb:818751489,f510015d49a23110920536bd3ad62cea:171640303</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>ecc_agent_script_file_f0edf7409f7322001d753758442e7082</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="ecc_agent_script_file"><ecc_agent_script_file action="INSERT_OR_UPDATE"><active>true</active><checksum>MAQ5T3ur7FbbjDYzecwPHA==</checksum><description/><directory>false</directory><name>memory.sh</name><parent display_value="SSHScriptFiles">48deb961ff123100ab8fffffffffff07</parent><script>for i in `lsdev -C -F 'name,status' -c memory|grep '^mem'`; do
      PROC=`echo $i | cut -d "," -f1`
      lsattr -E -F 'attribute,value' -l $PROC
done</script><script_attachment/><source/><sys_class_name>ecc_agent_script_file</sys_class_name><sys_created_by>oron.subayi</sys_created_by><sys_created_on>2016-12-15 14:16:43</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>f0edf7409f7322001d753758442e7082</sys_id><sys_mod_count>1</sys_mod_count><sys_name>memory.sh</sys_name><sys_overrides/><sys_package display_value="Pattern Designer" source="com.snc.pattern.designer">c41bf81d092231107f445d7a5f5e136d</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>ecc_agent_script_file_f0edf7409f7322001d753758442e7082</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:48:24</sys_updated_on><use_attachment>false</use_attachment><version/></ecc_agent_script_file></record_update>]]></payload>
<payload_hash>679797797</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>ec230c7d41a231107f440d8147faed39</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3e249330000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>memory.sh</target_name>
<type>MID Server Script File</type>
<update_domain>global</update_domain>
<update_guid>42a0015144e2311012a714ac3c35aff5</update_guid>
<update_guid_history>42a0015144e2311012a714ac3c35aff5:679797797,cea0015133e231104c7c20f1bf7c57f3:-1155976302</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_db_object_f370f325416231107f440d8147faed9e</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_db_object"><sys_db_object action="INSERT_OR_UPDATE"><access/><actions_access>true</actions_access><alter_access>true</alter_access><caller_access/><client_scripts_access>true</client_scripts_access><configuration_access>false</configuration_access><create_access>true</create_access><create_access_controls>false</create_access_controls><delete_access>false</delete_access><is_extendable>false</is_extendable><label>Critical Incidents with No Owner-Query Results</label><live_feed_enabled>false</live_feed_enabled><name>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</name><number_ref/><provider_class/><read_access>true</read_access><scriptable_table>false</scriptable_table><super_class display_value="Query Builder Results" name="cmdb_qb_result_base">cde4ab1b9f6131107f44e6ca4224abb8</super_class><sys_class_name>sys_db_object</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 00:15:08</sys_created_on><sys_id>f370f325416231107f440d8147faed9e</sys_id><sys_mod_count>0</sys_mod_count><sys_name>CMDB Qb Result Fafd4a6f866ba18473034adfefcdc8f7f9f330da</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_db_object_f370f325416231107f440d8147faed9e</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:15:08</sys_updated_on><update_access>true</update_access><user_role/><ws_access>true</ws_access></sys_db_object></record_update>]]></payload>
<payload_hash>-1951519139</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>ec230c7d41a231107f440d8147faed3c</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bdaa1ab9f0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</table>
<target_name>Critical Incidents with No Owner-Query Results</target_name>
<type>Table</type>
<update_domain>global</update_domain>
<update_guid>5080f325816231104928cf2bc52cd3bf</update_guid>
<update_guid_history>5080f325816231104928cf2bc52cd3bf:-1951519139</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>cmdb_health_staleness_rule_e419e729412231107f440d8147faed0b</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="cmdb_health_staleness_rule"><cmdb_health_staleness_rule action="INSERT_OR_UPDATE"><applies_to>cmdb_ci_unix_server</applies_to><duration>1970-01-15 00:00:00</duration><sys_class_name>cmdb_health_staleness_rule</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-16 23:42:49</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>e419e729412231107f440d8147faed0b</sys_id><sys_mod_count>2</sys_mod_count><sys_name>cmdb_ci_unix_server</sys_name><sys_overrides/><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>cmdb_health_staleness_rule_e419e729412231107f440d8147faed0b</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-16 23:48:43</sys_updated_on></cmdb_health_staleness_rule></record_update>]]></payload>
<payload_hash>2136690909</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>ec23c87d41a231107f440d8147faeddb</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda8976020000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cmdb_ci_unix_server</target_name>
<type>CMDB Health Staleness Rule</type>
<update_domain>global</update_domain>
<update_guid>707a2ba9d2223110b5be087e4dcc38d4</update_guid>
<update_guid_history>707a2ba9d2223110b5be087e4dcc38d4:2136690909,d6a9e3a9b1223110c2f6a49d66bb9458:682365628,de19e729682231108dd4c5f9b9e1901b:-1237936480</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_bde97c95092231107f445d7a5f5e13c8</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>cl.recordsource</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:18:53</sys_created_on><sys_id>bde97c95092231107f445d7a5f5e13c8</sys_id><sys_mod_count>1</sys_mod_count><sys_name>cl.recordsource</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_bde97c95092231107f445d7a5f5e13c8</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:24:08</sys_updated_on><type>string</type><value>https://nowlearning.servicenow.com/</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=bde97c95092231107f445d7a5f5e13c8"/></record_update>]]></payload>
<payload_hash>201705887</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>f0230c7d41a231107f440d8147faed42</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd40300470000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cl.recordsource</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>a1d8c5513ba6311054f047ad62318d8a</update_guid>
<update_guid_history>a1d8c5513ba6311054f047ad62318d8a:201705887,31e97c957e22311094de9172c25258de:-1743453694</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_user_role_38f4851d092631107f445d7a5f5e13e8</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_user_role"><sys_user_role action="INSERT_OR_UPDATE"><assignable_by/><can_delegate>true</can_delegate><description/><elevated_privilege>false</elevated_privilege><grantable>true</grantable><includes_roles/><name>project_manager</name><requires_subscription>-1</requires_subscription><scoped_admin>false</scoped_admin><suffix/><sys_class_name>sys_user_role</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 17:07:09</sys_created_on><sys_id>38f4851d092631107f445d7a5f5e13e8</sys_id><sys_mod_count>0</sys_mod_count><sys_name>project_manager</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_user_role_38f4851d092631107f445d7a5f5e13e8</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:07:09</sys_updated_on></sys_user_role></record_update>]]></payload>
<payload_hash>-1473855774</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>f0230c7d41a231107f440d8147faed45</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3f376080000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>project_manager</target_name>
<type>Role</type>
<update_domain>global</update_domain>
<update_guid>38f4851dc8263110246ba1db69390cea</update_guid>
<update_guid_history>38f4851dc8263110246ba1db69390cea:-1473855774</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_94e93c95092231107f445d7a5f5e136f</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>cl.event.user</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:18:47</sys_created_on><sys_id>94e93c95092231107f445d7a5f5e136f</sys_id><sys_mod_count>1</sys_mod_count><sys_name>cl.event.user</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_94e93c95092231107f445d7a5f5e136f</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:24:06</sys_updated_on><type>string</type><value>clabs.event</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=94e93c95092231107f445d7a5f5e136f"/></record_update>]]></payload>
<payload_hash>1244650492</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>f4230c7d41a231107f440d8147faed41</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd402fa8c0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cl.event.user</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>51d8c55169a631106e885e2d95b88058</update_guid>
<update_guid_history>51d8c55169a631106e885e2d95b88058:1244650492,5ce93c95ff2231105185c55c11f5c3d8:2079487711</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_list_control_f4803725416231107f440d8147faed92</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_ui_list_control"><sys_ui_list_control action="INSERT_OR_UPDATE"><columns_condition/><disable_nlq>false</disable_nlq><edit_condition/><edit_default_filter/><edit_roles/><empty_condition/><filter_condition/><filter_roles/><hierarchical_lists>false</hierarchical_lists><label/><link_condition/><link_roles/><list_edit_insert_row>false</list_edit_insert_row><list_edit_ref_qual_tag/><list_edit_type/><name>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</name><new_condition/><new_roles/><omit_columns_if_empty>false</omit_columns_if_empty><omit_count>false</omit_count><omit_count_views>false</omit_count_views><omit_count_views_list/><omit_drilldown_link>false</omit_drilldown_link><omit_edit_button>true</omit_edit_button><omit_filters>false</omit_filters><omit_if_empty>false</omit_if_empty><omit_links>false</omit_links><omit_new_button>true</omit_new_button><related_list/><sys_class_name>sys_ui_list_control</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2023-11-17 00:15:12</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>f4803725416231107f440d8147faed92</sys_id><sys_mod_count>0</sys_mod_count><sys_name>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</sys_name><sys_overrides display_value="">global</sys_overrides><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_list_control_f4803725416231107f440d8147faed92</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:15:12</sys_updated_on></sys_ui_list_control></record_update>]]></payload>
<payload_hash>1674392057</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>f4230c7d41a231107f440d8147faed44</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bdaa1b6110000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</table>
<target_name>u_cmdb_qb_result_fafd4a6f866ba18473034adfefcdc8f7f9f330da</target_name>
<type>List Control</type>
<update_domain>global</update_domain>
<update_guid>b8803725c1623110ecd0b1a2e84d6193</update_guid>
<update_guid_history>b8803725c1623110ecd0b1a2e84d6193:1674392057</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_63f1a53377451110cd1b756f1b5a9991</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description>Captures the last execution timestamp of the scheduled job 'Surface New Unconnected Content of Categories'</description><ignore_cache>true</ignore_cache><is_private>false</is_private><name>taxonomy.category.new_content_job_last_run</name><read_roles/><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2022-08-08 07:43:25</sys_created_on><sys_id>63f1a53377451110cd1b756f1b5a9991</sys_id><sys_mod_count>10</sys_mod_count><sys_name>taxonomy.category.new_content_job_last_run</sys_name><sys_package display_value="Content Taxonomy" source="com.snc.taxonomy">a612fb9b9f2531107f44e6ca4224abb4</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_63f1a53377451110cd1b756f1b5a9991</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-15 16:14:56</sys_updated_on><type>date_format</type><value>2023-11-15</value><write_roles>maint</write_roles></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=63f1a53377451110cd1b756f1b5a9991"/></record_update>]]></payload>
<payload_hash>-1788637402</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>f8230c7d41a231107f440d8147faed40</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3c3b0340000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>taxonomy.category.new_content_job_last_run</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>2409bcd101223110551f5351a2df3205</update_guid>
<update_guid_history>2409bcd101223110551f5351a2df3205:-1788637402,c809bcd17d223110e618fb74f1ee4001:-437767834</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_fcf930d5092231107f445d7a5f5e1357</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>false</ignore_cache><is_private>false</is_private><name>sn_appclient.instance_type</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:19:06</sys_created_on><sys_id>fcf930d5092231107f445d7a5f5e1357</sys_id><sys_mod_count>0</sys_mod_count><sys_name>sn_appclient.instance_type</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_fcf930d5092231107f445d7a5f5e1357</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 16:19:06</sys_updated_on><type>string</type><value>cloudlab</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=fcf930d5092231107f445d7a5f5e1357"/></record_update>]]></payload>
<payload_hash>-1975147564</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>f8230c7d41a231107f440d8147faed43</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd3c778df0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>sn_appclient.instance_type</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>05f930d59222311015740b5280c97c5c</update_guid>
<update_guid_history>05f930d59222311015740b5280c97c5c:-1975147564</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_44d7020053a002007c949096a11c0804</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description>&lt;span style = 'font-family: Arial; font-size: 13px; color: #4a4a4a;'&gt;Allow class upgrade during identification and reconciliation.&lt;ul style='margin: 0px; padding-left:15px;'&gt;&lt;li&gt;Type: Yes | No&lt;/li&gt;&lt;li&gt;Default: Yes&lt;/li&gt;&lt;/ul&gt;&lt;/span&gt;</description><ignore_cache>false</ignore_cache><is_private>false</is_private><name>glide.class.upgrade.enabled</name><read_roles/><suffix/><sys_class_name>sys_properties</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2015-06-04 23:54:01</sys_created_on><sys_id>44d7020053a002007c949096a11c0804</sys_id><sys_mod_count>2</sys_mod_count><sys_name>glide.class.upgrade.enabled</sys_name><sys_package display_value="Configuration Management (CMDB)" source="com.snc.cmdb">dfa3e79f9f2131107f44e6ca4224abef</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_44d7020053a002007c949096a11c0804</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2023-11-17 00:03:44</sys_updated_on><type>boolean</type><value>false</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=44d7020053a002007c949096a11c0804"/></record_update>]]></payload>
<payload_hash>343899211</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>fc230c7d41a231107f440d8147faed3f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bda9735b70000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>glide.class.upgrade.enabled</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>f8edab21986231104259f2637a16394d</update_guid>
<update_guid_history>f8edab21986231104259f2637a16394d:343899211,70edab211162311038e8ca9aec01c84c:-598506172</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_properties_f4e97c95092231107f445d7a5f5e130a</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_properties"><sys_properties action="INSERT_OR_UPDATE"><choices/><description/><ignore_cache>true</ignore_cache><is_private>false</is_private><name>cl.event.endpoint</name><read_roles/><suffix>global</suffix><sys_class_name>sys_properties</sys_class_name><sys_created_by>system</sys_created_by><sys_created_on>2023-11-15 16:18:49</sys_created_on><sys_id>f4e97c95092231107f445d7a5f5e130a</sys_id><sys_mod_count>1</sys_mod_count><sys_name>cl.event.endpoint</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_properties_f4e97c95092231107f445d7a5f5e130a</sys_update_name><sys_updated_by>system</sys_updated_by><sys_updated_on>2023-11-15 17:24:05</sys_updated_on><type>string</type><value>http://cl-mid-003.lab.service-now.com:443/api/mid/em/jsonv2/</value><write_roles/></sys_properties><sys_translated_text action="delete_multiple" query="documentkey=f4e97c95092231107f445d7a5f5e130a"/></record_update>]]></payload>
<payload_hash>-1882068617</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>fc230c7d41a231107f440d8147faed42</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bd402f7490000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table/>
<target_name>cl.event.endpoint</target_name>
<type>System Property</type>
<update_domain>global</update_domain>
<update_guid>8dd8c55175a63110616d527ba62a3354</update_guid>
<update_guid_history>8dd8c55175a63110616d527ba62a3354:-1882068617,89e97c95cf2231106ec6cfc4cc025910:-1703669772</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>wf_workflow_d172bf65416231107f440d8147faed6a</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="wf_workflow_version"&gt;&lt;wf_workflow_version action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;activity_stages&gt;{"subflows":[],"activities":{},"stages":{},"ends":["ecbcff6541a231107f440d8147faed99"]}&lt;/activity_stages&gt;&lt;after_business_rules&gt;false&lt;/after_business_rules&gt;&lt;checked_out/&gt;&lt;checked_out_by/&gt;&lt;column_renderer display_value="Workflow-driven"&gt;a56213111b030100adca1e094f0713ac&lt;/column_renderer&gt;&lt;condition table="orphan_ci_remediation"&gt;numberISNOTEMPTY^EQ&lt;item endquery="false" field="number" goto="false" newquery="false" operator="ISNOTEMPTY" or="false" value=""/&gt;&lt;item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/&gt;&lt;/condition&gt;&lt;condition_type/&gt;&lt;description/&gt;&lt;expected_sequences&gt;e8bcff6541a231107f440d8147faed9b,e8bcff6541a231107f440d8147faed9a,24bcff6541a231107f440d8147faed98,ecbcff6541a231107f440d8147faed99&lt;/expected_sequences&gt;&lt;expected_time&gt;1970-01-01 14:00:00&lt;/expected_time&gt;&lt;expected_time_type/&gt;&lt;full_sequences&gt;e8bcff6541a231107f440d8147faed9b,e8bcff6541a231107f440d8147faed9a,24bcff6541a231107f440d8147faed98,ecbcff6541a231107f440d8147faed99&lt;/full_sequences&gt;&lt;journal/&gt;&lt;max_activity_count&gt;100&lt;/max_activity_count&gt;&lt;name&gt;Remediate Orphan WF&lt;/name&gt;&lt;not_cacheable&gt;false&lt;/not_cacheable&gt;&lt;on_cancel&gt;&lt;![CDATA[// This script executes if the workflow is cancelled.// The global variable context_sys_id contains the sys_id of the cancelled workflow context.]]&gt;&lt;/on_cancel&gt;&lt;order&gt;100&lt;/order&gt;&lt;pin_type&gt;set_by_activity&lt;/pin_type&gt;&lt;published&gt;true&lt;/published&gt;&lt;relative_duration display_value="2 business days by 4pm"&gt;3bf802c20a0a0b52008e2859cd8abcf2&lt;/relative_duration&gt;&lt;requires_ert&gt;true&lt;/requires_ert&gt;&lt;run_multiple&gt;false&lt;/run_multiple&gt;&lt;schedule/&gt;&lt;stage_field/&gt;&lt;stage_order&gt;computed&lt;/stage_order&gt;&lt;start display_value="Begin"&gt;e8bcff6541a231107f440d8147faed9b&lt;/start&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;2cbcb36541a231107f440d8147faed84&lt;/sys_id&gt;&lt;sys_mod_count&gt;4&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:50&lt;/sys_updated_on&gt;&lt;table&gt;orphan_ci_remediation&lt;/table&gt;&lt;timezone/&gt;&lt;validated&gt;false&lt;/validated&gt;&lt;workflow display_value="Remediate Orphan WF"&gt;d172bf65416231107f440d8147faed6a&lt;/workflow&gt;&lt;/wf_workflow_version&gt;&lt;wf_workflow action="INSERT_OR_UPDATE"&gt;&lt;access&gt;public&lt;/access&gt;&lt;description/&gt;&lt;name&gt;Remediate Orphan WF&lt;/name&gt;&lt;preview/&gt;&lt;sys_class_name&gt;wf_workflow&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 00:23:42&lt;/sys_created_on&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;d172bf65416231107f440d8147faed6a&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Remediate Orphan WF&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;wf_workflow_d172bf65416231107f440d8147faed6a&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 00:23:42&lt;/sys_updated_on&gt;&lt;table&gt;orphan_ci_remediation&lt;/table&gt;&lt;template&gt;false&lt;/template&gt;&lt;vars/&gt;&lt;/wf_workflow&gt;&lt;wf_activity action="INSERT_OR_UPDATE"&gt;&lt;activity_definition display_value="Begin"&gt;c7a5e32c0a0a0b3a002377c24ed8ea76&lt;/activity_definition&gt;&lt;activity_definition_updated&gt;false&lt;/activity_definition_updated&gt;&lt;databus_lookup_id&gt;1&lt;/databus_lookup_id&gt;&lt;height/&gt;&lt;input/&gt;&lt;is_parent&gt;false&lt;/is_parent&gt;&lt;name&gt;Begin&lt;/name&gt;&lt;new_activity_definition/&gt;&lt;notes/&gt;&lt;out_of_date&gt;false&lt;/out_of_date&gt;&lt;parent/&gt;&lt;pinned&gt;false&lt;/pinned&gt;&lt;pinned_version/&gt;&lt;stage/&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;e8bcff6541a231107f440d8147faed9b&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;timeout&gt;1970-01-01 00:00:00&lt;/timeout&gt;&lt;vars/&gt;&lt;width&gt;80&lt;/width&gt;&lt;workflow_version display_value="Remediate Orphan WF"&gt;2cbcb36541a231107f440d8147faed84&lt;/workflow_version&gt;&lt;x&gt;20&lt;/x&gt;&lt;y&gt;20&lt;/y&gt;&lt;/wf_activity&gt;&lt;sys_variable_value action="delete_multiple" query="document_key=e8bcff6541a231107f440d8147faed9b"/&gt;&lt;wf_condition action="INSERT_OR_UPDATE"&gt;&lt;activity display_value="Begin"&gt;e8bcff6541a231107f440d8147faed9b&lt;/activity&gt;&lt;condition&gt;true&lt;/condition&gt;&lt;condition_default/&gt;&lt;condition_type&gt;standard&lt;/condition_type&gt;&lt;else_flag&gt;false&lt;/else_flag&gt;&lt;error&gt;false&lt;/error&gt;&lt;event&gt;false&lt;/event&gt;&lt;event_name/&gt;&lt;is_positive&gt;true&lt;/is_positive&gt;&lt;name&gt;Always&lt;/name&gt;&lt;order&gt;0&lt;/order&gt;&lt;short_description/&gt;&lt;skip_during_generate&gt;false&lt;/skip_during_generate&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;a0bcff6541a231107f440d8147faed9c&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;/wf_condition&gt;&lt;wf_activity action="INSERT_OR_UPDATE"&gt;&lt;activity_definition display_value="End"&gt;c7a66f7d0a0a0b3a004544a6d2f14076&lt;/activity_definition&gt;&lt;activity_definition_updated&gt;false&lt;/activity_definition_updated&gt;&lt;databus_lookup_id&gt;2&lt;/databus_lookup_id&gt;&lt;height/&gt;&lt;input/&gt;&lt;is_parent&gt;false&lt;/is_parent&gt;&lt;name&gt;End&lt;/name&gt;&lt;new_activity_definition/&gt;&lt;notes/&gt;&lt;out_of_date&gt;false&lt;/out_of_date&gt;&lt;parent/&gt;&lt;pinned&gt;false&lt;/pinned&gt;&lt;pinned_version/&gt;&lt;stage/&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;ecbcff6541a231107f440d8147faed99&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;timeout&gt;1970-01-01 00:00:00&lt;/timeout&gt;&lt;vars/&gt;&lt;width&gt;80&lt;/width&gt;&lt;workflow_version display_value="Remediate Orphan WF"&gt;2cbcb36541a231107f440d8147faed84&lt;/workflow_version&gt;&lt;x&gt;614&lt;/x&gt;&lt;y&gt;89&lt;/y&gt;&lt;/wf_activity&gt;&lt;sys_variable_value action="delete_multiple" query="document_key=ecbcff6541a231107f440d8147faed99"/&gt;&lt;wf_activity action="INSERT_OR_UPDATE"&gt;&lt;activity_definition display_value="Run Script"&gt;db8c65aec0a8016501d00259bc7203a4&lt;/activity_definition&gt;&lt;activity_definition_updated&gt;false&lt;/activity_definition_updated&gt;&lt;databus_lookup_id&gt;3&lt;/databus_lookup_id&gt;&lt;height/&gt;&lt;input&gt;{}&lt;/input&gt;&lt;is_parent&gt;false&lt;/is_parent&gt;&lt;name&gt;Save current task number to scratchpad&lt;/name&gt;&lt;new_activity_definition/&gt;&lt;notes/&gt;&lt;out_of_date&gt;false&lt;/out_of_date&gt;&lt;parent/&gt;&lt;pinned&gt;false&lt;/pinned&gt;&lt;pinned_version/&gt;&lt;stage/&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;e8bcff6541a231107f440d8147faed9a&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;timeout&gt;1970-01-01 00:00:00&lt;/timeout&gt;&lt;vars/&gt;&lt;width/&gt;&lt;workflow_version display_value="Remediate Orphan WF"&gt;2cbcb36541a231107f440d8147faed84&lt;/workflow_version&gt;&lt;x&gt;193&lt;/x&gt;&lt;y&gt;311&lt;/y&gt;&lt;/wf_activity&gt;&lt;sys_variable_value action="delete_multiple" query="document_key=e8bcff6541a231107f440d8147faed9a"/&gt;&lt;sys_variable_value action="INSERT_OR_UPDATE"&gt;&lt;document&gt;wf_activity&lt;/document&gt;&lt;document_key&gt;e8bcff6541a231107f440d8147faed9a&lt;/document_key&gt;&lt;order&gt;1&lt;/order&gt;&lt;sys_class_name&gt;sys_variable_value&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;ecbcff6541a231107f440d8147faed9a&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;value&gt;workflow.scratchpad.shortdescription = "Workflow launched for task number " + current.number;&amp;#13;
//current.short_description = workflow.scratchpad.shortdescription;&lt;/value&gt;&lt;variable display_value="Script"&gt;c35ddef20a0a0ba96248a7090eccd518&lt;/variable&gt;&lt;/sys_variable_value&gt;&lt;sys_variable_value action="INSERT_OR_UPDATE"&gt;&lt;document&gt;wf_activity&lt;/document&gt;&lt;document_key&gt;e8bcff6541a231107f440d8147faed9a&lt;/document_key&gt;&lt;order&gt;1&lt;/order&gt;&lt;sys_class_name&gt;sys_variable_value&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;ecbcff6541a231107f440d8147faed9a&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;value&gt;workflow.scratchpad.shortdescription = "Workflow launched for task number " + current.number;&amp;#13;
//current.short_description = workflow.scratchpad.shortdescription;&lt;/value&gt;&lt;variable display_value="Script"&gt;c35ddef20a0a0ba96248a7090eccd518&lt;/variable&gt;&lt;/sys_variable_value&gt;&lt;wf_condition action="INSERT_OR_UPDATE"&gt;&lt;activity display_value="Save current task number to scratchpad"&gt;e8bcff6541a231107f440d8147faed9a&lt;/activity&gt;&lt;condition&gt;true&lt;/condition&gt;&lt;condition_default/&gt;&lt;condition_type&gt;standard&lt;/condition_type&gt;&lt;else_flag&gt;false&lt;/else_flag&gt;&lt;error&gt;false&lt;/error&gt;&lt;event&gt;false&lt;/event&gt;&lt;event_name/&gt;&lt;is_positive&gt;true&lt;/is_positive&gt;&lt;name&gt;Always&lt;/name&gt;&lt;order&gt;0&lt;/order&gt;&lt;short_description/&gt;&lt;skip_during_generate&gt;false&lt;/skip_during_generate&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;64bcff6541a231107f440d8147faed9b&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;/wf_condition&gt;&lt;wf_activity action="INSERT_OR_UPDATE"&gt;&lt;activity_definition display_value="Set Values"&gt;1ca8d7cf0a0a0b265e9a000c2c08248c&lt;/activity_definition&gt;&lt;activity_definition_updated&gt;false&lt;/activity_definition_updated&gt;&lt;databus_lookup_id&gt;4&lt;/databus_lookup_id&gt;&lt;height/&gt;&lt;input&gt;{}&lt;/input&gt;&lt;is_parent&gt;false&lt;/is_parent&gt;&lt;name&gt;Write phrase + task number to short description field&lt;/name&gt;&lt;new_activity_definition/&gt;&lt;notes/&gt;&lt;out_of_date&gt;false&lt;/out_of_date&gt;&lt;parent/&gt;&lt;pinned&gt;false&lt;/pinned&gt;&lt;pinned_version/&gt;&lt;stage/&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;24bcff6541a231107f440d8147faed98&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;timeout&gt;1970-01-01 00:00:00&lt;/timeout&gt;&lt;vars/&gt;&lt;width/&gt;&lt;workflow_version display_value="Remediate Orphan WF"&gt;2cbcb36541a231107f440d8147faed84&lt;/workflow_version&gt;&lt;x&gt;383&lt;/x&gt;&lt;y&gt;7&lt;/y&gt;&lt;/wf_activity&gt;&lt;sys_variable_value action="delete_multiple" query="document_key=24bcff6541a231107f440d8147faed98"/&gt;&lt;sys_variable_value action="INSERT_OR_UPDATE"&gt;&lt;document&gt;wf_activity&lt;/document&gt;&lt;document_key&gt;24bcff6541a231107f440d8147faed98&lt;/document_key&gt;&lt;order&gt;100&lt;/order&gt;&lt;sys_class_name&gt;sys_variable_value&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;2cbcff6541a231107f440d8147faed98&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;value&gt;work_notes=Update from workflow^short_description=${workflow.scratchpad.shortdescription}^EQ&lt;/value&gt;&lt;variable display_value="Set these values"&gt;1cb38c8f0a0a0b266fb48e08de35f507&lt;/variable&gt;&lt;/sys_variable_value&gt;&lt;sys_variable_value action="INSERT_OR_UPDATE"&gt;&lt;document&gt;wf_activity&lt;/document&gt;&lt;document_key&gt;24bcff6541a231107f440d8147faed98&lt;/document_key&gt;&lt;order&gt;100&lt;/order&gt;&lt;sys_class_name&gt;sys_variable_value&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;2cbcff6541a231107f440d8147faed98&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;value&gt;work_notes=Update from workflow^short_description=${workflow.scratchpad.shortdescription}^EQ&lt;/value&gt;&lt;variable display_value="Set these values"&gt;1cb38c8f0a0a0b266fb48e08de35f507&lt;/variable&gt;&lt;/sys_variable_value&gt;&lt;wf_condition action="INSERT_OR_UPDATE"&gt;&lt;activity display_value="Write phrase + task number to short description field"&gt;24bcff6541a231107f440d8147faed98&lt;/activity&gt;&lt;condition&gt;true&lt;/condition&gt;&lt;condition_default/&gt;&lt;condition_type&gt;standard&lt;/condition_type&gt;&lt;else_flag&gt;false&lt;/else_flag&gt;&lt;error&gt;false&lt;/error&gt;&lt;event&gt;false&lt;/event&gt;&lt;event_name/&gt;&lt;is_positive&gt;true&lt;/is_positive&gt;&lt;name&gt;Always&lt;/name&gt;&lt;order&gt;0&lt;/order&gt;&lt;short_description/&gt;&lt;skip_during_generate&gt;false&lt;/skip_during_generate&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;a4bcff6541a231107f440d8147faed99&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;/wf_condition&gt;&lt;wf_transition action="INSERT_OR_UPDATE"&gt;&lt;condition display_value="Always"&gt;a4bcff6541a231107f440d8147faed99&lt;/condition&gt;&lt;from display_value="Write phrase + task number to short description field"&gt;24bcff6541a231107f440d8147faed98&lt;/from&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;24bcff6541a231107f440d8147faed9d&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;to display_value="End"&gt;ecbcff6541a231107f440d8147faed99&lt;/to&gt;&lt;/wf_transition&gt;&lt;wf_transition action="INSERT_OR_UPDATE"&gt;&lt;condition display_value="Always"&gt;64bcff6541a231107f440d8147faed9b&lt;/condition&gt;&lt;from display_value="Save current task number to scratchpad"&gt;e8bcff6541a231107f440d8147faed9a&lt;/from&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;a8bcff6541a231107f440d8147faed9d&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;to display_value="Write phrase + task number to short description field"&gt;24bcff6541a231107f440d8147faed98&lt;/to&gt;&lt;/wf_transition&gt;&lt;wf_transition action="INSERT_OR_UPDATE"&gt;&lt;condition display_value="Always"&gt;a0bcff6541a231107f440d8147faed9c&lt;/condition&gt;&lt;from display_value="Begin"&gt;e8bcff6541a231107f440d8147faed9b&lt;/from&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;e4bcff6541a231107f440d8147faed9d&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;to display_value="Save current task number to scratchpad"&gt;e8bcff6541a231107f440d8147faed9a&lt;/to&gt;&lt;/wf_transition&gt;&lt;wf_estimated_runtime_config action="INSERT_OR_UPDATE"&gt;&lt;estimated_run_time/&gt;&lt;no_of_data_points&gt;1&lt;/no_of_data_points&gt;&lt;percentage_threshold_ert&gt;20&lt;/percentage_threshold_ert&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-11-17 01:08:26&lt;/sys_created_on&gt;&lt;sys_id&gt;ecbcb36541a231107f440d8147faed84&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-11-17 01:08:26&lt;/sys_updated_on&gt;&lt;workflow_version display_value="Remediate Orphan WF"&gt;2cbcb36541a231107f440d8147faed84&lt;/workflow_version&gt;&lt;/wf_estimated_runtime_config&gt;&lt;wf_workflow_version action="update_multiple" query="workflow=d172bf65416231107f440d8147faed6a^sys_id!=2cbcb36541a231107f440d8147faed84"&gt;&lt;published&gt;false&lt;/published&gt;&lt;/wf_workflow_version&gt;&lt;/record_update&gt;</payload>
<payload_hash>1260623310</payload_hash>
<remote_update_set display_value="CMDB Health Simulator Lab work_AV_v1.0">ac23c87d41a231107f440d8147faedda</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin</sys_created_by>
<sys_created_on>2023-11-17 01:36:34</sys_created_on>
<sys_id>fc230c7d41a231107f440d8147faed45</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>18bdad2cf4c0000001</sys_recorded_at>
<sys_updated_by>admin</sys_updated_by>
<sys_updated_on>2023-11-17 01:36:34</sys_updated_on>
<table>orphan_ci_remediation</table>
<target_name>Remediate Orphan WF</target_name>
<type>Workflow</type>
<update_domain>global</update_domain>
<update_guid>eacc73a58ea231102852512716c6f8a7</update_guid>
<update_guid_history>eacc73a58ea231102852512716c6f8a7:1260623310,863c736599a231106f866f75ad8f8a1a:745022509,32ebbb255da231104113048272e20801:201752124,90bb3fe18ba2311029d63f6cf9fc8f34:315195481,c05bb3e144a231105d7bd2b050eca8bd:2116590161,e51bfba1baa23110d236115b5d863938:1380881219,a28a7b61d5a231106f6700deb1cacef4:-1241197015,ae493bed2362311052ef3dbca268f240:-1068058277,6438bb6d566231105748222837b455e6:194472207,cd75b3a9cc623110dfc872578029a6dc:1453954087,99e2f3e567623110d00f91b18d421327:263861269</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
</unload>
